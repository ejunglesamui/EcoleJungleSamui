//Export de la liste des élèves	function exportEleves(request, response) {	response.contentType = 'application/vnd.ms-excel';	//response.contentType = 'text/plain';	var vToday, exportData, dNais, dtNais, vSect, vCar, vAnScol, AnScol, vLibAn, vMail, Nday, Nmonth, Nyear, vCoul;	vToday = new Date();	vCoul = "#FFFFFF";	AnScol = ds.Annees_Scolaires.query("Date_Debut <= :1 and Date_fin >= :1", vToday);	vAnScol = AnScol[0].ID;	vLibAn = AnScol[0].Annee_Scolaire;	if (vAnScol !== null) {		exportData = '<head> <meta charset="UTF-8"> </head> ';		exportData += '<TABLE cellspacing="2px" cellpadding="2px" cellspacing="1px" rules="all" style="border:solid 2px black; font-family:Calibri; font-size:12px; vertical-align: middle;">';		exportData += "<TR><TD COLSPAN=7 height=50 align=CENTER><B><font size=5 >Liste des élèves inscrits à JungleSamui pour l'année scolaire "+vLibAn+"</B><BR>"		exportData += "<font size=3 >Export eJungle ( "+vToday+" )</TD></TR>";		eleves = ds.Parcours_Scolaire.query("Annee_Scolaire.ID = :1 order by Eleve.Nom_Complet", vAnScol);		exportData += '<TR><TD align=CENTER height=20 width=220 bgcolor="#0B0B61"><B><FONT color=#FFFFFF>Nom Prénom</B></TD><TD align=CENTER width=100 bgcolor="#084B8A">';		exportData += '<B><FONT color=#FFFFFF>Classe</B></TD><TD align=CENTER width=90 bgcolor="#0B0B61"><FONT color=#FFFFFF><B>Filière</B></TD>';		exportData += '<TD align=CENTER width=90 bgcolor="#084B8A"><B><FONT color=#FFFFFF>Section</B></TD><TD align=CENTER width=90 bgcolor="#0B0B61"><B><FONT color=#FFFFFF>Sexe</B></TD>';		exportData += '<TD align=CENTER width=90 bgcolor="#084B8A"><B><FONT color=#FFFFFF>Né(e) le</B></TD><TD align=CENTER width=300 bgcolor="#0B0B61"><B><FONT color=#FFFFFF>eMail</B></TD></TR>';		eleves.forEach(function (eleve) {			dNais = eleve.Eleve.Date_Naissance;			vCar = eleve.Classe.substring(0,1);			if (vCar === "C" || vCar === "M") {				vSect = "Primaire";			} else {				vSect = "Secondaire";			}			if  (dNais === null) {				dtNais = " ";			} else {				Nday = dNais.getDate();				Nday = ((Nday < 10) ? '0' : '') + Nday; 				Nmonth = dNais.getMonth() + 1;				Nmonth = ((Nmonth < 10) ? '0' : '') + Nmonth; 				Nyear = dNais.getYear();				Nyear = ((Nyear < 200) ? 1900 : 0) + Nyear; 				dtNais = Nday + '/' + Nmonth + '/' + Nyear;			}			vMail = eleve.Eleve.Utilisateur.eMail;			if (vMail === null) {				vMail = " ";			}			if (vCoul === "#CEECF5") {				vCoul = "#FFFFFF";			} else {				vCoul = "#CEECF5";			}			exportData +=  '<TR><TD bgcolor="'+vCoul+'">' + eleve.Eleve.Nom_Complet + '</TD><TD bgcolor="'+vCoul+'">' + eleve.Classe + '</TD><TD bgcolor="'+vCoul+'">' + eleve.Filiere + '</TD>';			exportData +=  '<TD bgcolor="'+vCoul+'">' + vSect + '</TD><TD bgcolor="'+vCoul+'" align=CENTER>' + eleve.Eleve.Sexe + '</TD><TD bgcolor="'+vCoul+'"> ( ' + dtNais + ' ) </TD><TD bgcolor="'+vCoul+'">' + vMail + '</TD></TR>';		});		exportData += '</TABLE>';	} else {		exportData = " ";	}	return exportData;}function ListEleves(request, response) {			var vHtml, vToday, exportData, dNais, dtNais, vSect, vCar, vAnScol, AnScol, vLibAn, vMail, Nday, Nmonth, Nyear, vCoul, 		vSexe, vAn, eleves, dDeb, dFin, vFam, vMoi, freres, vNbf, vLien, vNe, vDne, vUser, uParam, vUserName, vParaA, ImgData;		vUser = currentUser();    vUserName = vUser.name;	uParam = ds.UserParam.query("Utilisateur.Login = :1", vUserName);	if (uParam[0].Preview) {		response.contentType = 'text/html';	} else {		response.contentType = 'application/vnd.ms-excel';	}		vToday = new Date();	vParaA = uParam[0].Annee_Scolaire;	AnScol = ds.Annees_Scolaires.query("ID = :1", vParaA);	vAnScol = AnScol[0].ID;	vLibAn = AnScol[0].Annee_Scolaire;		ImgData = "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/4gxYSUNDX1BST0ZJTEUAAQEAAAxITGlubwIQAABtbnRyUkdCIFhZWiAHzgACAAkABgAxAABhY3NwTVNGVAAAAABJRUMgc1";	ImgData += "JHQgAAAAAAAAAAAAAAAAAA9tYAAQAAAADTLUhQICAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABFjcHJ0AAABUAAAADNkZXNjAAABhAAAAGx3dHB0AAAB8AAAABRia3B0AAACBAAAABRyWF";	ImgData += "laAAACGAAAABRnWFlaAAACLAAAABRiWFlaAAACQAAAABRkbW5kAAACVAAAAHBkbWRkAAACxAAAAIh2dWVkAAADTAAAAIZ2aWV3AAAD1AAAACRsdW1pAAAD+AAAABRtZWFzAAAEDAAAACR0ZWNoAAAEMAAAAAxyVFJDAAAEPAAACAxnVFJ";	ImgData += "DAAAEPAAACAxiVFJDAAAEPAAACAx0ZXh0AAAAAENvcHlyaWdodCAoYykgMTk5OCBIZXdsZXR0LVBhY2thcmQgQ29tcGFueQAAZGVzYwAAAAAAAAASc1JHQiBJRUM2MTk2Ni0yLjEAAAAAAAAAAAAAABJzUkdCIElFQzYxOTY2LTIuMQAAAAAAAAAAAAAA";	ImgData += "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWFlaIAAAAAAAAPNRAAEAAAABFsxYWVogAAAAAAAAAAAAAAAAAAAAAFhZWiAAAAAAAABvogAAOPUAAAOQWFlaIAAAAAAAAGKZAAC3hQAAGNpYWVogAAAAAAAAJKAAAA+EAAC2z2Rlc2MAAAAAAAAAF";	ImgData += "klFQyBodHRwOi8vd3d3LmllYy5jaAAAAAAAAAAAAAAAFklFQyBodHRwOi8vd3d3LmllYy5jaAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABkZXNjAAAAAAAAAC5JRUMgNjE5NjYtMi4xIERlZmF1bHQgUkdCIGNvbG91ciBzcGFjZSAt";	ImgData += "IHNSR0IAAAAAAAAAAAAAAC5JRUMgNjE5NjYtMi4xIERlZmF1bHQgUkdCIGNvbG91ciBzcGFjZSAtIHNSR0IAAAAAAAAAAAAAAAAAAAAAAAAAAAAAZGVzYwAAAAAAAAAsUmVmZXJlbmNlIFZpZXdpbmcgQ29uZGl0aW9uIGluIElFQzYxOTY2LTIuMQAAAAAA";	ImgData += "AAAAAAAALFJlZmVyZW5jZSBWaWV3aW5nIENvbmRpdGlvbiBpbiBJRUM2MTk2Ni0yLjEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHZpZXcAAAAAABOk/gAUXy4AEM8UAAPtzAAEEwsAA1yeAAAAAVhZWiAAAAAAAEwJVgBQAAAAVx/nbWVhcwAAAAAAAAAB";	ImgData += "AAAAAAAAAAAAAAAAAAAAAAAAAo8AAAACc2lnIAAAAABDUlQgY3VydgAAAAAAAAQAAAAABQAKAA8AFAAZAB4AIwAoAC0AMgA3ADsAQABFAEoATwBUAFkAXgBjAGgAbQByAHcAfACBAIYAiwCQAJUAmgCfAKQAqQCuALIAtwC8AMEAxgDLANAA1QDbAOAA5Q";	ImgData += "DrAPAA9gD7AQEBBwENARMBGQEfASUBKwEyATgBPgFFAUwBUgFZAWABZwFuAXUBfAGDAYsBkgGaAaEBqQGxAbkBwQHJAdEB2QHhAekB8gH6AgMCDAIUAh0CJgIvAjgCQQJLAlQCXQJnAnECegKEAo4CmAKiAqwCtgLBAssC1QLgAusC9QMAAwsDFgMhAy0DOANDA08";	ImgData += "DWgNmA3IDfgOKA5YDogOuA7oDxwPTA+AD7AP5BAYEEwQgBC0EOwRIBFUEYwRxBH4EjASaBKgEtgTEBNME4QTwBP4FDQUcBSsFOgVJBVgFZwV3BYYFlgWmBbUFxQXVBeUF9gYGBhYGJwY3BkgGWQZqBnsGjAadBq8GwAbRBuMG9QcHBxkHKwc9B08HYQd0B4YHmQes";	ImgData += "B78H0gflB/gICwgfCDIIRghaCG4IggiWCKoIvgjSCOcI+wkQCSUJOglPCWQJeQmPCaQJugnPCeUJ+woRCicKPQpUCmoKgQqYCq4KxQrcCvMLCwsiCzkLUQtpC4ALmAuwC8gL4Qv5DBIMKgxDDFwMdQyODKcMwAzZDPMNDQ0mDUANWg10DY4NqQ3DDd4N+A4TDi4OSQ5";	ImgData += "kDn8Omw62DtIO7g8JDyUPQQ9eD3oPlg+zD88P7BAJECYQQxBhEH4QmxC5ENcQ9RETETERTxFtEYwRqhHJEegSBxImEkUSZBKEEqMSwxLjEwMTIxNDE2MTgxOkE8UT5RQGFCcUSRRqFIsUrRTOFPAVEhU0FVYVeBWbFb0V4BYDFiYWSRZsFo8WshbWFvoXHRdBF2UXiReu";	ImgData += "F9IX9xgbGEAYZRiKGK8Y1Rj6GSAZRRlrGZEZtxndGgQaKhpRGncanhrFGuwbFBs7G2MbihuyG9ocAhwqHFIcexyjHMwc9R0eHUcdcB2ZHcMd7B4WHkAeah6UHr4e6R8THz4faR+UH78f6iAVIEEgbCCYIMQg8CEcIUghdSGhIc4h+yInIlUigiKvIt0jCiM4I2YjlCPCI";	ImgData += "/AkHyRNJHwkqyTaJQklOCVoJZclxyX3JicmVyaHJrcm6CcYJ0kneierJ9woDSg/KHEooijUKQYpOClrKZ0p0CoCKjUqaCqbKs8rAis2K2krnSvRLAUsOSxuLKIs1y0MLUEtdi2rLeEuFi5MLoIuty7uLyQvWi+RL8cv/jA1MGwwpDDbMRIxSjGCMbox8jIqMmMymzLUMw0z";	ImgData += "RjN/M7gz8TQrNGU0njTYNRM1TTWHNcI1/TY3NnI2rjbpNyQ3YDecN9c4FDhQOIw4yDkFOUI5fzm8Ofk6Njp0OrI67zstO2s7qjvoPCc8ZTykPOM9Ij1hPaE94D4gPmA+oD7gPyE/YT+iP+JAI0BkQKZA50EpQWpBrEHuQjBCckK1QvdDOkN9Q8BEA0RHRIpEzkUSRVVFmk";	ImgData += "XeRiJGZ0arRvBHNUd7R8BIBUhLSJFI10kdSWNJqUnwSjdKfUrESwxLU0uaS+JMKkxyTLpNAk1KTZNN3E4lTm5Ot08AT0lPk0/dUCdQcVC7UQZRUFGbUeZSMVJ8UsdTE1NfU6pT9lRCVI9U21UoVXVVwlYPVlxWqVb3V0RXklfgWC9YfVjLWRpZaVm4WgdaVlqmWvVbRVuVW+";	ImgData += "VcNVyGXNZdJ114XcleGl5sXr1fD19hX7NgBWBXYKpg/GFPYaJh9WJJYpxi8GNDY5dj62RAZJRk6WU9ZZJl52Y9ZpJm6Gc9Z5Nn6Wg/aJZo7GlDaZpp8WpIap9q92tPa6dr/2xXbK9tCG1gbbluEm5rbsRvHm94b9FwK3CGcOBxOnGVcfByS3KmcwFzXXO4dBR0cHTMdSh1h";	ImgData += "XXhdj52m3b4d1Z3s3gReG54zHkqeYl553pGeqV7BHtje8J8IXyBfOF9QX2hfgF+Yn7CfyN/hH/lgEeAqIEKgWuBzYIwgpKC9INXg7qEHYSAhOOFR4Wrhg6GcobXhzuHn4gEiGmIzokziZmJ/opkisqLMIuWi/yMY4zKjTGNmI3/jmaOzo82j56QBpBukNaRP5GokhGSepLj";	ImgData += "k02TtpQglIqU9JVflcmWNJaflwqXdZfgmEyYuJkkmZCZ/JpomtWbQpuvnByciZz3nWSd0p5Anq6fHZ+Ln/qgaaDYoUehtqImopajBqN2o+akVqTHpTilqaYapoum/adup+CoUqjEqTepqaocqo+rAqt1q+msXKzQrUStuK4trqGvFq+LsACwdbDqsWCx1rJLssKzOLOutC";	ImgData += "W0nLUTtYq2AbZ5tvC3aLfguFm40blKucK6O7q1uy67p7whvJu9Fb2Pvgq+hL7/v3q/9cBwwOzBZ8Hjwl/C28NYw9TEUcTOxUvFyMZGxsPHQce/yD3IvMk6ybnKOMq3yzbLtsw1zLXNNc21zjbOts83z7jQOdC60TzRvtI/0sHTRNPG1EnUy9VO1dHWVdbY11zX4Nhk2Oj";	ImgData += "ZbNnx2nba+9uA3AXcit0Q3ZbeHN6i3ynfr+A24L3hROHM4lPi2+Nj4+vkc+T85YTmDeaW5x/nqegy6LzpRunQ6lvq5etw6/vshu0R7ZzuKO6070DvzPBY8OXxcvH/8ozzGfOn9DT0wvVQ9d72bfb794r4Gfio+Tj5x/pX+uf7d/wH/Jj9Kf26/kv+3P9t////4QMcRXhpZg";	ImgData += "AATU0AKgAAAAgACAEPAAIAAAAWAAAAbgEQAAIAAAAiAAAAhAESAAMAAAABAAEAAAEaAAUAAAABAAAApgEbAAUAAAABAAAArgEoAAMAAAABAAIAAAEyAAIAAAAUAAAAtodpAAQAAAABAAAAygAAAABFQVNUTUFOIEtPREFLIENPTVBBTlkAS09EQUsgUExBWVNQT1JUIFZpZ";	ImgData += "GVvIENhbWVyYSwgWng1AAAAAEgAAAABAAAASAAAAAEyMDE0OjA3OjI3IDA3OjE1OjI0AAAlgpoABQAAAAEAAAKMgp0ABQAAAAEAAAKUiCIAAwAAAAEAAgAAiCcAAwAAAAEAfQAAkAAABwAAAAQwMjMwkAMAAgAAABQAAAKckAQAAgAAABQAAAKwkQEABwAAAAQBAgMAkQIABQ";	ImgData += "AAAAEAAALEkgEACgAAAAEAAALMkgIABQAAAAEAAALUkgMACgAAAAEAAALckgQACgAAAAEAAALkkgUABQAAAAEAAALskgcAAwAAAAEABQAAkggAAwAAAAEAAAAAkgkAAwAAAAEAIAAAkgoABQAAAAEAAAL0khUABQAAAAEAAAL8oAAABwAAAAQwMTAwoAEAAwAAAAEAAQAAoAI";	ImgData += "ABAAAAAEAAABxoAMABAAAAAEAAABkohUABQAAAAEAAAMEohcAAwAAAAEAAgAAowAABwAAAAEDAAAApAEAAwAAAAEAAAAApAIAAwAAAAEAAAAApAMAAwAAAAEAAAAApAQABQAAAAEAAAMMpAUAAwAAAAEAIQAApAYAAwAAAAEAAAAApAcAAwAAAAEAAQAApAgAAwAAAAEAAAAA";	ImgData += "pAkAAwAAAAEAAAAApAoAAwAAAAEAAAAApAwAAwAAAAEAAAAAAAAAAAAAAAEAAAFAAAAADgAAAAUyMDE0OjA3OjI3IDA3OjE1OjI0ADIwMTQ6MDc6MjcgMDc6MTU6MjQAAAAuVwAAFlsAAAAZAAAAAwAAAAMAAAABAAAABwAAAAEAAAAAAAAAAQAAAAMAAAABAAAAJwAAAAoAAA";	ImgData += "B9AAAAAQAAAH0AAAABAAAAAAAAAAH/4QJ3aHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA1LjEuMiI+CiAgIDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vc";	ImgData += "mcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+CiAgICAgIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICAgICAgICAgIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyI+CiAgICAgICAgIDx4bXA6Q3JlYXRlRGF0ZT4yMDE0LTA3LTI3VDA";	ImgData += "3OjE1OjI0PC94bXA6Q3JlYXRlRGF0ZT4KICAgICAgICAgPHhtcDpNb2RpZnlEYXRlPjIwMTQtMDctMjdUMDc6MTU6MjQ8L3htcDpNb2RpZnlEYXRlPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgI";	ImgData += "CAgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIj4KICAgICAgICAgPHBob3Rvc2hvcDpEYXRlQ3JlYXRlZD4yMDE0LTA3LTI3VDA3OjE1OjI0PC9waG90b3Nob3A6RGF0ZUNyZWF0ZWQ+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogI";	ImgData += "CA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgr/2wBDAAIBAQIBAQICAQICAgICAwUDAwMDAwYEBAMFBwYHBwcGBgYHCAsJBwgKCAYGCQ0JCgsLDAwMBwkNDg0MDgsMDAv/2wBDAQICAgMCAwUDAwULCAYICwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsL";	ImgData += "CwsLCwv/wAARCABkAHEDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc";	ImgData += "3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEK";	ImgData += "RobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD9/KKKKA";	ImgData += "Cisb4h+Ln8B+CdU1mDTNQ1k6ZbtcmysED3Nwq8lYlJAZsZIXPOMCsTwx8bvDnxR+H8Gr/DjxDpRXVbZmsnuXCGOTBAEsLFXUq/DIcMCCODQK62O0zmjNeC+M/j7a/se/DSGw+J3ia88d+M7tWu/wB4qQeaXPXag229uuMKPmY4ONxya+Lvj1+3p4n8fatIPEOtSwWUuWTStPlaCON";	ImgData += "ewIU7pPq5OewFctbFwpPl3fY7MPg6mJ1S0P0yHxF8PnWE04a5o/8AaEj+Wlt9sj85m/uhN2SfbFchqX7Xfw60fxBeaZqnie0gvLCZoJ1aKXajqcMu8LtOCCOD2r8rbLxL4u1aYXHh7SodLjJzHLcyiNvqAAWFTwXvjKOVw+n2UkoHzS/aNsb85BXuTyeoFYrFzl9lfedn9lpbzP11";	ImgData += "8I/FLw54+bb4L13StUcLvKW10kjhfUqDkflW9X4/aZ8R/EHhS8STxDp89ooYAXcD7hHn/poh3D9K+iv2bv2+dW8DCG18U3MniHQy53rNKXurfP8AzzlY8gcfK3B5wRWyxKXxqxz1cvnBXjqfe9Fc/wDDn4paF8V9DGoeA9Rhv4AQsgXh4WwDtdDyrAEcGugrpTvqjgatuFFFFMAo";	ImgData += "oooAKKDyK870C78c+F/iPrUvxW1fwlJ4Luo0GlzQxtZ3VpNnbskEjMsm8HOQ33hwMHATYm7Hn3xp/aHv/hX+0VJp2m+L/DVlajSoby40LxSTp1vdKzOvn2GoqrbWXZiSKRGB4KlcknzvUPjtf+GL5fG3x0+GXwt1Hw3rcTjSdT0KaK9ur6dSWRvNnjRniIVsuE4+UjOa5e9/astL";	ImgData += "b4o3r+PbTSvi9o0d3MLO31HTre01vw7co2xowrr5UkDbSRIhIJ54PB8z/bO/aOl+N2v2F/8A2ZNo6Wtp9gttP+0LKYjuJZgygDJ+ToOAgrgxeL9lTbg9b6GuBofXK3LfRHmXxQ+JGu/G7x7ez3Nzi4upDJNJgtFZRkkrHGvRQoOFUcDr1JrO0nStA0CdraCOGS5if95cSxb3Z/UvV";	ImgData += "3wno0ek6OiSeUJmy8pJO5mPr614x8QvGcOlfFLWtKtLuIRQXAklRdxfDKrso54HJyfSubLMPHFVHGbd7bn0Neo6MeWnsj6BgkiktzLHJG6ICSQOn1zU6OVEZuB5XnExpvQHecE4Bz6An8K8f8E+NLCXTvOtLzThayK1rEba7V54SpD7jEcrtJPfP5V2Pg7Wb3xNKIH1BpoLcvO8wV";	ImgData += "SCC6+XGGK9cB+VxgcV3yy+FJTbexxutOTSsds1mLiJo5tjI3BUxggj+tZF/wDD6MSi78MyLYXa/wBxMRS+zp0/EVpxRqScGLHpuP6VLHGiHjy/oWNebGfQ6lKzOh/Zx+PWqfCLx/b39irx3dqfJvLRuftEJILR5PGGxlW7HH4/pl4O8WWXjvwvYax4clE9lqMKzxP3wex9CDkEdiC";	ImgData += "K/JvxNbNZCK/sFzLbgq+053RnqMfy9K+wP+CbfxNkN5qnhi7nMltdQDU7PcxO1htWRR2wQyNx3BNdeFq8suR7M4MdRTXtIn1tRRRXonlhRRRQAVmeM9H07XvC1/a+LdOi1fTpIG8+zkthci4UAkr5RB3k9hjk1p0UAfB3j3Uf2cvCfg8X3wc8OXmsa/Ddi3TT0vNQ0y4Cyt+8V3df";	ImgData += "lEYzhCMjaAMV83eLJLXUvHtu0AW2gV5HihaYyvCDkhd55YgcbiMnGa/R79qj9kzw78a/COoX9nYRWHiy0ia4stStQIZ3lQFgkrD/AFisRg7s4zkYNfnVqsKJ4qsMgiN4HZc4+/wcn8N1eDmilGcOx6eULllMejQk/JM2T7f/AFq4Xxr8Ivh14v8AiTE/jNIv+Eo1q3IiSLUJrW7voYV";	ImgData += "CvsWJl3gK6hsDptz0r0VQjj/WqB64HNfMf7YXw88b3/xU0rUPBc+v6jp85jTTRDeIv9n3jIwkSHygrwKyxqS7tgliMjIFGAi51LKfL5noVZW6XOE8S+G9A0PX28J/D/SNRk8X6f4kmtYdT+1AJdweYfIjVd2A4BRcsB8yMckHFeoeGPG9/onijUtN+K11ftrunktuidI55ZX2snmiP";	ImgData += "5W4b+DKtkHHUDpPg18BNA+Fvw81DUfGt/qj3fiPTUOpRXrxwS2wVfOaOIKd3mq4LBwxfcoIryL4hQ+F/BPhmd9J1i08Z6n4hMWpabqs9zPHq2mwsqsouVYFGdsEE7lfJ5Qbc179LEKremtV37nLKDWrPpfwh46Mt4dO8Yo9hfKBtEqhC+R0PYH8efrXTwa1YTXghhu4mmALbFIJ";	ImgData += "wOvavleLx3YafdXV7Nc+I/G2m2mireX19ZxNA2m3TcAXBfrEpGM9SeOcGt6z+IqfB/xz4Xi+Kxi0cNpw1i/NrDJLPbu28RwTKATI7DBLYAReOcZrKtgIO8loxwqtaH0sGgZWDvlSORtzn9K9B/Yf8Vjwh8cNBzIvlLqT6buZuNkqlQPblk/KuAjbGMTSPxuDAfeGOPrwa639k/Rv7";	ImgData += "W+PXh22RppIk1tHwWJACsXP6L3rx4StOPe5tWV6cvQ/TIdKKB0or3D58KKKKACvNP2o/GPxH8D/AA8kv/2b/DWleJ9Th3NPb3V0yTrGFJzbwgBZ3zj5Gkj9ixwp9Lo60Ezi5RaTsfl/4l/4Kz/EXxNLaJYX1t4Xu7Jfs95AunIEmmVjlmEwZomH3WjJ4I7civLdU8fXXiFmurxI";	ImgData += "WvUmNysiYQSFmJYYHABDN04r9EP2uP2EfCXxz07UNa0DwV4SvvGtzsVrvUbq609Z0HBMk1odxcL0Zlbpg8cj8qvF+z4TeM7zS/DuvaH4osLaR0eTSnmmtoXV2Voo5ZkRnKFSCwBB9c5rysdgp1kpKVzwZ5hjMmqqVSacX/W3+R7voNjL4igjfT45z5qhscZUehPSr0HhW51GZ008O";	ImgData += "CpAkDELt/MVs/DvSovD/gK0n00zzC8t47shm4JZQflHQf8A1qZomsSvrl0DHtWdgSc8jAxmuWtSo4SVNVm7vex9nh8ZUxFP2iXS55Z8efg7N8Xfh3c6BaTaRb3Ul1BKs2qacL2O32SAs0ahlMc23cEkB+RjkhhwfKv2a/2fNW8B2uoXXxo0Hw9HpF9ZXL3f23y5b/TGicrjOGjMUk";	ImgData += "QaXcrBlwueSQPSPjt8PPix8OfE+qeLPgzrVn430nWrsTTeGNWtkim01jGqn7DOjx7oiY93ludwLsQW6Dx7xbD8YPj4ttoXinwvrehaBqcci6ta2lpFYpH94Rxvd3Uz+bE3yM+xRxlcMa9ONKph17NTXI9fM3jUVZKVtThfgPpjfFTx/oUOhTWmlWN5dWkGpaRZSzxS31nbRmdrqdD";	ImgData += "lWVmRFbcf9ZKMDB57n4o/sa6zc/FWAfDsXeqabfWE+o3N9rt6JYTdpNn7JK6YlVZUcKrBW2hHyQQAfX/gl8Dbr4eS3msfEDVpvEfi7V4YYb+/OEijjiUKkMAAB2AKuWIyxAzgACvQVslznY/A6mTmprZlJVP3T02NVR7lb7DZ+CfDMEGjpLBYadClvbwLISsUagKiBmOcDgZJzgV73";	ImgData += "/wTe+HUmofFf+0b0rIdGt5buYk5/ezZjQfkZD+FeCWOmSeMNZt7fSoZZ4lkURouXM8hIC7R35OAO5PtX6OfstfA1fgf8OI7fUAjazqJFxqDqc7Wx8sQPcIOM9yWPeuTCxdarzPZGeNqezp8l9Wel0UUV7J4gUUUUAFFFFABX5y/8Fa/gj4P0r4taBq3hTSbfT/EGt281zqksDhYrs";	ImgData += "o8ao8sA48w5YGTgsBg5wCP0ar8yv8Agrd4qsvDv7QWoXmnXAmu4NItYJo3UoIZf3hRdx4I2urEjgc571y4xyVJqG70POzVQeHfOrnmn7PPxE0Wy8a3PhSXUmjuJYN1nay3BMEZUktHGHOFbBztHUA+ldl+0F4ll+Dvw4n8QaabVbmC6tlhiuVJjvd0gDRfLzym87h93GeQMH3b/";	ImgData += "gnH/wAE3j8PPAt7rP7TsHhTxTN4kEd3Z6TJZW2p29ipwwmN1JEWeVwR8qN5SjpuJLVj/tbf8EYLH4g6pqWt/s262PDzyW7SweG7x5DpIusrxbsCfscbLvyqoyq2CoALA0sFRnGKrLmkuplhni6eEslZvp1R8XfEz9s/UPGculR+C7FdDhtyzXSXLi5W4c4AGQF2oOefvHPbHPS+B";	ImgData += "/jvo/izUBY30htbxY/9a7NHBcMB83lluV9g3Jqbwr/wSW+MV18RItB8d+GLjR7a8trgW2t211b32mwXKxl4Rc7HEqwuVMZdY9ys6HaRmvMvEH7KvxQ+F2heJNa8aeE9c0KHwZdWsV7PdwSIiPNMY43gmA8udA6ruZGICujHg8XiMLHELXc5cPmGY4GfPJNx6prtv6ep7o";	ImgData += "PEUd0CNEjub6QDjys7M+7sAB+tavg34feIPiLrMOlWVvNd3tzhktbQFiwxzu9gepJC9ya+n/2Q/wBlLwp8cPgb4T8c+INQ1K6/4SPTor6S0gZYIoZCP3kZYAuSrhlPI5B6V9N+A/hX4d+GVm0PgTR7HTVcYkeKP95L/vucs34k15NLLarf7x2X4n20szg4p01ueTfso/scW3wdij1";	ImgData += "jx1Ha3Wv/AHoI0O+PT+MHB6PJyRuxgDhe5PvNFFexTpxpR5Y7HmVKkqsuaT1CiiirICiiigAooooA8T/b9/aL1f8AZf8A2epvE/gZdOOof2nZ2KtewtLDGssoViVV1JJGVHPBYHnpXyV+0Hqvw+/aq8ceGvjj4httYf4V6LdDSPEtg0KC9vtVjnghsbXyQxDQTG8+d94AWDa3Dn";	ImgData += "Gl+2J+yz+1R+0hf/EH4cXyeF9X+HXi3x3peu6D4jn8RJbXHhXSrae1mktPsaWe6Ukwz4BdyS+PMAYeVg+Mf+Cafx2u9K8WfBjwvbeAB8IvFPxO0/x7D4wm1+4XWNLtbe+s757L+yxa7ZZC9mY1f7QqhXyf7o6Y0oOKcrX33W2n49jKtRhXjyz23+4+sn/4KKfDfSvGd1os48QW+";	ImgData += "labra+GJdf/ALJkGhw6juCC1N0PlUhiq5ICgnGeKzNe/wCCnXgDQ/HRsfsPii78Mxa2nhqfxbbaf5uiRak0qxC388NlvnbBdVKgjuOa+evFf/BMz4qat+wN8VvhnbvoE/iDxR8X5vGmkvJrTiKTS5Nbhvdss32fMcnkLInlbGAICbyPmr4//aE+NEPwE+B3iz9mjwl8UPhD4j8O";	ImgData += "aZ8Rre402JddmtfiCk41mK7GnHQ5bUbgkybftKy/NFgovzqQ406cnZPrb5d/+AbWR+k/wt/4KQWkNpqmmfFmyuNV8Wr431PwvpWleHLEz3d7FbNu80wtJwEQ7WcsASOAOg9I8Qat4L/b4/ZS8W6bp82uyaDrtre6JqUFsHsdVspo8pLBtYbop1ZQACD1B5Br4d8X/wDBID4n3vxG174";	ImgData += "iafpXgPxJri+PdX1SDwzrXiO9ttO1/RbtFaEyXVtb+ZY3cM7SMFVJUKgAkk/L9r/sF/s33/7OHwNn07xnoHw98L+I9e1KfV9UtPBdtcJYRSyBUQNPdM0t5OsUcSPdOE8wpny0GFE1FBLmi9RNJqzPkT/gnf8AGHxL4S+HOgeEvgr8TfCWrato1+0mpfDnxGsdhr8UUlwzSLHK+0iRt";	ImgData += "zuEKbVPy5GCK+u/i5+27YfBjxvFYeMfBXjqHQv7WtdFl8RSWcUOnLc3DokQj8yVZJ0LSKpeNGUENycV8z/tD/sA/Hz9pTwwvw++MY+DPiq0gvFl0/4tzCXTvGOlRJcB45I7C3tPJ+1rEoTzY7iKNmy3lqPlpnxi/wCCTfxA+M/7Q/iHUfFeseDr/RNX8baV4osvFupXd9e+JtC02z";	ImgData += "ls5ZdFsLdx5FrHMbN1eSKRVZbh98bGrlyTknJ/1/XzCMVFWR7f8Rv+ConhT4dz67PN4S8b6hoeha5N4cfWba1gFjPfxcSQI7yg7gwZRkDJXjORmvff8FRdC8N2OrJ8QvBPi/w1rWhanpNjf6VqJto7iCLUZWit7jIkKldy8rndyMAk4ryLWf8Agl/8SvGP7Eni/wCHN7rXh7S9e1T";	ImgData += "4z3HxC0+6/tG4uYjpza4NQEMriFWWRod0WwBlXIG5hknov2uv+CW3iX9pP9o74n+LdG8TaNpen+NvCfhqz0wTxSyyafrGiatJqFvJNEpUSW8nmBW2uG4Iwc0oxovd/wBafpf7hqx6d+1B+2jB8NPiW3hXSrvUdEvPDt9oF3qV4LS3u7e7tNSuprVYSjuHUb4vmdcMOCu7DCvpAV8Ff";	ImgData += "G7/AIJn/Ff9ovUvH3i74l+J/BFp408Wf8Ina2VnphvE0uxt9E1KW+Ls7gyNLK9w4wFxhVBJHT70TIQeZjdjnHTNZVFFJcr1/wCAv+CGgtFFFZCCiiigAooooAKx5Ph5oE3iMaxNomkPq4YML1rKM3IIGAfN27s4460UUAbFFFFABRRRQAUUUUAFFFFABRRRQB//2Q==";			if (vAnScol !== null) {		vHtml = '<head> <meta charset="UTF-8"> </head> ';		vHtml += '<style> .break { page-break-after: always; } </style>';		eleves = ds.Parcours_Scolaire.query("Annee_Scolaire.ID = :1 order by Eleve.Nom_Complet", vAnScol);		eleves.forEach(function (eleve) {			dNais = eleve.Eleve.Date_Naissance;			vFam = eleve.Eleve.MaFamille.ID;			vMoi = eleve.Eleve.Nom_Complet;			dDeb = eleve.Date_Deb;			dFin = eleve.Dat_Fin;			if (dNais !== null) {				Nday = dNais.getDate();				Nday = ((Nday < 10) ? '0' : '') + Nday; 				Nmonth = dNais.getMonth() + 1;				Nmonth = ((Nmonth < 10) ? '0' : '') + Nmonth; 				Nyear = dNais.getYear();				Nyear = ((Nyear < 200) ? 1900 : 0) + Nyear; 				dNais =  Nday + '/' + Nmonth + '/' + Nyear;			} else {				dNais = " ";			}			if (dDeb !== null) {				Nday = dDeb.getDate();				Nday = ((Nday < 10) ? '0' : '') + Nday; 				Nmonth = dDeb.getMonth() + 1;				Nmonth = ((Nmonth < 10) ? '0' : '') + Nmonth; 				Nyear = dDeb.getYear();				Nyear = ((Nyear < 200) ? 1900 : 0) + Nyear; 				dDeb =  Nday + '/' + Nmonth + '/' + Nyear;			} else {				dDeb = " ";			}			if (dFin !== null) {				Nday = dFin.getDate();				Nday = ((Nday < 10) ? '0' : '') + Nday; 				Nmonth = dFin.getMonth() + 1;				Nmonth = ((Nmonth < 10) ? '0' : '') + Nmonth; 				Nyear = dFin.getYear();				Nyear = ((Nyear < 200) ? 1900 : 0) + Nyear; 				dFin =  Nday + '/' + Nmonth + '/' + Nyear;			} else {				dFin = " ";			}			vCar = eleve.Classe.substring(0,1);			vSexe = "Féminin";			if (eleve.Eleve.Sexe === "M") {				vSexe = "Masculin";			}			if (eleve.Annee_Complete) {				vAn = "Complète";			} else {				vAn = "Partielle";			}			vHtml += '<TABLE cellpadding="2px" cellspacing="2px" width=800 rules="all" style="border:solid 2px black; font-family:Calibri; font-size:12px; vertical-align: middle;">';			vHtml += '<TR><TD width=10% align=center"><IMG src="'+ImgData+'"</TD><TD width=20%>Ecole Française de Koh Samui<BR>143/1 Moo 4, Maret Lamai<BR>Koh Samui, 84310 Surathani<BR>Téléphone : 08 24 14 24 29</TD>';			vHtml += "<TD width=70% align=center><FONT SIZE=5><B>&nbsp;FICHE INDIVIDUELLE D'INFORMATION&nbsp;</B></TD></TR></TABLE><TABLE border=0><TR><TD height=15>&nbsp;</TD></TR></TABLE>";			vHtml += '<TABLE cellpadding="2px" cellspacing="3px" width=800 style="border:solid 1px black; font-family:Calibri; font-size:12px; vertical-align: middle;">';			vHtml += '<TR><TD COLSPAN=7></TD></TR>';			vHtml += '<TR><TD></TD><TD COLSPAN=3><B>Année scolaire '+vLibAn+'</B></TD><TD COLSPAN=2 height=30 valign=middle><I><B>Informations sur le Père</TD><TD></TD></TR>';			vHtml += '<TR><TD width=2%></TD><TD width=10% align=right bgcolor=#A9D0F5><B>Nom&nbsp;</TD><TD width=33%>'+eleve.Eleve.Utilisateur.Nom+'</TD><TD width=6%></TD><TD width=10% align=right bgcolor=#A9D0F5><B>Nom&nbsp;</B></TD><TD width=35%>'+((eleve.Eleve.MaFamille.Pere_Nom === null) ? ' ' : eleve.Eleve.MaFamille.Pere_Nom)+'</TD><TD width=2%></TD></TR>';			vHtml += '<TR><TD></TD><TD align=right bgcolor=#A9D0F5><B>Prénom&nbsp;</TD><TD>'+eleve.Eleve.Utilisateur.Prenom+'</TD><TD></TD><TD align=right bgcolor=#A9D0F5><B>Prénom&nbsp;</B></TD><TD>'+((eleve.Eleve.MaFamille.Pere_Prenom === null) ? ' ' : eleve.Eleve.MaFamille.Pere_Prenom)+'</TD><TD></TD></TR>';			vHtml += '<TR><TD></TD><TD align=right bgcolor=#A9D0F5><B>Sexe&nbsp;</TD><TD>'+vSexe+'</TD><TD></TD><TD align=right bgcolor=#A9D0F5><B>Profession&nbsp;</B></TD><TD>'+((eleve.Eleve.MaFamille.Pere_Profession === null) ?  ' ' : eleve.Eleve.MaFamille.Pere_Profession)+'</TD><TD></TD></TR>';			vHtml += '<TR><TD></TD><TD align=right bgcolor=#A9D0F5><B>Né(e) le&nbsp;</TD><TD>'+ dNais+'</TD><TD></TD><TD align=right bgcolor=#A9D0F5><B>Téléphone&nbsp;</B></TD><TD>'+((eleve.Eleve.MaFamille.Pere_Telephone === null) ? ' ' : eleve.Eleve.MaFamille.Pere_Telephone)+'</TD><TD></TD></TR>';			vHtml += '<TR><TD></TD><TD align=right bgcolor=#A9D0F5><B>eMail&nbsp;</TD><TD>'+((eleve.Eleve.Utilisateur.eMail === null) ? ' ' : eleve.Eleve.Utilisateur.eMail)+'</TD><TD></TD><TD align=right bgcolor=#A9D0F5><B>Adresse 1&nbsp;</B></TD><TD>'+((eleve.Eleve.MaFamille.Pere_Adresse_1 === null) ? ' ' : eleve.Eleve.MaFamille.Pere_Adresse_1)+'</TD><TD></TD></TR>';			vHtml += '<TR><TD COLSPAN=4 ROWSPAN=2></TD><TD align=right bgcolor=#A9D0F5><B>Adresse 2&nbsp;</B></TD><TD>'+((eleve.Eleve.MaFamille.Pere_Adresse_2 === null) ? ' ' : eleve.Eleve.MaFamille.Pere_Adresse_2)+'</TD><TD></TD></TR>';			vHtml += '<TR><TD align=right bgcolor=#A9D0F5><B>CP / Ville&nbsp;</B></TD><TD>'+((eleve.Eleve.MaFamille.Pere_Adresse_CP === null) ? ' ' : eleve.Eleve.MaFamille.Pere_Adresse_CP)+' '+((eleve.Eleve.MaFamille.Pere_Adresse_Ville === null) ? ' ' : eleve.Eleve.MaFamille.Pere_Adresse_Ville)+'</TD><TD></TD></TR>';			vHtml += '<TR><TD></TD><TD align=right bgcolor=#A9D0F5><B>Classe&nbsp;</TD><TD>' + eleve.Classe + '</TD><TD></TD><TD align=right bgcolor=#A9D0F5><B>eMail&nbsp;</B></TD><TD>'+((eleve.Eleve.MaFamille.Pere_eMail === null) ? ' ' : eleve.Eleve.MaFamille.Pere_eMail)+'</TD><TD></TD></TR>';			vHtml += '<TR><TD></TD><TD align=right bgcolor=#A9D0F5><B>Filière&nbsp;</TD><TD>' + eleve.Filiere + '</TD><TD></TD><TD COLSPAN=3>&nbsp;</TD></TR>';			vHtml += '<TR><TD COLSPAN=4></TD><TD COLSPAN=2 height=30 valign=middle><I><B>Informations sur la Mère</TD><TD></TD></TR>';			vHtml += '<TR><TD></TD><TD align=right bgcolor=#A9D0F5><B>Année&nbsp;</TD><TD>'+vAn+'</TD><TD></TD><TD align=right bgcolor=#A9D0F5><B>Nom&nbsp;</B></TD><TD>'+((eleve.Eleve.MaFamille.Mere_Nom === null) ? ' ' : eleve.Eleve.MaFamille.Mere_Nom)+'</TD><TD></TD></TR>';			vHtml += '<TR><TD></TD><TD align=right bgcolor=#A9D0F5><B>Période&nbsp;</TD><TD>du '+ dDeb +' au '+ dFin +'</TD><TD></TD><TD align=right bgcolor=#A9D0F5><B>Prénom&nbsp;</B></TD><TD>'+((eleve.Eleve.MaFamille.Mere_Prenom === null) ? ' ' : eleve.Eleve.MaFamille.Mere_Prenom)+'</TD><TD></TD></TR>';			vHtml += '<TR><TD></TD><TD align=right bgcolor=#A9D0F5><B>Assurance&nbsp;</TD><TD>'+((eleve.Assurance_Nom === null) ? ' ' : eleve.Assurance_Nom)+'</TD><TD></TD><TD align=right bgcolor=#A9D0F5><B>Profession&nbsp;</B></TD><TD>'+((eleve.Eleve.MaFamille.Mere_Profession === null) ? ' ' : eleve.Eleve.MaFamille.Mere_Profession)+'</TD><TD></TD></TR>';			vHtml += '<TR><TD></TD><TD align=right bgcolor=#A9D0F5><B>n°&nbsp;</TD><TD>'+((eleve.Assurance_Numero === null) ? ' ' : eleve.Assurance_Numero)+'</TD><TD></TD><TD align=right bgcolor=#A9D0F5><B>Téléphone&nbsp;</B></TD><TD>'+((eleve.Eleve.MaFamille.Mere_Telephone === null) ? ' ' : eleve.Eleve.MaFamille.Mere_Telephone)+'</TD><TD></TD></TR>';			vHtml += '<TR><TD COLSPAN=4></TD><TD align=right bgcolor=#A9D0F5><B>Adresse 1&nbsp;</B></TD><TD>'+((eleve.Eleve.MaFamille.Mere_Adresse_1 === null) ? ' ' : eleve.Eleve.MaFamille.Mere_Adresse_1)+'</TD><TD></TD></TR>';			vHtml += '<TR><TD></TD><TD COLSPAN=3><B>Frères et soeurs scolarisés</B></TD><TD align=right bgcolor=#A9D0F5><B>Adresse 2&nbsp;</B></TD><TD>'+((eleve.Eleve.MaFamille.Mere_Adresse_2 === null) ? ' ' : eleve.Eleve.MaFamille.Mere_Adresse_2)+'</TD><TD></TD></TR>';						freres = ds.Eleves.query("MaFamille.ID = :1 and Nom_Complet != :2 order by Nom_Complet", vFam, vMoi);			if (freres.length === 0) {				vHtml += '<TR><TD COLSPAN=4></TD><TD align=right bgcolor=#A9D0F5><B>CP / Ville&nbsp;</B></TD><TD>'+((eleve.Eleve.MaFamille.Mere_Adresse_CP === null) ? ' ' : eleve.Eleve.MaFamille.Mere_Adresse_CP)+' '+((eleve.Eleve.MaFamille.Mere_Adresse_Ville === null) ? ' ' : eleve.Eleve.MaFamille.Mere_Adresse_Ville)+'</TD><TD></TD></TR>';			} else {				vNbf = 1;				freres.forEach(function (frere) {					vDne = frere.Date_Naissance;					if (vDne !== null) {						Nday = vDne.getDate();						Nday = ((Nday < 10) ? '0' : '') + Nday; 						Nmonth = vDne.getMonth() + 1;						Nmonth = ((Nmonth < 10) ? '0' : '') + Nmonth; 						Nyear = vDne.getYear();						Nyear = ((Nyear < 200) ? 1900 : 0) + Nyear; 						vDne =  Nday + '/' + Nmonth + '/' + Nyear;					} else {						vDne = " ";					}					if (vNbf === 1) {						vLien = "Frère";						vNe = "né le ";						if (frere.Sexe === "F") {							vLien = "Soeur";							vNe = "née le ";						}						vHtml += '<TR><TD></TD><TD align=right bgcolor=#A9D0F5><B>'+vLien+'&nbsp;</TD><TD>' + frere.Nom_Complet + ' ' + vNe + ' ' +  vDne +'</TD><TD></TD><TD align=right bgcolor=#A9D0F5><B>CP / Ville&nbsp;</B></TD><TD>'+((eleve.Eleve.MaFamille.Mere_Adresse_CP === null) ? ' ' : eleve.Eleve.MaFamille.Mere_Adresse_CP)+' '+((eleve.Eleve.MaFamille.Mere_Adresse_Ville === null) ? ' ' : eleve.Eleve.MaFamille.Mere_Adresse_Ville)+'</TD><TD></TD></TR>';						vNbf += 1;					} else {						vHtml += '<TR><TD></TD><TD align=right bgcolor=#A9D0F5><B>'+vLien+'&nbsp;</TD><TD>' + frere.Nom_Complet + ' ' + vNe + ' ' +  vDne +'</TD><TD COLSPAN=4></TD></TR>';					}				});			}			vHtml += '<TR><TD COLSPAN=7></TD></TR></TABLE>';			vHtml += '<P class="break">';			vHtml += '<TABLE width=800 border=0><TR><TD height=5 bgcolor=#FFFFFF>&nbsp;</TD></TR></TABLE><P>';		});	}		return vHtml;		}function SuiviEleves(request, response) {			var vHtml, vToday, exportData, dNais, dtNais, vSect, vCar, vAnScol, AnScol, vLibAn, vMail, Nday, Nmonth, 		Nyear, vCoul, vSexe, vAn, eleves, dDeb, dFin, vFam, vMoi, freres, vNbf, vLien, vNe, vDne, vUser, uParam, vUserName, 		vParaA, vParaM, vParaLm, vNbAbs, vNbCant, vNbThai, vLibAbs, vLibCant, vLibThai, jourms, jOuv, vTable, vCal, Suivis, vRupt, 		vMat, vQuery, vEnt, ldDeb, ldFin, ldDreel, ldFreel, dDreel, dFreel, vTableB, ava, lava, vNbLg, nblg, ImgData, Notes, now, vMonth, vCoul, nbNotes, MoyGen, TotMoy;		vUser = currentUser();    vUserName = vUser.name;	uParam = ds.UserParam.query("Utilisateur.Login = :1", vUserName);	if (uParam[0].Preview) {		response.contentType = 'text/html';	} else {		response.contentType = 'application/vnd.ms-excel';	}		ImgData = "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/4gxYSUNDX1BST0ZJTEUAAQEAAAxITGlubwIQAABtbnRyUkdCIFhZWiAHzgACAAkABgAxAABhY3NwTVNGVAAAAABJRUMgc1";	ImgData += "JHQgAAAAAAAAAAAAAAAAAA9tYAAQAAAADTLUhQICAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABFjcHJ0AAABUAAAADNkZXNjAAABhAAAAGx3dHB0AAAB8AAAABRia3B0AAACBAAAABRyWF";	ImgData += "laAAACGAAAABRnWFlaAAACLAAAABRiWFlaAAACQAAAABRkbW5kAAACVAAAAHBkbWRkAAACxAAAAIh2dWVkAAADTAAAAIZ2aWV3AAAD1AAAACRsdW1pAAAD+AAAABRtZWFzAAAEDAAAACR0ZWNoAAAEMAAAAAxyVFJDAAAEPAAACAxnVFJ";	ImgData += "DAAAEPAAACAxiVFJDAAAEPAAACAx0ZXh0AAAAAENvcHlyaWdodCAoYykgMTk5OCBIZXdsZXR0LVBhY2thcmQgQ29tcGFueQAAZGVzYwAAAAAAAAASc1JHQiBJRUM2MTk2Ni0yLjEAAAAAAAAAAAAAABJzUkdCIElFQzYxOTY2LTIuMQAAAAAAAAAAAAAA";	ImgData += "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWFlaIAAAAAAAAPNRAAEAAAABFsxYWVogAAAAAAAAAAAAAAAAAAAAAFhZWiAAAAAAAABvogAAOPUAAAOQWFlaIAAAAAAAAGKZAAC3hQAAGNpYWVogAAAAAAAAJKAAAA+EAAC2z2Rlc2MAAAAAAAAAF";	ImgData += "klFQyBodHRwOi8vd3d3LmllYy5jaAAAAAAAAAAAAAAAFklFQyBodHRwOi8vd3d3LmllYy5jaAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABkZXNjAAAAAAAAAC5JRUMgNjE5NjYtMi4xIERlZmF1bHQgUkdCIGNvbG91ciBzcGFjZSAt";	ImgData += "IHNSR0IAAAAAAAAAAAAAAC5JRUMgNjE5NjYtMi4xIERlZmF1bHQgUkdCIGNvbG91ciBzcGFjZSAtIHNSR0IAAAAAAAAAAAAAAAAAAAAAAAAAAAAAZGVzYwAAAAAAAAAsUmVmZXJlbmNlIFZpZXdpbmcgQ29uZGl0aW9uIGluIElFQzYxOTY2LTIuMQAAAAAA";	ImgData += "AAAAAAAALFJlZmVyZW5jZSBWaWV3aW5nIENvbmRpdGlvbiBpbiBJRUM2MTk2Ni0yLjEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHZpZXcAAAAAABOk/gAUXy4AEM8UAAPtzAAEEwsAA1yeAAAAAVhZWiAAAAAAAEwJVgBQAAAAVx/nbWVhcwAAAAAAAAAB";	ImgData += "AAAAAAAAAAAAAAAAAAAAAAAAAo8AAAACc2lnIAAAAABDUlQgY3VydgAAAAAAAAQAAAAABQAKAA8AFAAZAB4AIwAoAC0AMgA3ADsAQABFAEoATwBUAFkAXgBjAGgAbQByAHcAfACBAIYAiwCQAJUAmgCfAKQAqQCuALIAtwC8AMEAxgDLANAA1QDbAOAA5Q";	ImgData += "DrAPAA9gD7AQEBBwENARMBGQEfASUBKwEyATgBPgFFAUwBUgFZAWABZwFuAXUBfAGDAYsBkgGaAaEBqQGxAbkBwQHJAdEB2QHhAekB8gH6AgMCDAIUAh0CJgIvAjgCQQJLAlQCXQJnAnECegKEAo4CmAKiAqwCtgLBAssC1QLgAusC9QMAAwsDFgMhAy0DOANDA08";	ImgData += "DWgNmA3IDfgOKA5YDogOuA7oDxwPTA+AD7AP5BAYEEwQgBC0EOwRIBFUEYwRxBH4EjASaBKgEtgTEBNME4QTwBP4FDQUcBSsFOgVJBVgFZwV3BYYFlgWmBbUFxQXVBeUF9gYGBhYGJwY3BkgGWQZqBnsGjAadBq8GwAbRBuMG9QcHBxkHKwc9B08HYQd0B4YHmQes";	ImgData += "B78H0gflB/gICwgfCDIIRghaCG4IggiWCKoIvgjSCOcI+wkQCSUJOglPCWQJeQmPCaQJugnPCeUJ+woRCicKPQpUCmoKgQqYCq4KxQrcCvMLCwsiCzkLUQtpC4ALmAuwC8gL4Qv5DBIMKgxDDFwMdQyODKcMwAzZDPMNDQ0mDUANWg10DY4NqQ3DDd4N+A4TDi4OSQ5";	ImgData += "kDn8Omw62DtIO7g8JDyUPQQ9eD3oPlg+zD88P7BAJECYQQxBhEH4QmxC5ENcQ9RETETERTxFtEYwRqhHJEegSBxImEkUSZBKEEqMSwxLjEwMTIxNDE2MTgxOkE8UT5RQGFCcUSRRqFIsUrRTOFPAVEhU0FVYVeBWbFb0V4BYDFiYWSRZsFo8WshbWFvoXHRdBF2UXiReu";	ImgData += "F9IX9xgbGEAYZRiKGK8Y1Rj6GSAZRRlrGZEZtxndGgQaKhpRGncanhrFGuwbFBs7G2MbihuyG9ocAhwqHFIcexyjHMwc9R0eHUcdcB2ZHcMd7B4WHkAeah6UHr4e6R8THz4faR+UH78f6iAVIEEgbCCYIMQg8CEcIUghdSGhIc4h+yInIlUigiKvIt0jCiM4I2YjlCPCI";	ImgData += "/AkHyRNJHwkqyTaJQklOCVoJZclxyX3JicmVyaHJrcm6CcYJ0kneierJ9woDSg/KHEooijUKQYpOClrKZ0p0CoCKjUqaCqbKs8rAis2K2krnSvRLAUsOSxuLKIs1y0MLUEtdi2rLeEuFi5MLoIuty7uLyQvWi+RL8cv/jA1MGwwpDDbMRIxSjGCMbox8jIqMmMymzLUMw0z";	ImgData += "RjN/M7gz8TQrNGU0njTYNRM1TTWHNcI1/TY3NnI2rjbpNyQ3YDecN9c4FDhQOIw4yDkFOUI5fzm8Ofk6Njp0OrI67zstO2s7qjvoPCc8ZTykPOM9Ij1hPaE94D4gPmA+oD7gPyE/YT+iP+JAI0BkQKZA50EpQWpBrEHuQjBCckK1QvdDOkN9Q8BEA0RHRIpEzkUSRVVFmk";	ImgData += "XeRiJGZ0arRvBHNUd7R8BIBUhLSJFI10kdSWNJqUnwSjdKfUrESwxLU0uaS+JMKkxyTLpNAk1KTZNN3E4lTm5Ot08AT0lPk0/dUCdQcVC7UQZRUFGbUeZSMVJ8UsdTE1NfU6pT9lRCVI9U21UoVXVVwlYPVlxWqVb3V0RXklfgWC9YfVjLWRpZaVm4WgdaVlqmWvVbRVuVW+";	ImgData += "VcNVyGXNZdJ114XcleGl5sXr1fD19hX7NgBWBXYKpg/GFPYaJh9WJJYpxi8GNDY5dj62RAZJRk6WU9ZZJl52Y9ZpJm6Gc9Z5Nn6Wg/aJZo7GlDaZpp8WpIap9q92tPa6dr/2xXbK9tCG1gbbluEm5rbsRvHm94b9FwK3CGcOBxOnGVcfByS3KmcwFzXXO4dBR0cHTMdSh1h";	ImgData += "XXhdj52m3b4d1Z3s3gReG54zHkqeYl553pGeqV7BHtje8J8IXyBfOF9QX2hfgF+Yn7CfyN/hH/lgEeAqIEKgWuBzYIwgpKC9INXg7qEHYSAhOOFR4Wrhg6GcobXhzuHn4gEiGmIzokziZmJ/opkisqLMIuWi/yMY4zKjTGNmI3/jmaOzo82j56QBpBukNaRP5GokhGSepLj";	ImgData += "k02TtpQglIqU9JVflcmWNJaflwqXdZfgmEyYuJkkmZCZ/JpomtWbQpuvnByciZz3nWSd0p5Anq6fHZ+Ln/qgaaDYoUehtqImopajBqN2o+akVqTHpTilqaYapoum/adup+CoUqjEqTepqaocqo+rAqt1q+msXKzQrUStuK4trqGvFq+LsACwdbDqsWCx1rJLssKzOLOutC";	ImgData += "W0nLUTtYq2AbZ5tvC3aLfguFm40blKucK6O7q1uy67p7whvJu9Fb2Pvgq+hL7/v3q/9cBwwOzBZ8Hjwl/C28NYw9TEUcTOxUvFyMZGxsPHQce/yD3IvMk6ybnKOMq3yzbLtsw1zLXNNc21zjbOts83z7jQOdC60TzRvtI/0sHTRNPG1EnUy9VO1dHWVdbY11zX4Nhk2Oj";	ImgData += "ZbNnx2nba+9uA3AXcit0Q3ZbeHN6i3ynfr+A24L3hROHM4lPi2+Nj4+vkc+T85YTmDeaW5x/nqegy6LzpRunQ6lvq5etw6/vshu0R7ZzuKO6070DvzPBY8OXxcvH/8ozzGfOn9DT0wvVQ9d72bfb794r4Gfio+Tj5x/pX+uf7d/wH/Jj9Kf26/kv+3P9t////4QMcRXhpZg";	ImgData += "AATU0AKgAAAAgACAEPAAIAAAAWAAAAbgEQAAIAAAAiAAAAhAESAAMAAAABAAEAAAEaAAUAAAABAAAApgEbAAUAAAABAAAArgEoAAMAAAABAAIAAAEyAAIAAAAUAAAAtodpAAQAAAABAAAAygAAAABFQVNUTUFOIEtPREFLIENPTVBBTlkAS09EQUsgUExBWVNQT1JUIFZpZ";	ImgData += "GVvIENhbWVyYSwgWng1AAAAAEgAAAABAAAASAAAAAEyMDE0OjA3OjI3IDA3OjE1OjI0AAAlgpoABQAAAAEAAAKMgp0ABQAAAAEAAAKUiCIAAwAAAAEAAgAAiCcAAwAAAAEAfQAAkAAABwAAAAQwMjMwkAMAAgAAABQAAAKckAQAAgAAABQAAAKwkQEABwAAAAQBAgMAkQIABQ";	ImgData += "AAAAEAAALEkgEACgAAAAEAAALMkgIABQAAAAEAAALUkgMACgAAAAEAAALckgQACgAAAAEAAALkkgUABQAAAAEAAALskgcAAwAAAAEABQAAkggAAwAAAAEAAAAAkgkAAwAAAAEAIAAAkgoABQAAAAEAAAL0khUABQAAAAEAAAL8oAAABwAAAAQwMTAwoAEAAwAAAAEAAQAAoAI";	ImgData += "ABAAAAAEAAABxoAMABAAAAAEAAABkohUABQAAAAEAAAMEohcAAwAAAAEAAgAAowAABwAAAAEDAAAApAEAAwAAAAEAAAAApAIAAwAAAAEAAAAApAMAAwAAAAEAAAAApAQABQAAAAEAAAMMpAUAAwAAAAEAIQAApAYAAwAAAAEAAAAApAcAAwAAAAEAAQAApAgAAwAAAAEAAAAA";	ImgData += "pAkAAwAAAAEAAAAApAoAAwAAAAEAAAAApAwAAwAAAAEAAAAAAAAAAAAAAAEAAAFAAAAADgAAAAUyMDE0OjA3OjI3IDA3OjE1OjI0ADIwMTQ6MDc6MjcgMDc6MTU6MjQAAAAuVwAAFlsAAAAZAAAAAwAAAAMAAAABAAAABwAAAAEAAAAAAAAAAQAAAAMAAAABAAAAJwAAAAoAAA";	ImgData += "B9AAAAAQAAAH0AAAABAAAAAAAAAAH/4QJ3aHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA1LjEuMiI+CiAgIDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vc";	ImgData += "mcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+CiAgICAgIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICAgICAgICAgIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyI+CiAgICAgICAgIDx4bXA6Q3JlYXRlRGF0ZT4yMDE0LTA3LTI3VDA";	ImgData += "3OjE1OjI0PC94bXA6Q3JlYXRlRGF0ZT4KICAgICAgICAgPHhtcDpNb2RpZnlEYXRlPjIwMTQtMDctMjdUMDc6MTU6MjQ8L3htcDpNb2RpZnlEYXRlPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgI";	ImgData += "CAgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIj4KICAgICAgICAgPHBob3Rvc2hvcDpEYXRlQ3JlYXRlZD4yMDE0LTA3LTI3VDA3OjE1OjI0PC9waG90b3Nob3A6RGF0ZUNyZWF0ZWQ+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogI";	ImgData += "CA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgr/2wBDAAIBAQIBAQICAQICAgICAwUDAwMDAwYEBAMFBwYHBwcGBgYHCAsJBwgKCAYGCQ0JCgsLDAwMBwkNDg0MDgsMDAv/2wBDAQICAgMCAwUDAwULCAYICwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsL";	ImgData += "CwsLCwv/wAARCABkAHEDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc";	ImgData += "3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEK";	ImgData += "RobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD9/KKKKA";	ImgData += "Cisb4h+Ln8B+CdU1mDTNQ1k6ZbtcmysED3Nwq8lYlJAZsZIXPOMCsTwx8bvDnxR+H8Gr/DjxDpRXVbZmsnuXCGOTBAEsLFXUq/DIcMCCODQK62O0zmjNeC+M/j7a/se/DSGw+J3ia88d+M7tWu/wB4qQeaXPXag229uuMKPmY4ONxya+Lvj1+3p4n8fatIPEOtSwWUuWTStPlaCON";	ImgData += "ewIU7pPq5OewFctbFwpPl3fY7MPg6mJ1S0P0yHxF8PnWE04a5o/8AaEj+Wlt9sj85m/uhN2SfbFchqX7Xfw60fxBeaZqnie0gvLCZoJ1aKXajqcMu8LtOCCOD2r8rbLxL4u1aYXHh7SodLjJzHLcyiNvqAAWFTwXvjKOVw+n2UkoHzS/aNsb85BXuTyeoFYrFzl9lfedn9lpbzP11";	ImgData += "8I/FLw54+bb4L13StUcLvKW10kjhfUqDkflW9X4/aZ8R/EHhS8STxDp89ooYAXcD7hHn/poh3D9K+iv2bv2+dW8DCG18U3MniHQy53rNKXurfP8AzzlY8gcfK3B5wRWyxKXxqxz1cvnBXjqfe9Fc/wDDn4paF8V9DGoeA9Rhv4AQsgXh4WwDtdDyrAEcGugrpTvqjgatuFFFFMAo";	ImgData += "oooAKKDyK870C78c+F/iPrUvxW1fwlJ4Luo0GlzQxtZ3VpNnbskEjMsm8HOQ33hwMHATYm7Hn3xp/aHv/hX+0VJp2m+L/DVlajSoby40LxSTp1vdKzOvn2GoqrbWXZiSKRGB4KlcknzvUPjtf+GL5fG3x0+GXwt1Hw3rcTjSdT0KaK9ur6dSWRvNnjRniIVsuE4+UjOa5e9/astL";	ImgData += "b4o3r+PbTSvi9o0d3MLO31HTre01vw7co2xowrr5UkDbSRIhIJ54PB8z/bO/aOl+N2v2F/8A2ZNo6Wtp9gttP+0LKYjuJZgygDJ+ToOAgrgxeL9lTbg9b6GuBofXK3LfRHmXxQ+JGu/G7x7ez3Nzi4upDJNJgtFZRkkrHGvRQoOFUcDr1JrO0nStA0CdraCOGS5if95cSxb3Z/UvV";	ImgData += "3wno0ek6OiSeUJmy8pJO5mPr614x8QvGcOlfFLWtKtLuIRQXAklRdxfDKrso54HJyfSubLMPHFVHGbd7bn0Neo6MeWnsj6BgkiktzLHJG6ICSQOn1zU6OVEZuB5XnExpvQHecE4Bz6An8K8f8E+NLCXTvOtLzThayK1rEba7V54SpD7jEcrtJPfP5V2Pg7Wb3xNKIH1BpoLcvO8wV";	ImgData += "SCC6+XGGK9cB+VxgcV3yy+FJTbexxutOTSsds1mLiJo5tjI3BUxggj+tZF/wDD6MSi78MyLYXa/wBxMRS+zp0/EVpxRqScGLHpuP6VLHGiHjy/oWNebGfQ6lKzOh/Zx+PWqfCLx/b39irx3dqfJvLRuftEJILR5PGGxlW7HH4/pl4O8WWXjvwvYax4clE9lqMKzxP3wex9CDkEdiC";	ImgData += "K/JvxNbNZCK/sFzLbgq+053RnqMfy9K+wP+CbfxNkN5qnhi7nMltdQDU7PcxO1htWRR2wQyNx3BNdeFq8suR7M4MdRTXtIn1tRRRXonlhRRRQAVmeM9H07XvC1/a+LdOi1fTpIG8+zkthci4UAkr5RB3k9hjk1p0UAfB3j3Uf2cvCfg8X3wc8OXmsa/Ddi3TT0vNQ0y4Cyt+8V3df";	ImgData += "lEYzhCMjaAMV83eLJLXUvHtu0AW2gV5HihaYyvCDkhd55YgcbiMnGa/R79qj9kzw78a/COoX9nYRWHiy0ia4stStQIZ3lQFgkrD/AFisRg7s4zkYNfnVqsKJ4qsMgiN4HZc4+/wcn8N1eDmilGcOx6eULllMejQk/JM2T7f/AFq4Xxr8Ivh14v8AiTE/jNIv+Eo1q3IiSLUJrW7voYV";	ImgData += "CvsWJl3gK6hsDptz0r0VQjj/WqB64HNfMf7YXw88b3/xU0rUPBc+v6jp85jTTRDeIv9n3jIwkSHygrwKyxqS7tgliMjIFGAi51LKfL5noVZW6XOE8S+G9A0PX28J/D/SNRk8X6f4kmtYdT+1AJdweYfIjVd2A4BRcsB8yMckHFeoeGPG9/onijUtN+K11ftrunktuidI55ZX2snmiP";	ImgData += "5W4b+DKtkHHUDpPg18BNA+Fvw81DUfGt/qj3fiPTUOpRXrxwS2wVfOaOIKd3mq4LBwxfcoIryL4hQ+F/BPhmd9J1i08Z6n4hMWpabqs9zPHq2mwsqsouVYFGdsEE7lfJ5Qbc179LEKremtV37nLKDWrPpfwh46Mt4dO8Yo9hfKBtEqhC+R0PYH8efrXTwa1YTXghhu4mmALbFIJ";	ImgData += "wOvavleLx3YafdXV7Nc+I/G2m2mireX19ZxNA2m3TcAXBfrEpGM9SeOcGt6z+IqfB/xz4Xi+Kxi0cNpw1i/NrDJLPbu28RwTKATI7DBLYAReOcZrKtgIO8loxwqtaH0sGgZWDvlSORtzn9K9B/Yf8Vjwh8cNBzIvlLqT6buZuNkqlQPblk/KuAjbGMTSPxuDAfeGOPrwa639k/Rv7";	ImgData += "W+PXh22RppIk1tHwWJACsXP6L3rx4StOPe5tWV6cvQ/TIdKKB0or3D58KKKKACvNP2o/GPxH8D/AA8kv/2b/DWleJ9Th3NPb3V0yTrGFJzbwgBZ3zj5Gkj9ixwp9Lo60Ezi5RaTsfl/4l/4Kz/EXxNLaJYX1t4Xu7Jfs95AunIEmmVjlmEwZomH3WjJ4I7civLdU8fXXiFmurxI";	ImgData += "WvUmNysiYQSFmJYYHABDN04r9EP2uP2EfCXxz07UNa0DwV4SvvGtzsVrvUbq609Z0HBMk1odxcL0Zlbpg8cj8qvF+z4TeM7zS/DuvaH4osLaR0eTSnmmtoXV2Voo5ZkRnKFSCwBB9c5rysdgp1kpKVzwZ5hjMmqqVSacX/W3+R7voNjL4igjfT45z5qhscZUehPSr0HhW51GZ008O";	ImgData += "CpAkDELt/MVs/DvSovD/gK0n00zzC8t47shm4JZQflHQf8A1qZomsSvrl0DHtWdgSc8jAxmuWtSo4SVNVm7vex9nh8ZUxFP2iXS55Z8efg7N8Xfh3c6BaTaRb3Ul1BKs2qacL2O32SAs0ahlMc23cEkB+RjkhhwfKv2a/2fNW8B2uoXXxo0Hw9HpF9ZXL3f23y5b/TGicrjOGjMUk";	ImgData += "QaXcrBlwueSQPSPjt8PPix8OfE+qeLPgzrVn430nWrsTTeGNWtkim01jGqn7DOjx7oiY93ludwLsQW6Dx7xbD8YPj4ttoXinwvrehaBqcci6ta2lpFYpH94Rxvd3Uz+bE3yM+xRxlcMa9ONKph17NTXI9fM3jUVZKVtThfgPpjfFTx/oUOhTWmlWN5dWkGpaRZSzxS31nbRmdrqdD";	ImgData += "lWVmRFbcf9ZKMDB57n4o/sa6zc/FWAfDsXeqabfWE+o3N9rt6JYTdpNn7JK6YlVZUcKrBW2hHyQQAfX/gl8Dbr4eS3msfEDVpvEfi7V4YYb+/OEijjiUKkMAAB2AKuWIyxAzgACvQVslznY/A6mTmprZlJVP3T02NVR7lb7DZ+CfDMEGjpLBYadClvbwLISsUagKiBmOcDgZJzgV73";	ImgData += "/wTe+HUmofFf+0b0rIdGt5buYk5/ezZjQfkZD+FeCWOmSeMNZt7fSoZZ4lkURouXM8hIC7R35OAO5PtX6OfstfA1fgf8OI7fUAjazqJFxqDqc7Wx8sQPcIOM9yWPeuTCxdarzPZGeNqezp8l9Wel0UUV7J4gUUUUAFFFFABX5y/8Fa/gj4P0r4taBq3hTSbfT/EGt281zqksDhYrs";	ImgData += "o8ao8sA48w5YGTgsBg5wCP0ar8yv8Agrd4qsvDv7QWoXmnXAmu4NItYJo3UoIZf3hRdx4I2urEjgc571y4xyVJqG70POzVQeHfOrnmn7PPxE0Wy8a3PhSXUmjuJYN1nay3BMEZUktHGHOFbBztHUA+ldl+0F4ll+Dvw4n8QaabVbmC6tlhiuVJjvd0gDRfLzym87h93GeQMH3b/";	ImgData += "gnH/wAE3j8PPAt7rP7TsHhTxTN4kEd3Z6TJZW2p29ipwwmN1JEWeVwR8qN5SjpuJLVj/tbf8EYLH4g6pqWt/s262PDzyW7SweG7x5DpIusrxbsCfscbLvyqoyq2CoALA0sFRnGKrLmkuplhni6eEslZvp1R8XfEz9s/UPGculR+C7FdDhtyzXSXLi5W4c4AGQF2oOefvHPbHPS+B";	ImgData += "/jvo/izUBY30htbxY/9a7NHBcMB83lluV9g3Jqbwr/wSW+MV18RItB8d+GLjR7a8trgW2t211b32mwXKxl4Rc7HEqwuVMZdY9ys6HaRmvMvEH7KvxQ+F2heJNa8aeE9c0KHwZdWsV7PdwSIiPNMY43gmA8udA6ruZGICujHg8XiMLHELXc5cPmGY4GfPJNx6prtv6ep7o";	ImgData += "PEUd0CNEjub6QDjys7M+7sAB+tavg34feIPiLrMOlWVvNd3tzhktbQFiwxzu9gepJC9ya+n/2Q/wBlLwp8cPgb4T8c+INQ1K6/4SPTor6S0gZYIoZCP3kZYAuSrhlPI5B6V9N+A/hX4d+GVm0PgTR7HTVcYkeKP95L/vucs34k15NLLarf7x2X4n20szg4p01ueTfso/scW3wdij1";	ImgData += "jx1Ha3Wv/AHoI0O+PT+MHB6PJyRuxgDhe5PvNFFexTpxpR5Y7HmVKkqsuaT1CiiirICiiigAooooA8T/b9/aL1f8AZf8A2epvE/gZdOOof2nZ2KtewtLDGssoViVV1JJGVHPBYHnpXyV+0Hqvw+/aq8ceGvjj4httYf4V6LdDSPEtg0KC9vtVjnghsbXyQxDQTG8+d94AWDa3Dn";	ImgData += "Gl+2J+yz+1R+0hf/EH4cXyeF9X+HXi3x3peu6D4jn8RJbXHhXSrae1mktPsaWe6Ukwz4BdyS+PMAYeVg+Mf+Cafx2u9K8WfBjwvbeAB8IvFPxO0/x7D4wm1+4XWNLtbe+s757L+yxa7ZZC9mY1f7QqhXyf7o6Y0oOKcrX33W2n49jKtRhXjyz23+4+sn/4KKfDfSvGd1os48QW+";	ImgData += "labra+GJdf/ALJkGhw6juCC1N0PlUhiq5ICgnGeKzNe/wCCnXgDQ/HRsfsPii78Mxa2nhqfxbbaf5uiRak0qxC388NlvnbBdVKgjuOa+evFf/BMz4qat+wN8VvhnbvoE/iDxR8X5vGmkvJrTiKTS5Nbhvdss32fMcnkLInlbGAICbyPmr4//aE+NEPwE+B3iz9mjwl8UPhD4j8O";	ImgData += "aZ8Rre402JddmtfiCk41mK7GnHQ5bUbgkybftKy/NFgovzqQ406cnZPrb5d/+AbWR+k/wt/4KQWkNpqmmfFmyuNV8Wr431PwvpWleHLEz3d7FbNu80wtJwEQ7WcsASOAOg9I8Qat4L/b4/ZS8W6bp82uyaDrtre6JqUFsHsdVspo8pLBtYbop1ZQACD1B5Br4d8X/wDBID4n3vxG174";	ImgData += "iafpXgPxJri+PdX1SDwzrXiO9ttO1/RbtFaEyXVtb+ZY3cM7SMFVJUKgAkk/L9r/sF/s33/7OHwNn07xnoHw98L+I9e1KfV9UtPBdtcJYRSyBUQNPdM0t5OsUcSPdOE8wpny0GFE1FBLmi9RNJqzPkT/gnf8AGHxL4S+HOgeEvgr8TfCWrato1+0mpfDnxGsdhr8UUlwzSLHK+0iRt";	ImgData += "zuEKbVPy5GCK+u/i5+27YfBjxvFYeMfBXjqHQv7WtdFl8RSWcUOnLc3DokQj8yVZJ0LSKpeNGUENycV8z/tD/sA/Hz9pTwwvw++MY+DPiq0gvFl0/4tzCXTvGOlRJcB45I7C3tPJ+1rEoTzY7iKNmy3lqPlpnxi/wCCTfxA+M/7Q/iHUfFeseDr/RNX8baV4osvFupXd9e+JtC02z";	ImgData += "ls5ZdFsLdx5FrHMbN1eSKRVZbh98bGrlyTknJ/1/XzCMVFWR7f8Rv+ConhT4dz67PN4S8b6hoeha5N4cfWba1gFjPfxcSQI7yg7gwZRkDJXjORmvff8FRdC8N2OrJ8QvBPi/w1rWhanpNjf6VqJto7iCLUZWit7jIkKldy8rndyMAk4ryLWf8Agl/8SvGP7Eni/wCHN7rXh7S9e1T";	ImgData += "4z3HxC0+6/tG4uYjpza4NQEMriFWWRod0WwBlXIG5hknov2uv+CW3iX9pP9o74n+LdG8TaNpen+NvCfhqz0wTxSyyafrGiatJqFvJNEpUSW8nmBW2uG4Iwc0oxovd/wBafpf7hqx6d+1B+2jB8NPiW3hXSrvUdEvPDt9oF3qV4LS3u7e7tNSuprVYSjuHUb4vmdcMOCu7DCvpAV8Ff";	ImgData += "G7/AIJn/Ff9ovUvH3i74l+J/BFp408Wf8Ina2VnphvE0uxt9E1KW+Ls7gyNLK9w4wFxhVBJHT70TIQeZjdjnHTNZVFFJcr1/wCAv+CGgtFFFZCCiiigAooooAKx5Ph5oE3iMaxNomkPq4YML1rKM3IIGAfN27s4460UUAbFFFFABRRRQAUUUUAFFFFABRRRQB//2Q==";		vToday = new Date();	vParaA = uParam[0].Annee_Scolaire;	vParaM = uParam[0].Mois;	vParaLm = uParam[0].LibMois;	AnScol = ds.Annees_Scolaires.query("ID = :1", vParaA);	vAnScol = AnScol[0].ID;	vLibAn = AnScol[0].Annee_Scolaire;	vCal = ds.Calendrier.query("Annee_Scolaire.ID = :1 and sMois = :2", vAnScol, vParaM);	dDeb = vCal[0].dDeb;	dFin = vCal[0].dFin;	if (vAnScol !== null) {		vHtml = '<head> <meta charset="UTF-8"> </head> ';		vHtml += '<style> .break { page-break-after: always; } </style>';		eleves = ds.Parcours_Scolaire.query("Annee_Scolaire.ID = :1 and Classe != 'M*' and Classe != 'C*' order by Eleve.Nom_Complet", vAnScol);		eleves.forEach(function (eleve) {						vHtml += '<TABLE cellpadding="2px" cellspacing="2px" width=800 rules="all" style="border:solid 2px black; font-family:Calibri; font-size:12px; vertical-align: middle;">';			vHtml += '<TR><TD width=10% align=center"><IMG src="'+ImgData+'"></TD><TD width=20%>Ecole Française de Koh Samui<BR>143/1 Moo 4, Maret Lamai<BR>Koh Samui, 84310 Surathani<BR>Téléphone : 08 24 14 24 29</TD>';			vHtml += "<TD width=70% align=center><FONT SIZE=5><B>&nbsp;FICHE DE SUIVI MENSUEL&nbsp;<BR><FONT SIZE=3>Mois de "+vParaLm+"</B></TD></TR></TABLE><TABLE border=0><TR><TD height=15>&nbsp;</TD></TR></TABLE>";			vHtml += '<TABLE cellpadding="2px" cellspacing="3px" width=800 style="border:solid 1px black; font-family:Calibri; font-size:12px; vertical-align: middle;">';			vHtml += '<TR><TD COLSPAN=8></TD></TR>';						vNbCant = 0;			vNbAbs = 0;			vNbThai = 0;			vTable = '<TABLE border=0 style="font-family:Calibri; font-size:11px; vertical-align: middle;"><TR>';			vTableB = '<TABLE border=0 style="font-family:Calibri; font-size:10px; vertical-align: middle;"><TR>';			vLibAbs = "";			vLibCant = "";			vLibThai = "";						jourms = ds.Releve_Presences.query("Eleve.Eleve.ID = :1 and sMois = :2 order by Jour_Ouvre", eleve.Eleve.ID, vParaM);			if (jourms.length > 0) {				jourms.forEach(function (jourm) {					jOuv = jourm.Jour_Ouvre;					Nday = jOuv.getDate();					if (jourm.Present) {						vNbAbs += 1;						vLibAbs += "<TD bgcolor=#F8E0E6>"+((Nday < 10) ? '0': '')+Nday+"</TD>";					}					if (jourm.Cantine) {						vNbCant += 1;						vLibCant += "<TD bgcolor=#F8E0E6>"+((Nday < 10) ? '0': '')+Nday+"</TD>";					}					if (jourm.CoursThai) {						vNbThai += 1;						vLibThai += "<TD bgcolor=#F8E0E6>"+((Nday < 10) ? '0': '')+Nday+"</TD>";					}				});			}						vLibThai += "</TR></TABLE>";			vLibCant += "</TR></TABLE>";			vLibAbs += "</TR></TABLE>";									vHtml += '<TR><TD width=1%></TD><TD width=10%></TD><TD width=18%></TD><TD width=5%></TD><TD width=15%></TD><TD width=13%></TD><TD width=37%></TD><TD width=1%></TD></TR>';			vHtml += '<TR><TD></TD><TD align=right bgcolor=#A9D0F5><B>Nom&nbsp;</TD><TD>'+eleve.Eleve.Utilisateur.Nom+'</TD><TD></TD><TD align=right bgcolor=#A9D0F5><B>Absences du Mois&nbsp;</B></TD><TD COLSPAN=3>'+vTable+'<TD width=20 align=center><FONT COLOR=red>'+vNbAbs+'</B>'+vLibAbs+'</TD></TR>';			vHtml += '<TR><TD></TD><TD align=right bgcolor=#A9D0F5><B>Prénom&nbsp;</TD><TD>'+eleve.Eleve.Utilisateur.Prenom+'</TD><TD></TD><TD align=right bgcolor=#A9D0F5><B>Nb de repas pris&nbsp;</B></TD><TD COLSPAN=3>'+vTable+'<TD width=20 align=center COLSPAN=3><FONT COLOR=red>'+vNbCant+'</B>'+vLibCant+'</TD></TR>';			vHtml += '<TR><TD></TD><TD align=right bgcolor=#A9D0F5><B>Classe&nbsp;</TD><TD>' + eleve.Classe + '</TD><TD></TD><TD align=right bgcolor=#A9D0F5><B>Nb de cours thaï&nbsp;</B></TD><TD COLSPAN=3>'+vTable+'<TD align=center width=20 COLSPAN=3><FONT COLOR=red>'+vNbThai+'</B>'+vLibThai+'</TD></TR>';			vHtml += '<TR><TD></TD><TD align=right bgcolor=#A9D0F5><B>Filière&nbsp;</TD><TD>' + eleve.Filiere + '</TD><TD></TD><TD COLSPAN=4>&nbsp;</TD></TR>';			vHtml += '<TR><TD COLSPAN=8 height=20></TD></TR>';						vEnt = '<TABLE border=0 style="font-family:Calibri; font-size:11px; vertical-align: middle;"><TR><TD bgcolor=#A9D0F5 align=center width=40>Note</TD><TD bgcolor=#A9D0F5 align=center width=40>Note</TD><TD bgcolor=#A9D0F5 align=center width=40>Note</TD>';			if (vParaM >= 1 && vParaM <= 4) {				vEnt += '<TD bgcolor=#A9D0F5 align=center width=40>Note</TD><TD bgcolor=#A9D0F5 align=center width=40>Note</TD><TD bgcolor=#A9D0F5 align=center width=40>Note</TD><TD bgcolor=#A9D0F5 align=center width=90>Moyenne T1</TD><TD bgcolor=#A9D0F5 align=center width=240>Commentaire</TD></TR></TABLE>';			}			if (vParaM >= 5 && vParaM <= 7) {				vEnt += '<TD bgcolor=#A9D0F5 align=center width=40>Note</TD><TD bgcolor=#A9D0F5 align=center width=40>Note</TD><TD bgcolor=#A9D0F5 align=center width=40>Note</TD><TD bgcolor=#A9D0F5 align=center width=90>Moyenne T2</TD><TD bgcolor=#A9D0F5 align=center width=240>Commentaire</TD></TR></TABLE>';			}			if (vParaM >= 8 && vParaM <= 10) {				vEnt += '<TD bgcolor=#A9D0F5 align=center width=40>Note</TD><TD bgcolor=#A9D0F5 align=center width=40>Note</TD><TD bgcolor=#A9D0F5 align=center width=40>Note</TD><TD bgcolor=#A9D0F5 align=center width=90>Moyenne T3</TD><TD bgcolor=#A9D0F5 align=center width=240>Commentaire</TD></TR></TABLE>';			}						vHtml += '<TR><TD></TD><TD COLSPAN=2 height=30><I>Relevé de notes du trimestre</TD><TD COLSPAN=4>'+vEnt+'</TD><TD></TD></TR>';			vCoul = "#EFF2FB";						nbNotes = 0;			TotMoy = 0;			MoyGen = -1;						vQuery = "Eleve.Eleve.ID = :1 and Eleve.Annee_Scolaire.ID = :2 order by Matiere.Nom";			Notes = ds.Releve_Notes.query(vQuery,eleve.Eleve.ID,vAnScol);					Notes.forEach(function (note) {				vMat = note.Matiere.Nom;				if (vParaM >= 1 && vParaM <= 4) {					vEnt = vTable + '<TD width=40 align=center><I>' + ((note.N1T1 === null) ? '&nbsp;' : note.N1T1) + '</TD><TD width=40 align=center><I>' + ((note.N2T1 === null) ? '&nbsp;' : note.N2T1);					vEnt += '</TD><TD width=40 align=center><I>' + ((note.N3T1 === null) ? '&nbsp;' : note.N3T1) + '</TD><TD width=40 align=center><I>' + ((note.N4T1 === null) ? '&nbsp;' : note.N4T1);					vEnt += '</TD><TD width=40 align=center><I>' + ((note.N5T1 === null) ? '&nbsp;' : note.N5T1) + '</TD><TD width=40 align=center><I>' + ((note.N6T1 === null) ? '&nbsp;' : note.N6T1);					vEnt += '</TD><TD width=90 align=center>' + ((note.MoyT1 === null) ? '&nbsp;' : note.MoyT1) + '</B></TD>';					vEnt += '<TD width=240 align=center><FONT style="font-family:Calibri; font-size:10px; vertical-align: middle;">' + ((note.CommT1 === null) ? '&nbsp;' : note.CommT1);					vEnt += '</TD></TR></TABLE><TD></TD></TR>';					vHtml += '<TR><TD></TD><TD bgcolor=' + vCoul + ' COLSPAN=2>'+ vMat +'</TD><TD bgcolor=' + vCoul + ' COLSPAN=4>' + vEnt + '</TD></TR>';					if (note.MoyT1 !== null) {						nbNotes += 1;						TotMoy += note.MoyT1;					}				}				if (vParaM >= 5 && vParaM <= 7) {					vEnt = vTable + '<TD width=40 align=center><I>' + ((note.N1T2 === null) ? '&nbsp;' : note.N1T2) + '</TD><TD width=40 align=center><I>' + ((note.N2T2 === null) ? '&nbsp;' : note.N2T2);					vEnt += '</TD><TD width=40 align=center><I>' + ((note.N3T2 === null) ? '&nbsp;' : note.N3T2) + '</TD><TD width=40 align=center><I>' + ((note.N4T2 === null) ? '&nbsp;' : note.N4T2);					vEnt += '</TD><TD width=40 align=center><I>' + ((note.N5T2 === null) ? '&nbsp;' : note.N5T2) + '</TD><TD width=40 align=center><I>' + ((note.N6T2 === null) ? '&nbsp;' : note.N6T2);					vEnt += '</TD><TD width=90 align=center>' + ((note.MoyT2 === null) ? '&nbsp;' : note.MoyT2) + '</B></TD>';					vEnt += '<TD width=240 align=center><FONT style="font-family:Calibri; font-size:10px; vertical-align: middle;">' + ((note.CommT2 === null) ? '&nbsp;' : note.CommT2);					vEnt += '</TD></TR></TABLE><TD></TD></TR>';					vHtml += '<TR><TD></TD><TD bgcolor=' + vCoul + ' COLSPAN=2>'+ vMat +'</TD><TD bgcolor=' + vCoul + ' COLSPAN=4>' + vEnt + '</TD></TR>';					if (note.MoyT2 !== null) {						nbNotes += 1;						TotMoy += note.MoyT2;					}				}				if (vParaM >= 8 && vParaM <= 10) {					vEnt = vTable + '<TD width=40 align=center><I>' + ((note.N1T3 === null) ? '&nbsp;' : note.N1T3) + '</TD><TD width=40 align=center><I>' + ((note.N2T3 === null) ? '&nbsp;' : note.N2T3);					vEnt += '</TD><TD width=40 align=center><I>' + ((note.N3T3 === null) ? '&nbsp;' : note.N3T3) + '</TD><TD width=40 align=center><I>' + ((note.N4T3 === null) ? '&nbsp;' : note.N4T3);					vEnt += '</TD><TD width=40 align=center><I>' + ((note.N5T3 === null) ? '&nbsp;' : note.N5T3) + '</TD><TD width=40 align=center><I>' + ((note.N6T3 === null) ? '&nbsp;' : note.N6T3);					vEnt += '</TD><TD width=90 align=center>' + ((note.MoyT3 === null) ? '&nbsp;' : note.MoyT3) + '</B></TD>';					vEnt += '<TD width=240 align=center><FONT style="font-family:Calibri; font-size:10px; vertical-align: middle;">' + ((note.CommT3 === null) ? '&nbsp;' : note.CommT3);					vEnt += '</TD></TR></TABLE><TD></TD></TR>';					vHtml += '<TR><TD></TD><TD bgcolor=' + vCoul + ' COLSPAN=2>'+ vMat +'</TD><TD bgcolor=' + vCoul + ' COLSPAN=4>' + vEnt + '</TD></TR>';					if (note.MoyT3 !== null) {						nbNotes += 1;						TotMoy += note.MoyT3;					}				}				if (vCoul === '#EFF2FB') {					vCoul = "#CED8F6";				} else {					vCoul = "#EFF2FB";				}			});						if (nbNotes > 0) {				MoyGen = TotMoy / nbNotes;				MoyGen = Math.round(MoyGen*10)/10;			} 			vEnt = vTable + '<TD width=40 align=center>&nbsp;</TD><TD width=40 align=center>&nbsp;';			vEnt += '</TD><TD width=40 align=center>&nbsp;</TD><TD width=40 align=center>&nbsp;';			vEnt += '</TD><TD width=40 align=center>&nbsp;</TD><TD width=40 align=center>&nbsp;';			vEnt += '</TD><TD width=90 align=center><B>' + ((MoyGen < 0) ? '&nbsp;' : MoyGen) + '</B></TD>';			vEnt += '<TD width=240 align=center><FONT style="font-family:Calibri; font-size:10px; vertical-align: middle;">&nbsp;';			vEnt += '</TD></TR></TABLE><TD></TD></TR>';			vHtml += '<TR><TD></TD><TD bgcolor=' + vCoul + ' COLSPAN=2><B>Moyenne générale du trimestre</B></TD><TD bgcolor=' + vCoul + ' COLSPAN=4>' + vEnt + '</TD></TR>';								vHtml += '<TR><TD COLSPAN=8 height=20></TD></TR>';			vEnt = '<TABLE border=0 style="font-family:Calibri; font-size:11px; vertical-align: middle;"><TR><TD COLSPAN=2 bgcolor=#A9D0F5 align=center>Dates Prévues</TD><TD COLSPAN=2 bgcolor=#A9D0F5 align=center>Dates réelles</TD><TD ROWSPAN=2 valign=middle width=50 bgcolor=#A9D0F5 align=center>Réalisé</TD></TR>';			vEnt += '<TR><TD width=50 align=center bgcolor=#A9D0F5>Début</TD><TD width=50 align=center bgcolor=#A9D0F5>Fin</TD><TD width=50 align=center bgcolor=#A9D0F5>Début</TD><TD width=50 align=center bgcolor=#A9D0F5>Fin</TD></TR></TABLE>';			vHtml += '<TR><TD></TD><TD COLSPAN=5 height=30><I>Suivi du programme par matières</TD><TD>'+vEnt+'</TD><TD></TD></TR>';						vQuery = "eleve.ID = :1 and chapitre.Programme.Annee_scolaire.ID = :2 and ( (fin_reelle >= :3 and fin_reelle <= :4) or (fin_reelle = null and debut_reel <= :4) or";			vQuery += "(debut_reel = null and chapitre.Date_Debut <= :4) ) order by chapitre.Programme.Matiere.Nom, chapitre.Date_Debut";			Suivis = ds.Abonne.query(vQuery,eleve.Eleve.ID,vAnScol,dDeb,dFin);			vRupt = "";						Suivis.forEach(function (suivi) {				vMat = suivi.chapitre.Programme.Matiere.Nom;												Nday = suivi.chapitre.Date_Debut.getDate();				Nday = ((Nday < 10) ? '0' : '') + Nday; 				Nmonth = suivi.chapitre.Date_Debut.getMonth() + 1;				Nmonth = ((Nmonth < 10) ? '0' : '') + Nmonth; 				Nyear = suivi.chapitre.Date_Debut.getYear();				Nyear = ((Nyear < 200) ? 1900 : 0) + Nyear; 				ldDeb =  Nday + '/' + Nmonth + '/' + Nyear;								Nday = suivi.chapitre.Date_Fin.getDate();				Nday = ((Nday < 10) ? '0' : '') + Nday; 				Nmonth = suivi.chapitre.Date_Fin.getMonth() + 1;				Nmonth = ((Nmonth < 10) ? '0' : '') + Nmonth; 				Nyear = suivi.chapitre.Date_Fin.getYear();				Nyear = ((Nyear < 200) ? 1900 : 0) + Nyear; 				ldFin =  Nday + '/' + Nmonth + '/' + Nyear;								dDreel = suivi.debut_reel;				if (dDreel !== null) {					Nday = dDreel.getDate();					Nday = ((Nday < 10) ? '0' : '') + Nday; 					Nmonth = dDreel.getMonth() + 1;					Nmonth = ((Nmonth < 10) ? '0' : '') + Nmonth; 					Nyear = dDreel.getYear();					Nyear = ((Nyear < 200) ? 1900 : 0) + Nyear; 					ldDreel =  Nday + '/' + Nmonth + '/' + Nyear;				} else {					ldDreel = "-";				}								dFreel = suivi.fin_reelle;				if (dFreel !== null) {					Nday = dFreel.getDate();					Nday = ((Nday < 10) ? '0' : '') + Nday; 					Nmonth = dFreel.getMonth() + 1;					Nmonth = ((Nmonth < 10) ? '0' : '') + Nmonth; 					Nyear = dFreel.getYear();					Nyear = ((Nyear < 200) ? 1900 : 0) + Nyear; 					ldFreel =  Nday + '/' + Nmonth + '/' + Nyear;				} else {					ldFreel = "-";				}								ava = suivi.avancement;				if (ava === null) {					lava = "-";				} else {					lava = ava + "%";				}												if (vRupt !== vMat) {					vRupt = vMat;					vQuery = "eleve.ID = :1 and chapitre.Programme.Annee_scolaire.ID = :2 and ( (fin_reelle >= :3 and fin_reelle <= :4) or (fin_reelle = null and debut_reel <= :4) or ";					vQuery += "(debut_reel = null and chapitre.Date_Debut <= :4) ) and chapitre.Programme.Matiere.ID = :5";					nblg = ds.Abonne.query(vQuery,eleve.Eleve.ID,vAnScol,dDeb,dFin,suivi.chapitre.Programme.Matiere.ID);					vNbLg = nblg.length;					vCoul = suivi.chapitre.Programme.Matiere.CoulCode;					vEnt = vTableB + '<TD width=50 align=center>' + ldDeb + '</TD><TD width=50 align=center>' + ldFin + '</TD><TD width=50 align=center>' + ldDreel + '</TD><TD width=50 align=center>' + ldFreel + '</TD><TD width=50 align=center>' + lava + '</TD></TR></TABLE><TD></TD></TR>';					vHtml += '<TR><TD></TD><TD COLSPAN=2 bgcolor='+vCoul+' align=center valign=middle rowspan='+vNbLg+'><B>' + vMat + '&nbsp;</B></TD><TD COLSPAN=3>'+ suivi.chapitre.Chapitre +'</TD><TD>' + vEnt + '</TD></TR>';				} else {					vEnt = vTableB + '<TD width=50 align=center>' + ldDeb + '</TD><TD width=50 align=center>' + ldFin + '</TD><TD width=50 align=center>' + ldDreel + '</TD><TD width=50 align=center>' + ldFreel + '</TD><TD width=50 align=center>' + lava + '</TD></TR></TABLE><TD></TD></TR>';					vHtml += '<TR><TD></TD><TD COLSPAN=3>'+ suivi.chapitre.Chapitre +'</TD><TD>' + vEnt + '</TD></TR>';				}			});						vHtml += '<TR><TD COLSPAN=8></TD></TR></TABLE>';			vHtml += '<P class="break">';			vHtml += '<TABLE width=800 border=0><TR><TD height=5 bgcolor=#FFFFFF>&nbsp;</TD></TR></TABLE><P>';					});					}		return vHtml;		}function SuiviPrgm(request, response) {			var vHtml, vToday, exportData, dNais, dtNais, vSect, vCar, vAnScol, AnScol, vLibAn, vMail, Nday, Nmonth, vConv, Chaps, sDeb, sFin, sCur, sCtrl, sTxt,		Nyear, vCoul, vSexe, vAn, prgmms, dDeb, dFin, vFam, vMoi, freres, vNbf, vLien, vNe, vDne, vUser, uParam, vUserName, 		vParaA, vParaM, vParaLm, vNbAbs, vNbCant, vNbThai, vLibAbs, vLibCant, vLibThai, jourms, jOuv, vTable, vCal, Suivis, vRupt, 		vMat, vQuery, vEnt, ldDeb, ldFin, ldDreel, ldFreel, dDreel, dFreel, vTableB, ava, lava, vNbLg, nblg, ImgData, vJour, aJour, vLunSem,		annee, mm, NumSemaine, ListeMois = [31,28,31,30,31,30,31,31,30,31,30,31], TotalJour=0, JourDebutAn, DebutAn, cpt, jj, ImgMil, 		split_date, new_date, new_day, new_month, new_year, new_date_text, ListeD = [0];		vUser = currentUser();    vUserName = vUser.name;	uParam = ds.UserParam.query("Utilisateur.Login = :1", vUserName);	if (uParam[0].Preview) {		response.contentType = 'text/html';	} else {		response.contentType = 'application/vnd.ms-excel';	}		ImgData = "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/4gxYSUNDX1BST0ZJTEUAAQEAAAxITGlubwIQAABtbnRyUkdCIFhZWiAHzgACAAkABgAxAABhY3NwTVNGVAAAAABJRUMgc1";	ImgData += "JHQgAAAAAAAAAAAAAAAAAA9tYAAQAAAADTLUhQICAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABFjcHJ0AAABUAAAADNkZXNjAAABhAAAAGx3dHB0AAAB8AAAABRia3B0AAACBAAAABRyWF";	ImgData += "laAAACGAAAABRnWFlaAAACLAAAABRiWFlaAAACQAAAABRkbW5kAAACVAAAAHBkbWRkAAACxAAAAIh2dWVkAAADTAAAAIZ2aWV3AAAD1AAAACRsdW1pAAAD+AAAABRtZWFzAAAEDAAAACR0ZWNoAAAEMAAAAAxyVFJDAAAEPAAACAxnVFJ";	ImgData += "DAAAEPAAACAxiVFJDAAAEPAAACAx0ZXh0AAAAAENvcHlyaWdodCAoYykgMTk5OCBIZXdsZXR0LVBhY2thcmQgQ29tcGFueQAAZGVzYwAAAAAAAAASc1JHQiBJRUM2MTk2Ni0yLjEAAAAAAAAAAAAAABJzUkdCIElFQzYxOTY2LTIuMQAAAAAAAAAAAAAA";	ImgData += "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWFlaIAAAAAAAAPNRAAEAAAABFsxYWVogAAAAAAAAAAAAAAAAAAAAAFhZWiAAAAAAAABvogAAOPUAAAOQWFlaIAAAAAAAAGKZAAC3hQAAGNpYWVogAAAAAAAAJKAAAA+EAAC2z2Rlc2MAAAAAAAAAF";	ImgData += "klFQyBodHRwOi8vd3d3LmllYy5jaAAAAAAAAAAAAAAAFklFQyBodHRwOi8vd3d3LmllYy5jaAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABkZXNjAAAAAAAAAC5JRUMgNjE5NjYtMi4xIERlZmF1bHQgUkdCIGNvbG91ciBzcGFjZSAt";	ImgData += "IHNSR0IAAAAAAAAAAAAAAC5JRUMgNjE5NjYtMi4xIERlZmF1bHQgUkdCIGNvbG91ciBzcGFjZSAtIHNSR0IAAAAAAAAAAAAAAAAAAAAAAAAAAAAAZGVzYwAAAAAAAAAsUmVmZXJlbmNlIFZpZXdpbmcgQ29uZGl0aW9uIGluIElFQzYxOTY2LTIuMQAAAAAA";	ImgData += "AAAAAAAALFJlZmVyZW5jZSBWaWV3aW5nIENvbmRpdGlvbiBpbiBJRUM2MTk2Ni0yLjEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHZpZXcAAAAAABOk/gAUXy4AEM8UAAPtzAAEEwsAA1yeAAAAAVhZWiAAAAAAAEwJVgBQAAAAVx/nbWVhcwAAAAAAAAAB";	ImgData += "AAAAAAAAAAAAAAAAAAAAAAAAAo8AAAACc2lnIAAAAABDUlQgY3VydgAAAAAAAAQAAAAABQAKAA8AFAAZAB4AIwAoAC0AMgA3ADsAQABFAEoATwBUAFkAXgBjAGgAbQByAHcAfACBAIYAiwCQAJUAmgCfAKQAqQCuALIAtwC8AMEAxgDLANAA1QDbAOAA5Q";	ImgData += "DrAPAA9gD7AQEBBwENARMBGQEfASUBKwEyATgBPgFFAUwBUgFZAWABZwFuAXUBfAGDAYsBkgGaAaEBqQGxAbkBwQHJAdEB2QHhAekB8gH6AgMCDAIUAh0CJgIvAjgCQQJLAlQCXQJnAnECegKEAo4CmAKiAqwCtgLBAssC1QLgAusC9QMAAwsDFgMhAy0DOANDA08";	ImgData += "DWgNmA3IDfgOKA5YDogOuA7oDxwPTA+AD7AP5BAYEEwQgBC0EOwRIBFUEYwRxBH4EjASaBKgEtgTEBNME4QTwBP4FDQUcBSsFOgVJBVgFZwV3BYYFlgWmBbUFxQXVBeUF9gYGBhYGJwY3BkgGWQZqBnsGjAadBq8GwAbRBuMG9QcHBxkHKwc9B08HYQd0B4YHmQes";	ImgData += "B78H0gflB/gICwgfCDIIRghaCG4IggiWCKoIvgjSCOcI+wkQCSUJOglPCWQJeQmPCaQJugnPCeUJ+woRCicKPQpUCmoKgQqYCq4KxQrcCvMLCwsiCzkLUQtpC4ALmAuwC8gL4Qv5DBIMKgxDDFwMdQyODKcMwAzZDPMNDQ0mDUANWg10DY4NqQ3DDd4N+A4TDi4OSQ5";	ImgData += "kDn8Omw62DtIO7g8JDyUPQQ9eD3oPlg+zD88P7BAJECYQQxBhEH4QmxC5ENcQ9RETETERTxFtEYwRqhHJEegSBxImEkUSZBKEEqMSwxLjEwMTIxNDE2MTgxOkE8UT5RQGFCcUSRRqFIsUrRTOFPAVEhU0FVYVeBWbFb0V4BYDFiYWSRZsFo8WshbWFvoXHRdBF2UXiReu";	ImgData += "F9IX9xgbGEAYZRiKGK8Y1Rj6GSAZRRlrGZEZtxndGgQaKhpRGncanhrFGuwbFBs7G2MbihuyG9ocAhwqHFIcexyjHMwc9R0eHUcdcB2ZHcMd7B4WHkAeah6UHr4e6R8THz4faR+UH78f6iAVIEEgbCCYIMQg8CEcIUghdSGhIc4h+yInIlUigiKvIt0jCiM4I2YjlCPCI";	ImgData += "/AkHyRNJHwkqyTaJQklOCVoJZclxyX3JicmVyaHJrcm6CcYJ0kneierJ9woDSg/KHEooijUKQYpOClrKZ0p0CoCKjUqaCqbKs8rAis2K2krnSvRLAUsOSxuLKIs1y0MLUEtdi2rLeEuFi5MLoIuty7uLyQvWi+RL8cv/jA1MGwwpDDbMRIxSjGCMbox8jIqMmMymzLUMw0z";	ImgData += "RjN/M7gz8TQrNGU0njTYNRM1TTWHNcI1/TY3NnI2rjbpNyQ3YDecN9c4FDhQOIw4yDkFOUI5fzm8Ofk6Njp0OrI67zstO2s7qjvoPCc8ZTykPOM9Ij1hPaE94D4gPmA+oD7gPyE/YT+iP+JAI0BkQKZA50EpQWpBrEHuQjBCckK1QvdDOkN9Q8BEA0RHRIpEzkUSRVVFmk";	ImgData += "XeRiJGZ0arRvBHNUd7R8BIBUhLSJFI10kdSWNJqUnwSjdKfUrESwxLU0uaS+JMKkxyTLpNAk1KTZNN3E4lTm5Ot08AT0lPk0/dUCdQcVC7UQZRUFGbUeZSMVJ8UsdTE1NfU6pT9lRCVI9U21UoVXVVwlYPVlxWqVb3V0RXklfgWC9YfVjLWRpZaVm4WgdaVlqmWvVbRVuVW+";	ImgData += "VcNVyGXNZdJ114XcleGl5sXr1fD19hX7NgBWBXYKpg/GFPYaJh9WJJYpxi8GNDY5dj62RAZJRk6WU9ZZJl52Y9ZpJm6Gc9Z5Nn6Wg/aJZo7GlDaZpp8WpIap9q92tPa6dr/2xXbK9tCG1gbbluEm5rbsRvHm94b9FwK3CGcOBxOnGVcfByS3KmcwFzXXO4dBR0cHTMdSh1h";	ImgData += "XXhdj52m3b4d1Z3s3gReG54zHkqeYl553pGeqV7BHtje8J8IXyBfOF9QX2hfgF+Yn7CfyN/hH/lgEeAqIEKgWuBzYIwgpKC9INXg7qEHYSAhOOFR4Wrhg6GcobXhzuHn4gEiGmIzokziZmJ/opkisqLMIuWi/yMY4zKjTGNmI3/jmaOzo82j56QBpBukNaRP5GokhGSepLj";	ImgData += "k02TtpQglIqU9JVflcmWNJaflwqXdZfgmEyYuJkkmZCZ/JpomtWbQpuvnByciZz3nWSd0p5Anq6fHZ+Ln/qgaaDYoUehtqImopajBqN2o+akVqTHpTilqaYapoum/adup+CoUqjEqTepqaocqo+rAqt1q+msXKzQrUStuK4trqGvFq+LsACwdbDqsWCx1rJLssKzOLOutC";	ImgData += "W0nLUTtYq2AbZ5tvC3aLfguFm40blKucK6O7q1uy67p7whvJu9Fb2Pvgq+hL7/v3q/9cBwwOzBZ8Hjwl/C28NYw9TEUcTOxUvFyMZGxsPHQce/yD3IvMk6ybnKOMq3yzbLtsw1zLXNNc21zjbOts83z7jQOdC60TzRvtI/0sHTRNPG1EnUy9VO1dHWVdbY11zX4Nhk2Oj";	ImgData += "ZbNnx2nba+9uA3AXcit0Q3ZbeHN6i3ynfr+A24L3hROHM4lPi2+Nj4+vkc+T85YTmDeaW5x/nqegy6LzpRunQ6lvq5etw6/vshu0R7ZzuKO6070DvzPBY8OXxcvH/8ozzGfOn9DT0wvVQ9d72bfb794r4Gfio+Tj5x/pX+uf7d/wH/Jj9Kf26/kv+3P9t////4QMcRXhpZg";	ImgData += "AATU0AKgAAAAgACAEPAAIAAAAWAAAAbgEQAAIAAAAiAAAAhAESAAMAAAABAAEAAAEaAAUAAAABAAAApgEbAAUAAAABAAAArgEoAAMAAAABAAIAAAEyAAIAAAAUAAAAtodpAAQAAAABAAAAygAAAABFQVNUTUFOIEtPREFLIENPTVBBTlkAS09EQUsgUExBWVNQT1JUIFZpZ";	ImgData += "GVvIENhbWVyYSwgWng1AAAAAEgAAAABAAAASAAAAAEyMDE0OjA3OjI3IDA3OjE1OjI0AAAlgpoABQAAAAEAAAKMgp0ABQAAAAEAAAKUiCIAAwAAAAEAAgAAiCcAAwAAAAEAfQAAkAAABwAAAAQwMjMwkAMAAgAAABQAAAKckAQAAgAAABQAAAKwkQEABwAAAAQBAgMAkQIABQ";	ImgData += "AAAAEAAALEkgEACgAAAAEAAALMkgIABQAAAAEAAALUkgMACgAAAAEAAALckgQACgAAAAEAAALkkgUABQAAAAEAAALskgcAAwAAAAEABQAAkggAAwAAAAEAAAAAkgkAAwAAAAEAIAAAkgoABQAAAAEAAAL0khUABQAAAAEAAAL8oAAABwAAAAQwMTAwoAEAAwAAAAEAAQAAoAI";	ImgData += "ABAAAAAEAAABxoAMABAAAAAEAAABkohUABQAAAAEAAAMEohcAAwAAAAEAAgAAowAABwAAAAEDAAAApAEAAwAAAAEAAAAApAIAAwAAAAEAAAAApAMAAwAAAAEAAAAApAQABQAAAAEAAAMMpAUAAwAAAAEAIQAApAYAAwAAAAEAAAAApAcAAwAAAAEAAQAApAgAAwAAAAEAAAAA";	ImgData += "pAkAAwAAAAEAAAAApAoAAwAAAAEAAAAApAwAAwAAAAEAAAAAAAAAAAAAAAEAAAFAAAAADgAAAAUyMDE0OjA3OjI3IDA3OjE1OjI0ADIwMTQ6MDc6MjcgMDc6MTU6MjQAAAAuVwAAFlsAAAAZAAAAAwAAAAMAAAABAAAABwAAAAEAAAAAAAAAAQAAAAMAAAABAAAAJwAAAAoAAA";	ImgData += "B9AAAAAQAAAH0AAAABAAAAAAAAAAH/4QJ3aHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA1LjEuMiI+CiAgIDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vc";	ImgData += "mcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+CiAgICAgIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICAgICAgICAgIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyI+CiAgICAgICAgIDx4bXA6Q3JlYXRlRGF0ZT4yMDE0LTA3LTI3VDA";	ImgData += "3OjE1OjI0PC94bXA6Q3JlYXRlRGF0ZT4KICAgICAgICAgPHhtcDpNb2RpZnlEYXRlPjIwMTQtMDctMjdUMDc6MTU6MjQ8L3htcDpNb2RpZnlEYXRlPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgI";	ImgData += "CAgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIj4KICAgICAgICAgPHBob3Rvc2hvcDpEYXRlQ3JlYXRlZD4yMDE0LTA3LTI3VDA3OjE1OjI0PC9waG90b3Nob3A6RGF0ZUNyZWF0ZWQ+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogI";	ImgData += "CA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgr/2wBDAAIBAQIBAQICAQICAgICAwUDAwMDAwYEBAMFBwYHBwcGBgYHCAsJBwgKCAYGCQ0JCgsLDAwMBwkNDg0MDgsMDAv/2wBDAQICAgMCAwUDAwULCAYICwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsL";	ImgData += "CwsLCwv/wAARCABkAHEDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc";	ImgData += "3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEK";	ImgData += "RobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD9/KKKKA";	ImgData += "Cisb4h+Ln8B+CdU1mDTNQ1k6ZbtcmysED3Nwq8lYlJAZsZIXPOMCsTwx8bvDnxR+H8Gr/DjxDpRXVbZmsnuXCGOTBAEsLFXUq/DIcMCCODQK62O0zmjNeC+M/j7a/se/DSGw+J3ia88d+M7tWu/wB4qQeaXPXag229uuMKPmY4ONxya+Lvj1+3p4n8fatIPEOtSwWUuWTStPlaCON";	ImgData += "ewIU7pPq5OewFctbFwpPl3fY7MPg6mJ1S0P0yHxF8PnWE04a5o/8AaEj+Wlt9sj85m/uhN2SfbFchqX7Xfw60fxBeaZqnie0gvLCZoJ1aKXajqcMu8LtOCCOD2r8rbLxL4u1aYXHh7SodLjJzHLcyiNvqAAWFTwXvjKOVw+n2UkoHzS/aNsb85BXuTyeoFYrFzl9lfedn9lpbzP11";	ImgData += "8I/FLw54+bb4L13StUcLvKW10kjhfUqDkflW9X4/aZ8R/EHhS8STxDp89ooYAXcD7hHn/poh3D9K+iv2bv2+dW8DCG18U3MniHQy53rNKXurfP8AzzlY8gcfK3B5wRWyxKXxqxz1cvnBXjqfe9Fc/wDDn4paF8V9DGoeA9Rhv4AQsgXh4WwDtdDyrAEcGugrpTvqjgatuFFFFMAo";	ImgData += "oooAKKDyK870C78c+F/iPrUvxW1fwlJ4Luo0GlzQxtZ3VpNnbskEjMsm8HOQ33hwMHATYm7Hn3xp/aHv/hX+0VJp2m+L/DVlajSoby40LxSTp1vdKzOvn2GoqrbWXZiSKRGB4KlcknzvUPjtf+GL5fG3x0+GXwt1Hw3rcTjSdT0KaK9ur6dSWRvNnjRniIVsuE4+UjOa5e9/astL";	ImgData += "b4o3r+PbTSvi9o0d3MLO31HTre01vw7co2xowrr5UkDbSRIhIJ54PB8z/bO/aOl+N2v2F/8A2ZNo6Wtp9gttP+0LKYjuJZgygDJ+ToOAgrgxeL9lTbg9b6GuBofXK3LfRHmXxQ+JGu/G7x7ez3Nzi4upDJNJgtFZRkkrHGvRQoOFUcDr1JrO0nStA0CdraCOGS5if95cSxb3Z/UvV";	ImgData += "3wno0ek6OiSeUJmy8pJO5mPr614x8QvGcOlfFLWtKtLuIRQXAklRdxfDKrso54HJyfSubLMPHFVHGbd7bn0Neo6MeWnsj6BgkiktzLHJG6ICSQOn1zU6OVEZuB5XnExpvQHecE4Bz6An8K8f8E+NLCXTvOtLzThayK1rEba7V54SpD7jEcrtJPfP5V2Pg7Wb3xNKIH1BpoLcvO8wV";	ImgData += "SCC6+XGGK9cB+VxgcV3yy+FJTbexxutOTSsds1mLiJo5tjI3BUxggj+tZF/wDD6MSi78MyLYXa/wBxMRS+zp0/EVpxRqScGLHpuP6VLHGiHjy/oWNebGfQ6lKzOh/Zx+PWqfCLx/b39irx3dqfJvLRuftEJILR5PGGxlW7HH4/pl4O8WWXjvwvYax4clE9lqMKzxP3wex9CDkEdiC";	ImgData += "K/JvxNbNZCK/sFzLbgq+053RnqMfy9K+wP+CbfxNkN5qnhi7nMltdQDU7PcxO1htWRR2wQyNx3BNdeFq8suR7M4MdRTXtIn1tRRRXonlhRRRQAVmeM9H07XvC1/a+LdOi1fTpIG8+zkthci4UAkr5RB3k9hjk1p0UAfB3j3Uf2cvCfg8X3wc8OXmsa/Ddi3TT0vNQ0y4Cyt+8V3df";	ImgData += "lEYzhCMjaAMV83eLJLXUvHtu0AW2gV5HihaYyvCDkhd55YgcbiMnGa/R79qj9kzw78a/COoX9nYRWHiy0ia4stStQIZ3lQFgkrD/AFisRg7s4zkYNfnVqsKJ4qsMgiN4HZc4+/wcn8N1eDmilGcOx6eULllMejQk/JM2T7f/AFq4Xxr8Ivh14v8AiTE/jNIv+Eo1q3IiSLUJrW7voYV";	ImgData += "CvsWJl3gK6hsDptz0r0VQjj/WqB64HNfMf7YXw88b3/xU0rUPBc+v6jp85jTTRDeIv9n3jIwkSHygrwKyxqS7tgliMjIFGAi51LKfL5noVZW6XOE8S+G9A0PX28J/D/SNRk8X6f4kmtYdT+1AJdweYfIjVd2A4BRcsB8yMckHFeoeGPG9/onijUtN+K11ftrunktuidI55ZX2snmiP";	ImgData += "5W4b+DKtkHHUDpPg18BNA+Fvw81DUfGt/qj3fiPTUOpRXrxwS2wVfOaOIKd3mq4LBwxfcoIryL4hQ+F/BPhmd9J1i08Z6n4hMWpabqs9zPHq2mwsqsouVYFGdsEE7lfJ5Qbc179LEKremtV37nLKDWrPpfwh46Mt4dO8Yo9hfKBtEqhC+R0PYH8efrXTwa1YTXghhu4mmALbFIJ";	ImgData += "wOvavleLx3YafdXV7Nc+I/G2m2mireX19ZxNA2m3TcAXBfrEpGM9SeOcGt6z+IqfB/xz4Xi+Kxi0cNpw1i/NrDJLPbu28RwTKATI7DBLYAReOcZrKtgIO8loxwqtaH0sGgZWDvlSORtzn9K9B/Yf8Vjwh8cNBzIvlLqT6buZuNkqlQPblk/KuAjbGMTSPxuDAfeGOPrwa639k/Rv7";	ImgData += "W+PXh22RppIk1tHwWJACsXP6L3rx4StOPe5tWV6cvQ/TIdKKB0or3D58KKKKACvNP2o/GPxH8D/AA8kv/2b/DWleJ9Th3NPb3V0yTrGFJzbwgBZ3zj5Gkj9ixwp9Lo60Ezi5RaTsfl/4l/4Kz/EXxNLaJYX1t4Xu7Jfs95AunIEmmVjlmEwZomH3WjJ4I7civLdU8fXXiFmurxI";	ImgData += "WvUmNysiYQSFmJYYHABDN04r9EP2uP2EfCXxz07UNa0DwV4SvvGtzsVrvUbq609Z0HBMk1odxcL0Zlbpg8cj8qvF+z4TeM7zS/DuvaH4osLaR0eTSnmmtoXV2Voo5ZkRnKFSCwBB9c5rysdgp1kpKVzwZ5hjMmqqVSacX/W3+R7voNjL4igjfT45z5qhscZUehPSr0HhW51GZ008O";	ImgData += "CpAkDELt/MVs/DvSovD/gK0n00zzC8t47shm4JZQflHQf8A1qZomsSvrl0DHtWdgSc8jAxmuWtSo4SVNVm7vex9nh8ZUxFP2iXS55Z8efg7N8Xfh3c6BaTaRb3Ul1BKs2qacL2O32SAs0ahlMc23cEkB+RjkhhwfKv2a/2fNW8B2uoXXxo0Hw9HpF9ZXL3f23y5b/TGicrjOGjMUk";	ImgData += "QaXcrBlwueSQPSPjt8PPix8OfE+qeLPgzrVn430nWrsTTeGNWtkim01jGqn7DOjx7oiY93ludwLsQW6Dx7xbD8YPj4ttoXinwvrehaBqcci6ta2lpFYpH94Rxvd3Uz+bE3yM+xRxlcMa9ONKph17NTXI9fM3jUVZKVtThfgPpjfFTx/oUOhTWmlWN5dWkGpaRZSzxS31nbRmdrqdD";	ImgData += "lWVmRFbcf9ZKMDB57n4o/sa6zc/FWAfDsXeqabfWE+o3N9rt6JYTdpNn7JK6YlVZUcKrBW2hHyQQAfX/gl8Dbr4eS3msfEDVpvEfi7V4YYb+/OEijjiUKkMAAB2AKuWIyxAzgACvQVslznY/A6mTmprZlJVP3T02NVR7lb7DZ+CfDMEGjpLBYadClvbwLISsUagKiBmOcDgZJzgV73";	ImgData += "/wTe+HUmofFf+0b0rIdGt5buYk5/ezZjQfkZD+FeCWOmSeMNZt7fSoZZ4lkURouXM8hIC7R35OAO5PtX6OfstfA1fgf8OI7fUAjazqJFxqDqc7Wx8sQPcIOM9yWPeuTCxdarzPZGeNqezp8l9Wel0UUV7J4gUUUUAFFFFABX5y/8Fa/gj4P0r4taBq3hTSbfT/EGt281zqksDhYrs";	ImgData += "o8ao8sA48w5YGTgsBg5wCP0ar8yv8Agrd4qsvDv7QWoXmnXAmu4NItYJo3UoIZf3hRdx4I2urEjgc571y4xyVJqG70POzVQeHfOrnmn7PPxE0Wy8a3PhSXUmjuJYN1nay3BMEZUktHGHOFbBztHUA+ldl+0F4ll+Dvw4n8QaabVbmC6tlhiuVJjvd0gDRfLzym87h93GeQMH3b/";	ImgData += "gnH/wAE3j8PPAt7rP7TsHhTxTN4kEd3Z6TJZW2p29ipwwmN1JEWeVwR8qN5SjpuJLVj/tbf8EYLH4g6pqWt/s262PDzyW7SweG7x5DpIusrxbsCfscbLvyqoyq2CoALA0sFRnGKrLmkuplhni6eEslZvp1R8XfEz9s/UPGculR+C7FdDhtyzXSXLi5W4c4AGQF2oOefvHPbHPS+B";	ImgData += "/jvo/izUBY30htbxY/9a7NHBcMB83lluV9g3Jqbwr/wSW+MV18RItB8d+GLjR7a8trgW2t211b32mwXKxl4Rc7HEqwuVMZdY9ys6HaRmvMvEH7KvxQ+F2heJNa8aeE9c0KHwZdWsV7PdwSIiPNMY43gmA8udA6ruZGICujHg8XiMLHELXc5cPmGY4GfPJNx6prtv6ep7o";	ImgData += "PEUd0CNEjub6QDjys7M+7sAB+tavg34feIPiLrMOlWVvNd3tzhktbQFiwxzu9gepJC9ya+n/2Q/wBlLwp8cPgb4T8c+INQ1K6/4SPTor6S0gZYIoZCP3kZYAuSrhlPI5B6V9N+A/hX4d+GVm0PgTR7HTVcYkeKP95L/vucs34k15NLLarf7x2X4n20szg4p01ueTfso/scW3wdij1";	ImgData += "jx1Ha3Wv/AHoI0O+PT+MHB6PJyRuxgDhe5PvNFFexTpxpR5Y7HmVKkqsuaT1CiiirICiiigAooooA8T/b9/aL1f8AZf8A2epvE/gZdOOof2nZ2KtewtLDGssoViVV1JJGVHPBYHnpXyV+0Hqvw+/aq8ceGvjj4httYf4V6LdDSPEtg0KC9vtVjnghsbXyQxDQTG8+d94AWDa3Dn";	ImgData += "Gl+2J+yz+1R+0hf/EH4cXyeF9X+HXi3x3peu6D4jn8RJbXHhXSrae1mktPsaWe6Ukwz4BdyS+PMAYeVg+Mf+Cafx2u9K8WfBjwvbeAB8IvFPxO0/x7D4wm1+4XWNLtbe+s757L+yxa7ZZC9mY1f7QqhXyf7o6Y0oOKcrX33W2n49jKtRhXjyz23+4+sn/4KKfDfSvGd1os48QW+";	ImgData += "labra+GJdf/ALJkGhw6juCC1N0PlUhiq5ICgnGeKzNe/wCCnXgDQ/HRsfsPii78Mxa2nhqfxbbaf5uiRak0qxC388NlvnbBdVKgjuOa+evFf/BMz4qat+wN8VvhnbvoE/iDxR8X5vGmkvJrTiKTS5Nbhvdss32fMcnkLInlbGAICbyPmr4//aE+NEPwE+B3iz9mjwl8UPhD4j8O";	ImgData += "aZ8Rre402JddmtfiCk41mK7GnHQ5bUbgkybftKy/NFgovzqQ406cnZPrb5d/+AbWR+k/wt/4KQWkNpqmmfFmyuNV8Wr431PwvpWleHLEz3d7FbNu80wtJwEQ7WcsASOAOg9I8Qat4L/b4/ZS8W6bp82uyaDrtre6JqUFsHsdVspo8pLBtYbop1ZQACD1B5Br4d8X/wDBID4n3vxG174";	ImgData += "iafpXgPxJri+PdX1SDwzrXiO9ttO1/RbtFaEyXVtb+ZY3cM7SMFVJUKgAkk/L9r/sF/s33/7OHwNn07xnoHw98L+I9e1KfV9UtPBdtcJYRSyBUQNPdM0t5OsUcSPdOE8wpny0GFE1FBLmi9RNJqzPkT/gnf8AGHxL4S+HOgeEvgr8TfCWrato1+0mpfDnxGsdhr8UUlwzSLHK+0iRt";	ImgData += "zuEKbVPy5GCK+u/i5+27YfBjxvFYeMfBXjqHQv7WtdFl8RSWcUOnLc3DokQj8yVZJ0LSKpeNGUENycV8z/tD/sA/Hz9pTwwvw++MY+DPiq0gvFl0/4tzCXTvGOlRJcB45I7C3tPJ+1rEoTzY7iKNmy3lqPlpnxi/wCCTfxA+M/7Q/iHUfFeseDr/RNX8baV4osvFupXd9e+JtC02z";	ImgData += "ls5ZdFsLdx5FrHMbN1eSKRVZbh98bGrlyTknJ/1/XzCMVFWR7f8Rv+ConhT4dz67PN4S8b6hoeha5N4cfWba1gFjPfxcSQI7yg7gwZRkDJXjORmvff8FRdC8N2OrJ8QvBPi/w1rWhanpNjf6VqJto7iCLUZWit7jIkKldy8rndyMAk4ryLWf8Agl/8SvGP7Eni/wCHN7rXh7S9e1T";	ImgData += "4z3HxC0+6/tG4uYjpza4NQEMriFWWRod0WwBlXIG5hknov2uv+CW3iX9pP9o74n+LdG8TaNpen+NvCfhqz0wTxSyyafrGiatJqFvJNEpUSW8nmBW2uG4Iwc0oxovd/wBafpf7hqx6d+1B+2jB8NPiW3hXSrvUdEvPDt9oF3qV4LS3u7e7tNSuprVYSjuHUb4vmdcMOCu7DCvpAV8Ff";	ImgData += "G7/AIJn/Ff9ovUvH3i74l+J/BFp408Wf8Ina2VnphvE0uxt9E1KW+Ls7gyNLK9w4wFxhVBJHT70TIQeZjdjnHTNZVFFJcr1/wCAv+CGgtFFFZCCiiigAooooAKx5Ph5oE3iMaxNomkPq4YML1rKM3IIGAfN27s4460UUAbFFFFABRRRQAUUUUAFFFFABRRRQB//2Q==";		vToday = new Date();	vParaA = uParam[0].Annee_Scolaire;	vParaM = uParam[0].Mois;	vParaLm = uParam[0].LibMois;	AnScol = ds.Annees_Scolaires.query("ID = :1", vParaA);	vAnScol = AnScol[0].ID;	vLibAn = AnScol[0].Annee_Scolaire;	dDeb = AnScol[0].Date_Debut;	Nday = dDeb.getDate();	Nday = ((Nday < 10) ? '0' : '') + Nday; 	Nmonth = dDeb.getMonth() + 1;	Nmonth = ((Nmonth < 10) ? '0' : '') + Nmonth; 	Nyear = dDeb.getYear();	Nyear = ((Nyear < 200) ? 1900 : 0) + Nyear; 	vConv = Nday + '/' + Nmonth + '/' + Nyear;	vJour = dDeb.getDay();			if (vJour === 0) {		aJour = 1;	} else {		aJour = 8 - vJour;	}				split_date = vConv.split('/');	new_date = new Date(split_date[2], split_date[1]*1 - 1, split_date[0]*1 + aJour);	new_day = new_date.getDate();	new_day = ((new_day < 10) ? '0' : '') + new_day; // ajoute un zéro devant pour la forme	new_month = new_date.getMonth() + 1;	new_month = ((new_month < 10) ? '0' : '') + new_month; // ajoute un zéro devant pour la forme	new_year = new_date.getYear();	new_year = ((new_year < 200) ? 1900 : 0) + new_year; 	new_date_text = new_day + '/' + new_month + '/' + new_year;	vLunSem = new_date_text;			if (vAnScol !== null) {		vHtml = '<head> <meta charset="UTF-8"> </head> ';		vHtml += '<style> .break { page-break-after: always; } </style>';		prgmms = ds.Programme.query("Annee_scolaire.ID = :1", vAnScol);		prgmms.forEach(function (prgmm) {						vHtml += '<TABLE cellpadding="2px" cellspacing="2px" width=800 rules="all" style="border:solid 2px black; font-family:Calibri; font-size:12px; vertical-align: middle;">';			vHtml += '<TR><TD width=10% align=center"><IMG src="'+ImgData+'"></TD><TD width=20%>Ecole Française de Koh Samui<BR>143/1 Moo 4, Maret Lamai<BR>Koh Samui, 84310 Surathani<BR>Téléphone : 08 24 14 24 29</TD>';			vHtml += "<TD width=70% align=center><FONT SIZE=4><B>&nbsp;Programme de "+prgmm.Matiere.Nom+"&nbsp;<BR>&nbsp;Année Scolaire "+vLibAn+"<BR><FONT SIZE=3>"+prgmm.Classe+"&nbsp;"+prgmm.Filiere+"</B></TD></TR></TABLE><TABLE border=0><TR><TD height=15>&nbsp;</TD></TR></TABLE>";						vNbCant = 0;			vNbAbs = 0;			vNbThai = 0;			vHtml += '<TABLE border=1 width=1200 style="font-family:Calibri; font-size:10px; vertical-align: middle;"><TR><TD width=300><B>Chapitre</B></TD>';									for (var i = 0; i < 46; i++) {								split_date = vLunSem.split('/');				new_date = new Date(split_date[2], split_date[1]*1 - 1, split_date[0]*1 + i*7);				new_day = new_date.getDate();				new_day = ((new_day < 10) ? '0' : '') + new_day; // ajoute un zéro devant pour la forme				new_month = new_date.getMonth() + 1;				new_month = ((new_month < 10) ? '0' : '') + new_month; // ajoute un zéro devant pour la forme				new_year = new_date.getYear();				new_year = ((new_year < 200) ? 1900 : 0) + new_year; 				new_date_text = new_day + '/' + new_month + '/' + new_year;								annee = parseInt(new_date_text.substr(6,4),10);				mm = parseInt(new_date_text.substr(3,2),10)-1;				NumSemaine = 0;				TotalJour=0;				jj = parseInt(new_date_text.substr(0,2),10);							if (annee %4 === 0 && (annee %100 !== 0 || annee %400 === 0)) {ListeMois[1]=29;}				for (cpt=0; cpt<mm; cpt++){TotalJour+=ListeMois[cpt];}				TotalJour+=jj;				DebutAn = new Date(annee,0,1);				JourDebutAn=DebutAn.getDay();				if(JourDebutAn===0){JourDebutAn=7;}				TotalJour-=8-JourDebutAn;				NumSemaine = 1;				NumSemaine+=Math.floor(TotalJour/7);				if(TotalJour%7!==0){NumSemaine+=1;}								vHtml += "<TD width=20 align=center>S"+NumSemaine+"<BR>" + new_day + "<BR>" + new_month +"</TD>";				ListeD[i]=parseInt(new_year+new_month+new_day,10);			};			ListeD[47]=ListeD[46]+7;						vHtml += "</TR>";							Chaps = ds.Chapitre.query("Programme.ID = :1 order by Ordre",prgmm.ID);			vRupt = "";						Chaps.forEach(function (chap) {				vHtml += "<TR><TD>"+chap.Chapitre+"</TD>";				sDeb = chap.sDeb;				sFin = chap.sFin-6;								if (chap.Date_Ctrl === null) {					sCtrl = 0;				} else {					new_date = chap.Date_Ctrl;					new_day = new_date.getDate();					new_day = ((new_day < 10) ? '0' : '') + new_day;					new_month = new_date.getMonth() + 1;					new_month = ((new_month < 10) ? '0' : '') + new_month;					new_year = new_date.getYear();					new_year = ((new_year < 200) ? 1900 : 0) + new_year; 					sCtrl = parseInt(new_year+new_month+new_day,10);				}								for (var i = 0; i < 46; i++) {					sCur = i*7;					if (sCtrl >= ListeD[i] && sCtrl < ListeD[i+1]) {						sTxt = "<FONT COLOR=red><B>"+new_day;					} else {						sTxt = "&nbsp;";					}					if (sCur >= sDeb && sCur <= sFin) {						vHtml += "<TD align=center bgcolor=#FFBF00>" + sTxt + "</TD>";					} else {						vHtml += "<TD align=center bgcolor=#FFFFFF>" + sTxt + "</TD>";					}									};								vHtml += "</TR>";											});						vHtml += '</TABLE>';			vHtml += '<P class="break">';			vHtml += '<TABLE width=800 border=0><TR><TD height=5 bgcolor=#FFFFFF>&nbsp;</TD></TR></TABLE><P>';					});					}		return vHtml;		}function FactMens(request, response) {			var vHtml, vToday, exportData, dNais, dtNais, vSect, vCar, vAnScol, AnScol, vLibAn, vMail, Nday, Nmonth, Nyear, vCoul, FactPar, vIndFact, vlToday, vlTrim,		vSexe, vAn, eleves, dDeb, dFin, vFam, vMoi, freres, vNbf, vLien, vNe, vDne, vUser, uParam, vUserName, vParaA, vParaM, vParaLm, ImgData, vLibFam, vTotal,		ListeMois = ["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"], vNbEnf, vReduc, vlReduc, vMontant, vRupt,		vNbCant, vNbAbs, vNbThai, vLibAbs, vLibCant, vLibThai, vtmpHtml, vHtml, Mtraite, Mpres, factflag, factline, factmaster, facthst, factprm ;		vUser = currentUser();    vUserName = vUser.name;	uParam = ds.UserParam.query("Utilisateur.Login = :1", vUserName);	if (uParam[0].Preview) {		response.contentType = 'text/html';	} else {		response.contentType = 'application/vnd.ms-excel';	}		vToday = new Date();		Nday = vToday.getDate();	Nday = ((Nday < 10) ? '0' : '') + Nday;	Nmonth = vToday.getMonth() + 1;	Nmonth = ((Nmonth < 10) ? '0' : '') + Nmonth; 	Nyear = vToday.getYear();	Nyear = ((Nyear < 200) ? 1900 : 0) + Nyear; 	vlToday = Nday + '/' + Nmonth + '/' + Nyear;		vParaA = uParam[0].Annee_Scolaire;	vParaM = uParam[0].Mois;	vParaLm = uParam[0].LibMois;	Mtraite = ds.Calendrier.query("lMois = :1", vParaLm);	Mpres = Mtraite[0].dFin;	FactPar = ds.FactParam.query("ID > 0");	factprm = FactPar.first();	vIndFact = factprm.IndFact;	AnScol = ds.Annees_Scolaires.query("ID = :1", vParaA);	vAnScol = AnScol[0].ID;	vLibAn = AnScol[0].Annee_Scolaire;		ImgData = "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/4gxYSUNDX1BST0ZJTEUAAQEAAAxITGlubwIQAABtbnRyUkdCIFhZWiAHzgACAAkABgAxAABhY3NwTVNGVAAAAABJRUMgc1";	ImgData += "JHQgAAAAAAAAAAAAAAAAAA9tYAAQAAAADTLUhQICAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABFjcHJ0AAABUAAAADNkZXNjAAABhAAAAGx3dHB0AAAB8AAAABRia3B0AAACBAAAABRyWF";	ImgData += "laAAACGAAAABRnWFlaAAACLAAAABRiWFlaAAACQAAAABRkbW5kAAACVAAAAHBkbWRkAAACxAAAAIh2dWVkAAADTAAAAIZ2aWV3AAAD1AAAACRsdW1pAAAD+AAAABRtZWFzAAAEDAAAACR0ZWNoAAAEMAAAAAxyVFJDAAAEPAAACAxnVFJ";	ImgData += "DAAAEPAAACAxiVFJDAAAEPAAACAx0ZXh0AAAAAENvcHlyaWdodCAoYykgMTk5OCBIZXdsZXR0LVBhY2thcmQgQ29tcGFueQAAZGVzYwAAAAAAAAASc1JHQiBJRUM2MTk2Ni0yLjEAAAAAAAAAAAAAABJzUkdCIElFQzYxOTY2LTIuMQAAAAAAAAAAAAAA";	ImgData += "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWFlaIAAAAAAAAPNRAAEAAAABFsxYWVogAAAAAAAAAAAAAAAAAAAAAFhZWiAAAAAAAABvogAAOPUAAAOQWFlaIAAAAAAAAGKZAAC3hQAAGNpYWVogAAAAAAAAJKAAAA+EAAC2z2Rlc2MAAAAAAAAAF";	ImgData += "klFQyBodHRwOi8vd3d3LmllYy5jaAAAAAAAAAAAAAAAFklFQyBodHRwOi8vd3d3LmllYy5jaAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABkZXNjAAAAAAAAAC5JRUMgNjE5NjYtMi4xIERlZmF1bHQgUkdCIGNvbG91ciBzcGFjZSAt";	ImgData += "IHNSR0IAAAAAAAAAAAAAAC5JRUMgNjE5NjYtMi4xIERlZmF1bHQgUkdCIGNvbG91ciBzcGFjZSAtIHNSR0IAAAAAAAAAAAAAAAAAAAAAAAAAAAAAZGVzYwAAAAAAAAAsUmVmZXJlbmNlIFZpZXdpbmcgQ29uZGl0aW9uIGluIElFQzYxOTY2LTIuMQAAAAAA";	ImgData += "AAAAAAAALFJlZmVyZW5jZSBWaWV3aW5nIENvbmRpdGlvbiBpbiBJRUM2MTk2Ni0yLjEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHZpZXcAAAAAABOk/gAUXy4AEM8UAAPtzAAEEwsAA1yeAAAAAVhZWiAAAAAAAEwJVgBQAAAAVx/nbWVhcwAAAAAAAAAB";	ImgData += "AAAAAAAAAAAAAAAAAAAAAAAAAo8AAAACc2lnIAAAAABDUlQgY3VydgAAAAAAAAQAAAAABQAKAA8AFAAZAB4AIwAoAC0AMgA3ADsAQABFAEoATwBUAFkAXgBjAGgAbQByAHcAfACBAIYAiwCQAJUAmgCfAKQAqQCuALIAtwC8AMEAxgDLANAA1QDbAOAA5Q";	ImgData += "DrAPAA9gD7AQEBBwENARMBGQEfASUBKwEyATgBPgFFAUwBUgFZAWABZwFuAXUBfAGDAYsBkgGaAaEBqQGxAbkBwQHJAdEB2QHhAekB8gH6AgMCDAIUAh0CJgIvAjgCQQJLAlQCXQJnAnECegKEAo4CmAKiAqwCtgLBAssC1QLgAusC9QMAAwsDFgMhAy0DOANDA08";	ImgData += "DWgNmA3IDfgOKA5YDogOuA7oDxwPTA+AD7AP5BAYEEwQgBC0EOwRIBFUEYwRxBH4EjASaBKgEtgTEBNME4QTwBP4FDQUcBSsFOgVJBVgFZwV3BYYFlgWmBbUFxQXVBeUF9gYGBhYGJwY3BkgGWQZqBnsGjAadBq8GwAbRBuMG9QcHBxkHKwc9B08HYQd0B4YHmQes";	ImgData += "B78H0gflB/gICwgfCDIIRghaCG4IggiWCKoIvgjSCOcI+wkQCSUJOglPCWQJeQmPCaQJugnPCeUJ+woRCicKPQpUCmoKgQqYCq4KxQrcCvMLCwsiCzkLUQtpC4ALmAuwC8gL4Qv5DBIMKgxDDFwMdQyODKcMwAzZDPMNDQ0mDUANWg10DY4NqQ3DDd4N+A4TDi4OSQ5";	ImgData += "kDn8Omw62DtIO7g8JDyUPQQ9eD3oPlg+zD88P7BAJECYQQxBhEH4QmxC5ENcQ9RETETERTxFtEYwRqhHJEegSBxImEkUSZBKEEqMSwxLjEwMTIxNDE2MTgxOkE8UT5RQGFCcUSRRqFIsUrRTOFPAVEhU0FVYVeBWbFb0V4BYDFiYWSRZsFo8WshbWFvoXHRdBF2UXiReu";	ImgData += "F9IX9xgbGEAYZRiKGK8Y1Rj6GSAZRRlrGZEZtxndGgQaKhpRGncanhrFGuwbFBs7G2MbihuyG9ocAhwqHFIcexyjHMwc9R0eHUcdcB2ZHcMd7B4WHkAeah6UHr4e6R8THz4faR+UH78f6iAVIEEgbCCYIMQg8CEcIUghdSGhIc4h+yInIlUigiKvIt0jCiM4I2YjlCPCI";	ImgData += "/AkHyRNJHwkqyTaJQklOCVoJZclxyX3JicmVyaHJrcm6CcYJ0kneierJ9woDSg/KHEooijUKQYpOClrKZ0p0CoCKjUqaCqbKs8rAis2K2krnSvRLAUsOSxuLKIs1y0MLUEtdi2rLeEuFi5MLoIuty7uLyQvWi+RL8cv/jA1MGwwpDDbMRIxSjGCMbox8jIqMmMymzLUMw0z";	ImgData += "RjN/M7gz8TQrNGU0njTYNRM1TTWHNcI1/TY3NnI2rjbpNyQ3YDecN9c4FDhQOIw4yDkFOUI5fzm8Ofk6Njp0OrI67zstO2s7qjvoPCc8ZTykPOM9Ij1hPaE94D4gPmA+oD7gPyE/YT+iP+JAI0BkQKZA50EpQWpBrEHuQjBCckK1QvdDOkN9Q8BEA0RHRIpEzkUSRVVFmk";	ImgData += "XeRiJGZ0arRvBHNUd7R8BIBUhLSJFI10kdSWNJqUnwSjdKfUrESwxLU0uaS+JMKkxyTLpNAk1KTZNN3E4lTm5Ot08AT0lPk0/dUCdQcVC7UQZRUFGbUeZSMVJ8UsdTE1NfU6pT9lRCVI9U21UoVXVVwlYPVlxWqVb3V0RXklfgWC9YfVjLWRpZaVm4WgdaVlqmWvVbRVuVW+";	ImgData += "VcNVyGXNZdJ114XcleGl5sXr1fD19hX7NgBWBXYKpg/GFPYaJh9WJJYpxi8GNDY5dj62RAZJRk6WU9ZZJl52Y9ZpJm6Gc9Z5Nn6Wg/aJZo7GlDaZpp8WpIap9q92tPa6dr/2xXbK9tCG1gbbluEm5rbsRvHm94b9FwK3CGcOBxOnGVcfByS3KmcwFzXXO4dBR0cHTMdSh1h";	ImgData += "XXhdj52m3b4d1Z3s3gReG54zHkqeYl553pGeqV7BHtje8J8IXyBfOF9QX2hfgF+Yn7CfyN/hH/lgEeAqIEKgWuBzYIwgpKC9INXg7qEHYSAhOOFR4Wrhg6GcobXhzuHn4gEiGmIzokziZmJ/opkisqLMIuWi/yMY4zKjTGNmI3/jmaOzo82j56QBpBukNaRP5GokhGSepLj";	ImgData += "k02TtpQglIqU9JVflcmWNJaflwqXdZfgmEyYuJkkmZCZ/JpomtWbQpuvnByciZz3nWSd0p5Anq6fHZ+Ln/qgaaDYoUehtqImopajBqN2o+akVqTHpTilqaYapoum/adup+CoUqjEqTepqaocqo+rAqt1q+msXKzQrUStuK4trqGvFq+LsACwdbDqsWCx1rJLssKzOLOutC";	ImgData += "W0nLUTtYq2AbZ5tvC3aLfguFm40blKucK6O7q1uy67p7whvJu9Fb2Pvgq+hL7/v3q/9cBwwOzBZ8Hjwl/C28NYw9TEUcTOxUvFyMZGxsPHQce/yD3IvMk6ybnKOMq3yzbLtsw1zLXNNc21zjbOts83z7jQOdC60TzRvtI/0sHTRNPG1EnUy9VO1dHWVdbY11zX4Nhk2Oj";	ImgData += "ZbNnx2nba+9uA3AXcit0Q3ZbeHN6i3ynfr+A24L3hROHM4lPi2+Nj4+vkc+T85YTmDeaW5x/nqegy6LzpRunQ6lvq5etw6/vshu0R7ZzuKO6070DvzPBY8OXxcvH/8ozzGfOn9DT0wvVQ9d72bfb794r4Gfio+Tj5x/pX+uf7d/wH/Jj9Kf26/kv+3P9t////4QMcRXhpZg";	ImgData += "AATU0AKgAAAAgACAEPAAIAAAAWAAAAbgEQAAIAAAAiAAAAhAESAAMAAAABAAEAAAEaAAUAAAABAAAApgEbAAUAAAABAAAArgEoAAMAAAABAAIAAAEyAAIAAAAUAAAAtodpAAQAAAABAAAAygAAAABFQVNUTUFOIEtPREFLIENPTVBBTlkAS09EQUsgUExBWVNQT1JUIFZpZ";	ImgData += "GVvIENhbWVyYSwgWng1AAAAAEgAAAABAAAASAAAAAEyMDE0OjA3OjI3IDA3OjE1OjI0AAAlgpoABQAAAAEAAAKMgp0ABQAAAAEAAAKUiCIAAwAAAAEAAgAAiCcAAwAAAAEAfQAAkAAABwAAAAQwMjMwkAMAAgAAABQAAAKckAQAAgAAABQAAAKwkQEABwAAAAQBAgMAkQIABQ";	ImgData += "AAAAEAAALEkgEACgAAAAEAAALMkgIABQAAAAEAAALUkgMACgAAAAEAAALckgQACgAAAAEAAALkkgUABQAAAAEAAALskgcAAwAAAAEABQAAkggAAwAAAAEAAAAAkgkAAwAAAAEAIAAAkgoABQAAAAEAAAL0khUABQAAAAEAAAL8oAAABwAAAAQwMTAwoAEAAwAAAAEAAQAAoAI";	ImgData += "ABAAAAAEAAABxoAMABAAAAAEAAABkohUABQAAAAEAAAMEohcAAwAAAAEAAgAAowAABwAAAAEDAAAApAEAAwAAAAEAAAAApAIAAwAAAAEAAAAApAMAAwAAAAEAAAAApAQABQAAAAEAAAMMpAUAAwAAAAEAIQAApAYAAwAAAAEAAAAApAcAAwAAAAEAAQAApAgAAwAAAAEAAAAA";	ImgData += "pAkAAwAAAAEAAAAApAoAAwAAAAEAAAAApAwAAwAAAAEAAAAAAAAAAAAAAAEAAAFAAAAADgAAAAUyMDE0OjA3OjI3IDA3OjE1OjI0ADIwMTQ6MDc6MjcgMDc6MTU6MjQAAAAuVwAAFlsAAAAZAAAAAwAAAAMAAAABAAAABwAAAAEAAAAAAAAAAQAAAAMAAAABAAAAJwAAAAoAAA";	ImgData += "B9AAAAAQAAAH0AAAABAAAAAAAAAAH/4QJ3aHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA1LjEuMiI+CiAgIDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vc";	ImgData += "mcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+CiAgICAgIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICAgICAgICAgIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyI+CiAgICAgICAgIDx4bXA6Q3JlYXRlRGF0ZT4yMDE0LTA3LTI3VDA";	ImgData += "3OjE1OjI0PC94bXA6Q3JlYXRlRGF0ZT4KICAgICAgICAgPHhtcDpNb2RpZnlEYXRlPjIwMTQtMDctMjdUMDc6MTU6MjQ8L3htcDpNb2RpZnlEYXRlPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgI";	ImgData += "CAgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIj4KICAgICAgICAgPHBob3Rvc2hvcDpEYXRlQ3JlYXRlZD4yMDE0LTA3LTI3VDA3OjE1OjI0PC9waG90b3Nob3A6RGF0ZUNyZWF0ZWQ+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogI";	ImgData += "CA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgr/2wBDAAIBAQIBAQICAQICAgICAwUDAwMDAwYEBAMFBwYHBwcGBgYHCAsJBwgKCAYGCQ0JCgsLDAwMBwkNDg0MDgsMDAv/2wBDAQICAgMCAwUDAwULCAYICwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsL";	ImgData += "CwsLCwv/wAARCABkAHEDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc";	ImgData += "3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEK";	ImgData += "RobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD9/KKKKA";	ImgData += "Cisb4h+Ln8B+CdU1mDTNQ1k6ZbtcmysED3Nwq8lYlJAZsZIXPOMCsTwx8bvDnxR+H8Gr/DjxDpRXVbZmsnuXCGOTBAEsLFXUq/DIcMCCODQK62O0zmjNeC+M/j7a/se/DSGw+J3ia88d+M7tWu/wB4qQeaXPXag229uuMKPmY4ONxya+Lvj1+3p4n8fatIPEOtSwWUuWTStPlaCON";	ImgData += "ewIU7pPq5OewFctbFwpPl3fY7MPg6mJ1S0P0yHxF8PnWE04a5o/8AaEj+Wlt9sj85m/uhN2SfbFchqX7Xfw60fxBeaZqnie0gvLCZoJ1aKXajqcMu8LtOCCOD2r8rbLxL4u1aYXHh7SodLjJzHLcyiNvqAAWFTwXvjKOVw+n2UkoHzS/aNsb85BXuTyeoFYrFzl9lfedn9lpbzP11";	ImgData += "8I/FLw54+bb4L13StUcLvKW10kjhfUqDkflW9X4/aZ8R/EHhS8STxDp89ooYAXcD7hHn/poh3D9K+iv2bv2+dW8DCG18U3MniHQy53rNKXurfP8AzzlY8gcfK3B5wRWyxKXxqxz1cvnBXjqfe9Fc/wDDn4paF8V9DGoeA9Rhv4AQsgXh4WwDtdDyrAEcGugrpTvqjgatuFFFFMAo";	ImgData += "oooAKKDyK870C78c+F/iPrUvxW1fwlJ4Luo0GlzQxtZ3VpNnbskEjMsm8HOQ33hwMHATYm7Hn3xp/aHv/hX+0VJp2m+L/DVlajSoby40LxSTp1vdKzOvn2GoqrbWXZiSKRGB4KlcknzvUPjtf+GL5fG3x0+GXwt1Hw3rcTjSdT0KaK9ur6dSWRvNnjRniIVsuE4+UjOa5e9/astL";	ImgData += "b4o3r+PbTSvi9o0d3MLO31HTre01vw7co2xowrr5UkDbSRIhIJ54PB8z/bO/aOl+N2v2F/8A2ZNo6Wtp9gttP+0LKYjuJZgygDJ+ToOAgrgxeL9lTbg9b6GuBofXK3LfRHmXxQ+JGu/G7x7ez3Nzi4upDJNJgtFZRkkrHGvRQoOFUcDr1JrO0nStA0CdraCOGS5if95cSxb3Z/UvV";	ImgData += "3wno0ek6OiSeUJmy8pJO5mPr614x8QvGcOlfFLWtKtLuIRQXAklRdxfDKrso54HJyfSubLMPHFVHGbd7bn0Neo6MeWnsj6BgkiktzLHJG6ICSQOn1zU6OVEZuB5XnExpvQHecE4Bz6An8K8f8E+NLCXTvOtLzThayK1rEba7V54SpD7jEcrtJPfP5V2Pg7Wb3xNKIH1BpoLcvO8wV";	ImgData += "SCC6+XGGK9cB+VxgcV3yy+FJTbexxutOTSsds1mLiJo5tjI3BUxggj+tZF/wDD6MSi78MyLYXa/wBxMRS+zp0/EVpxRqScGLHpuP6VLHGiHjy/oWNebGfQ6lKzOh/Zx+PWqfCLx/b39irx3dqfJvLRuftEJILR5PGGxlW7HH4/pl4O8WWXjvwvYax4clE9lqMKzxP3wex9CDkEdiC";	ImgData += "K/JvxNbNZCK/sFzLbgq+053RnqMfy9K+wP+CbfxNkN5qnhi7nMltdQDU7PcxO1htWRR2wQyNx3BNdeFq8suR7M4MdRTXtIn1tRRRXonlhRRRQAVmeM9H07XvC1/a+LdOi1fTpIG8+zkthci4UAkr5RB3k9hjk1p0UAfB3j3Uf2cvCfg8X3wc8OXmsa/Ddi3TT0vNQ0y4Cyt+8V3df";	ImgData += "lEYzhCMjaAMV83eLJLXUvHtu0AW2gV5HihaYyvCDkhd55YgcbiMnGa/R79qj9kzw78a/COoX9nYRWHiy0ia4stStQIZ3lQFgkrD/AFisRg7s4zkYNfnVqsKJ4qsMgiN4HZc4+/wcn8N1eDmilGcOx6eULllMejQk/JM2T7f/AFq4Xxr8Ivh14v8AiTE/jNIv+Eo1q3IiSLUJrW7voYV";	ImgData += "CvsWJl3gK6hsDptz0r0VQjj/WqB64HNfMf7YXw88b3/xU0rUPBc+v6jp85jTTRDeIv9n3jIwkSHygrwKyxqS7tgliMjIFGAi51LKfL5noVZW6XOE8S+G9A0PX28J/D/SNRk8X6f4kmtYdT+1AJdweYfIjVd2A4BRcsB8yMckHFeoeGPG9/onijUtN+K11ftrunktuidI55ZX2snmiP";	ImgData += "5W4b+DKtkHHUDpPg18BNA+Fvw81DUfGt/qj3fiPTUOpRXrxwS2wVfOaOIKd3mq4LBwxfcoIryL4hQ+F/BPhmd9J1i08Z6n4hMWpabqs9zPHq2mwsqsouVYFGdsEE7lfJ5Qbc179LEKremtV37nLKDWrPpfwh46Mt4dO8Yo9hfKBtEqhC+R0PYH8efrXTwa1YTXghhu4mmALbFIJ";	ImgData += "wOvavleLx3YafdXV7Nc+I/G2m2mireX19ZxNA2m3TcAXBfrEpGM9SeOcGt6z+IqfB/xz4Xi+Kxi0cNpw1i/NrDJLPbu28RwTKATI7DBLYAReOcZrKtgIO8loxwqtaH0sGgZWDvlSORtzn9K9B/Yf8Vjwh8cNBzIvlLqT6buZuNkqlQPblk/KuAjbGMTSPxuDAfeGOPrwa639k/Rv7";	ImgData += "W+PXh22RppIk1tHwWJACsXP6L3rx4StOPe5tWV6cvQ/TIdKKB0or3D58KKKKACvNP2o/GPxH8D/AA8kv/2b/DWleJ9Th3NPb3V0yTrGFJzbwgBZ3zj5Gkj9ixwp9Lo60Ezi5RaTsfl/4l/4Kz/EXxNLaJYX1t4Xu7Jfs95AunIEmmVjlmEwZomH3WjJ4I7civLdU8fXXiFmurxI";	ImgData += "WvUmNysiYQSFmJYYHABDN04r9EP2uP2EfCXxz07UNa0DwV4SvvGtzsVrvUbq609Z0HBMk1odxcL0Zlbpg8cj8qvF+z4TeM7zS/DuvaH4osLaR0eTSnmmtoXV2Voo5ZkRnKFSCwBB9c5rysdgp1kpKVzwZ5hjMmqqVSacX/W3+R7voNjL4igjfT45z5qhscZUehPSr0HhW51GZ008O";	ImgData += "CpAkDELt/MVs/DvSovD/gK0n00zzC8t47shm4JZQflHQf8A1qZomsSvrl0DHtWdgSc8jAxmuWtSo4SVNVm7vex9nh8ZUxFP2iXS55Z8efg7N8Xfh3c6BaTaRb3Ul1BKs2qacL2O32SAs0ahlMc23cEkB+RjkhhwfKv2a/2fNW8B2uoXXxo0Hw9HpF9ZXL3f23y5b/TGicrjOGjMUk";	ImgData += "QaXcrBlwueSQPSPjt8PPix8OfE+qeLPgzrVn430nWrsTTeGNWtkim01jGqn7DOjx7oiY93ludwLsQW6Dx7xbD8YPj4ttoXinwvrehaBqcci6ta2lpFYpH94Rxvd3Uz+bE3yM+xRxlcMa9ONKph17NTXI9fM3jUVZKVtThfgPpjfFTx/oUOhTWmlWN5dWkGpaRZSzxS31nbRmdrqdD";	ImgData += "lWVmRFbcf9ZKMDB57n4o/sa6zc/FWAfDsXeqabfWE+o3N9rt6JYTdpNn7JK6YlVZUcKrBW2hHyQQAfX/gl8Dbr4eS3msfEDVpvEfi7V4YYb+/OEijjiUKkMAAB2AKuWIyxAzgACvQVslznY/A6mTmprZlJVP3T02NVR7lb7DZ+CfDMEGjpLBYadClvbwLISsUagKiBmOcDgZJzgV73";	ImgData += "/wTe+HUmofFf+0b0rIdGt5buYk5/ezZjQfkZD+FeCWOmSeMNZt7fSoZZ4lkURouXM8hIC7R35OAO5PtX6OfstfA1fgf8OI7fUAjazqJFxqDqc7Wx8sQPcIOM9yWPeuTCxdarzPZGeNqezp8l9Wel0UUV7J4gUUUUAFFFFABX5y/8Fa/gj4P0r4taBq3hTSbfT/EGt281zqksDhYrs";	ImgData += "o8ao8sA48w5YGTgsBg5wCP0ar8yv8Agrd4qsvDv7QWoXmnXAmu4NItYJo3UoIZf3hRdx4I2urEjgc571y4xyVJqG70POzVQeHfOrnmn7PPxE0Wy8a3PhSXUmjuJYN1nay3BMEZUktHGHOFbBztHUA+ldl+0F4ll+Dvw4n8QaabVbmC6tlhiuVJjvd0gDRfLzym87h93GeQMH3b/";	ImgData += "gnH/wAE3j8PPAt7rP7TsHhTxTN4kEd3Z6TJZW2p29ipwwmN1JEWeVwR8qN5SjpuJLVj/tbf8EYLH4g6pqWt/s262PDzyW7SweG7x5DpIusrxbsCfscbLvyqoyq2CoALA0sFRnGKrLmkuplhni6eEslZvp1R8XfEz9s/UPGculR+C7FdDhtyzXSXLi5W4c4AGQF2oOefvHPbHPS+B";	ImgData += "/jvo/izUBY30htbxY/9a7NHBcMB83lluV9g3Jqbwr/wSW+MV18RItB8d+GLjR7a8trgW2t211b32mwXKxl4Rc7HEqwuVMZdY9ys6HaRmvMvEH7KvxQ+F2heJNa8aeE9c0KHwZdWsV7PdwSIiPNMY43gmA8udA6ruZGICujHg8XiMLHELXc5cPmGY4GfPJNx6prtv6ep7o";	ImgData += "PEUd0CNEjub6QDjys7M+7sAB+tavg34feIPiLrMOlWVvNd3tzhktbQFiwxzu9gepJC9ya+n/2Q/wBlLwp8cPgb4T8c+INQ1K6/4SPTor6S0gZYIoZCP3kZYAuSrhlPI5B6V9N+A/hX4d+GVm0PgTR7HTVcYkeKP95L/vucs34k15NLLarf7x2X4n20szg4p01ueTfso/scW3wdij1";	ImgData += "jx1Ha3Wv/AHoI0O+PT+MHB6PJyRuxgDhe5PvNFFexTpxpR5Y7HmVKkqsuaT1CiiirICiiigAooooA8T/b9/aL1f8AZf8A2epvE/gZdOOof2nZ2KtewtLDGssoViVV1JJGVHPBYHnpXyV+0Hqvw+/aq8ceGvjj4httYf4V6LdDSPEtg0KC9vtVjnghsbXyQxDQTG8+d94AWDa3Dn";	ImgData += "Gl+2J+yz+1R+0hf/EH4cXyeF9X+HXi3x3peu6D4jn8RJbXHhXSrae1mktPsaWe6Ukwz4BdyS+PMAYeVg+Mf+Cafx2u9K8WfBjwvbeAB8IvFPxO0/x7D4wm1+4XWNLtbe+s757L+yxa7ZZC9mY1f7QqhXyf7o6Y0oOKcrX33W2n49jKtRhXjyz23+4+sn/4KKfDfSvGd1os48QW+";	ImgData += "labra+GJdf/ALJkGhw6juCC1N0PlUhiq5ICgnGeKzNe/wCCnXgDQ/HRsfsPii78Mxa2nhqfxbbaf5uiRak0qxC388NlvnbBdVKgjuOa+evFf/BMz4qat+wN8VvhnbvoE/iDxR8X5vGmkvJrTiKTS5Nbhvdss32fMcnkLInlbGAICbyPmr4//aE+NEPwE+B3iz9mjwl8UPhD4j8O";	ImgData += "aZ8Rre402JddmtfiCk41mK7GnHQ5bUbgkybftKy/NFgovzqQ406cnZPrb5d/+AbWR+k/wt/4KQWkNpqmmfFmyuNV8Wr431PwvpWleHLEz3d7FbNu80wtJwEQ7WcsASOAOg9I8Qat4L/b4/ZS8W6bp82uyaDrtre6JqUFsHsdVspo8pLBtYbop1ZQACD1B5Br4d8X/wDBID4n3vxG174";	ImgData += "iafpXgPxJri+PdX1SDwzrXiO9ttO1/RbtFaEyXVtb+ZY3cM7SMFVJUKgAkk/L9r/sF/s33/7OHwNn07xnoHw98L+I9e1KfV9UtPBdtcJYRSyBUQNPdM0t5OsUcSPdOE8wpny0GFE1FBLmi9RNJqzPkT/gnf8AGHxL4S+HOgeEvgr8TfCWrato1+0mpfDnxGsdhr8UUlwzSLHK+0iRt";	ImgData += "zuEKbVPy5GCK+u/i5+27YfBjxvFYeMfBXjqHQv7WtdFl8RSWcUOnLc3DokQj8yVZJ0LSKpeNGUENycV8z/tD/sA/Hz9pTwwvw++MY+DPiq0gvFl0/4tzCXTvGOlRJcB45I7C3tPJ+1rEoTzY7iKNmy3lqPlpnxi/wCCTfxA+M/7Q/iHUfFeseDr/RNX8baV4osvFupXd9e+JtC02z";	ImgData += "ls5ZdFsLdx5FrHMbN1eSKRVZbh98bGrlyTknJ/1/XzCMVFWR7f8Rv+ConhT4dz67PN4S8b6hoeha5N4cfWba1gFjPfxcSQI7yg7gwZRkDJXjORmvff8FRdC8N2OrJ8QvBPi/w1rWhanpNjf6VqJto7iCLUZWit7jIkKldy8rndyMAk4ryLWf8Agl/8SvGP7Eni/wCHN7rXh7S9e1T";	ImgData += "4z3HxC0+6/tG4uYjpza4NQEMriFWWRod0WwBlXIG5hknov2uv+CW3iX9pP9o74n+LdG8TaNpen+NvCfhqz0wTxSyyafrGiatJqFvJNEpUSW8nmBW2uG4Iwc0oxovd/wBafpf7hqx6d+1B+2jB8NPiW3hXSrvUdEvPDt9oF3qV4LS3u7e7tNSuprVYSjuHUb4vmdcMOCu7DCvpAV8Ff";	ImgData += "G7/AIJn/Ff9ovUvH3i74l+J/BFp408Wf8Ina2VnphvE0uxt9E1KW+Ls7gyNLK9w4wFxhVBJHT70TIQeZjdjnHTNZVFFJcr1/wCAv+CGgtFFFZCCiiigAooooAKx5Ph5oE3iMaxNomkPq4YML1rKM3IIGAfN27s4460UUAbFFFFABRRRQAUUUUAFFFFABRRRQB//2Q==";			if (vAnScol !== null) {		vHtml = '<head> <meta charset="UTF-8"> </head> ';		vHtml += '<style> .break { page-break-after: always; } </style>';				if (uParam[0].Preview !== true ) {			facthst = new ds.HistFact();			facthst.Annee_Scolaire = vAnScol;			facthst.NbFact = 0;			facthst.sMois = vParaM;			facthst.Ind_Deb = vIndFact;			facthst.libMois = vParaLm;			facthst.save(); 		}				familles = ds.Familles.query("Enfants_Scolarises.Scolarite.Annee_Scolaire.ID = :1 order by Famille_Nom ", vAnScol);		familles.forEach(function (famille) {						if (famille.Relation_Pere_Mere === "Mariés") {				if (famille.Pere_Nom === null) {					vLibFam = "<B>Famille " + famille.Famille_Nom + "</B><BR>";				} else {					vLibFam = "<B>Mr ou Mme " + famille.Pere_Prenom + " " + famille.Pere_Nom + "</B><BR>";				}				if (famille.Pere_Adresse_1 !== null) {					vLibFam += famille.Pere_Adresse_1 + "<BR>";				}				if (famille.Pere_Adresse_2 !== null) {					vLibFam += famille.Pere_Adresse_2 + "<BR>";				}				if (famille.Pere_Adresse_CP !== null) {					vLibFam += famille.Pere_Adresse_CP + " " + ((famille.Pere_Adresse_Ville === null) ? ' ' : famille.Pere_Adresse_Ville)				}			} else {				if (famille.Autorite_Parentale === "Père") {					vLibFam = "<B>Mr " + famille.Pere_Prenom + " " + famille.Pere_Nom + "</B><BR>";					if (famille.Pere_Adresse_1 !== null) {						vLibFam += famille.Pere_Adresse_1 + "<BR>";					}					if (famille.Pere_Adresse_2 !== null) {						vLibFam += famille.Pere_Adresse_2 + "<BR>";					}					if (famille.Pere_Adresse_CP !== null) {						vLibFam += famille.Pere_Adresse_CP + " " + ((famille.Pere_Adresse_Ville === null) ? ' ' : famille.Pere_Adresse_Ville)					}				}				if (famille.Autorite_Parentale === "Mère") {					vLibFam = "<B>Mme " + famille.Mere_Prenom + " " + famille.Mere_Nom + "</B><BR>";					if (famille.Mere_Adresse_1 !== null) {						vLibFam += famille.Mere_Adresse_1 + "<BR>";					}					if (famille.Mere_Adresse_2 !== null) {						vLibFam += famille.Mere_Adresse_2 + "<BR>";					}					if (famille.Mere_Adresse_CP !== null) {						vLibFam += famille.Mere_Adresse_CP + " " + ((famille.Mere_Adresse_Ville === null) ? ' ' : famille.Mere_Adresse_Ville)					}				}				if (famille.Autorite_Parentale === "Autre") {					vLibFam = "<B>Famille " + famille.Famille_Nom + "</B><BR>";				}			}			vtmpHtml = '<TABLE cellpadding="10px" cellspacing="2px" width=800 rules="all" style="border:solid 2px black; font-family:Calibri; font-size:12px; vertical-align: middle;">';			vtmpHtml += '<TR><TD width=10% align=center"><IMG src="'+ImgData+'"</TD><TD width=25%>Ecole Française de Koh Samui<BR>143/1 Moo 4, Maret Lamai<BR>Koh Samui, 84310 Surathani<BR>Téléphone : 08 24 14 24 29</TD>';			vtmpHtml += "<TD width=35% align=left><FONT SIZE=4><B>Facture Mensuelle n° " + vIndFact + "</B><BR>Mois de " + vParaLm + "<BR>Le " + vlToday;			vtmpHtml += "</TD><TD width=30% align=left>" + vLibFam + "</TD></TR></TABLE><TABLE border=0><TR><TD height=15>&nbsp;</TD></TR></TABLE>";			vtmpHtml += '<TABLE cellpadding="4px" cellspacing="3px" width=800 style="border:solid 1px black; font-family:Calibri; font-size:11px; vertical-align: middle;">';			vtmpHtml += '<TR><TD COLSPAN=8></TD></TR>';			vtmpHtml += '<TR><TD width=1%></TD><TD width=19% bgcolor=#CEF6F5 align=center><B>Eleve</B></TD><TD width=25% bgcolor=#CEF6F5 align=center><B>Article</B></TD><TD width=24% bgcolor=#CEF6F5 align=center><B>Détail</B></TD>';			vtmpHtml += '<TD width=10% bgcolor=#CEF6F5 align=center><B>Qté</B></TD><TD width=10% bgcolor=#CEF6F5 align=center><B>Prix<BR>unitaire</B></TD><TD width=10% bgcolor=#CEF6F5 align=center><B>Total</B></TD><TD width=1%></TD></TR>'						vTotal = 0;			vNbEnf = 1;			vMontant = 0;			vRupt = "";			factflag = 0;						eleves = ds.Parcours_Scolaire.query("Annee_Scolaire.ID = :1 and Eleve.MaFamille.ID = :2 and Date_Deb <= :3 and Dat_Fin > :3 order by Classe", vAnScol, famille.ID, Mpres);			//eleves = ds.Parcours_Scolaire.query("Annee_Scolaire.ID = :1 and Eleve.MaFamille.ID = :2 order by Eleve.Nom_Complet", vAnScol, famille.ID);			eleves.forEach(function (eleve) {							frais = ds.Frais_Scolaires.query("Annee_Scolaire.ID = :1 and Classe = :2", vAnScol, eleve.Classe);								if (eleve.Mode_Reglement === "Mensuel") {					vtmpHtml += '<TR><TD></TD><TD align=left>' + eleve.Eleve.Nom_Complet + '</TD><TD align=left>Frais de scolarité</TD><TD>Règlement mensuel (' + eleve.Classe + ')</TD><TD align=center>1</TD><TD align=right>' +  frais[0].Reglement_Mensuel + ' THB</TD><TD align=right>' +  frais[0].Reglement_Mensuel + ' THB</TD><TD></TD></TR>';						vTotal += frais[0].Reglement_Mensuel;					vMontant = frais[0].Reglement_Mensuel;						vRupt = eleve.Eleve.Nom_Complet;					if (uParam[0].Preview !== true && factflag === 0 && vTotal !== 0) {						factmaster = new ds.Factures();						factmaster.Numero = vIndFact;						factmaster.Famille = famille.ID;						factmaster.Annee_Scolaire = vAnScol;						factmaster.Total = 0;						factmaster.Periode_Du = Mtraite[0].dDeb;						factmaster.Periode_Au = Mtraite[0].dFin;						factmaster.save(); 						factflag = 1;					}					if (uParam[0].Preview !== true && factflag === 1 && vMontant !== 0) {						factline = new ds.Lignes();						factline.Facture = factmaster.ID;						factline.Eleve = eleve.Eleve.ID;						factline.Article = "Frais de scolarité";						factline.Quantite = 1;						factline.Prix_unitaire = vMontant;						factline.Total_Ligne = vMontant;						factline.Detail = "Règlement mensuel (" + eleve.Classe + ")";						factline.Remise = 0;						factline.Periode_Du = Mtraite[0].dDeb;						factline.Periode_Au = Mtraite[0].dFin;						factline.save();					}				} else {					Nmonth = frais[0].Echeance_T1.getMonth(); 					Nyear = frais[0].Echeance_T1.getYear();					Nyear = ((Nyear < 200) ? 1900 : 0) + Nyear;					vlTrim = ListeMois[Nmonth] + ' ' + Nyear;					if (eleve.Mode_Reglement === "Trimestriel" && vlTrim === vParaLm) {						vtmpHtml += '<TR><TD></TD><TD align=left>' + eleve.Eleve.Nom_Complet + '</TD><TD align=left>Frais de scolarité</TD><TD>Règlement trimestriel T1 (' + eleve.Classe + ')</TD><TD align=center>1</TD><TD align=right>' +  frais[0].Reglement_Trimestriel_1 + ' THB</TD><TD align=right>' +  frais[0].Reglement_Trimestriel_1 + ' THB</TD><TD></TD></TR>';							vTotal += frais[0].Reglement_Trimestriel_1;							vMontant = frais[0].Reglement_Trimestriel_1;						vRupt = eleve.Eleve.Nom_Complet;							if (uParam[0].Preview !== true && factflag === 0 && vTotal !== 0) {							factmaster = new ds.Factures();							factmaster.Numero = vIndFact;							factmaster.Famille = famille.ID;							factmaster.Annee_Scolaire = vAnScol;							factmaster.Total = 0;							factmaster.Periode_Du = Mtraite[0].dDeb;							factmaster.Periode_Au = Mtraite[0].dFin;							factmaster.save(); 							factflag = 1;						}						if (uParam[0].Preview !== true && factflag === 1 && vMontant !== 0) {							factline = new ds.Lignes();							factline.Facture = factmaster.ID;							factline.Eleve = eleve.Eleve.ID;							factline.Article = "Frais de scolarité";							factline.Quantite = 1;							factline.Prix_unitaire = vMontant;							factline.Total_Ligne = vMontant;							factline.Detail = "Règlement trimestriel T1 (" + eleve.Classe + ")";							factline.Remise = 0;							factline.save();						}								} else {						Nmonth = frais[0].Echeance_T2.getMonth(); 						Nyear = frais[0].Echeance_T2.getYear();						Nyear = ((Nyear < 200) ? 1900 : 0) + Nyear;						vlTrim = ListeMois[Nmonth] + ' ' + Nyear;						if (eleve.Mode_Reglement === "Trimestriel" && vlTrim === vParaLm) {							vtmpHtml += '<TR><TD></TD><TD align=left>' + eleve.Eleve.Nom_Complet + '</TD><TD align=left>Frais de scolarité</TD><TD>Règlement trimestriel T2 (' + eleve.Classe + ')</TD><TD align=center>1</TD><TD align=right>' +  frais[0].Reglement_Trimestriel_2 + ' THB</TD><TD align=right>' +  frais[0].Reglement_Trimestriel_2 + ' THB</TD><TD></TD></TR>';								vTotal += frais[0].Reglement_Trimestriel_2;								vMontant = frais[0].Reglement_Trimestriel_2;							vRupt = eleve.Eleve.Nom_Complet;								if (uParam[0].Preview !== true && factflag === 0 && vTotal !== 0) {								factmaster = new ds.Factures();								factmaster.Numero = vIndFact;								factmaster.Famille = famille.ID;								factmaster.Annee_Scolaire = vAnScol;								factmaster.Total = 0;								factmaster.Periode_Du = Mtraite[0].dDeb;								factmaster.Periode_Au = Mtraite[0].dFin;								factmaster.save(); 								factflag = 1;							}							if (uParam[0].Preview !== true && factflag === 1 && vMontant !== 0) {								factline = new ds.Lignes();								factline.Facture = factmaster.ID;								factline.Eleve = eleve.Eleve.ID;								factline.Article = "Frais de scolarité";								factline.Quantite = 1;								factline.Prix_unitaire = vMontant;								factline.Total_Ligne = vMontant;								factline.Detail = "Règlement trimestriel T2 (" + eleve.Classe + ")";								factline.Remise = 0;								factline.save();							}											} else {							Nmonth = frais[0].Echeance_T3.getMonth(); 							Nyear = frais[0].Echeance_T3.getYear();							Nyear = ((Nyear < 200) ? 1900 : 0) + Nyear;							vlTrim = ListeMois[Nmonth] + ' ' + Nyear;							if (eleve.Mode_Reglement === "Trimestriel" && vlTrim === vParaLm) {								vtmpHtml += '<TR><TD></TD><TD align=left>' + eleve.Eleve.Nom_Complet + '</TD><TD align=left>Frais de scolarité</TD><TD>Règlement trimestriel T3 (' + eleve.Classe + ')</TD><TD align=center>1</TD><TD align=right>' +  frais[0].Reglement_Trimestriel_3 + ' THB</TD><TD align=right>' +  frais[0].Reglement_Trimestriel_3 + ' THB</TD><TD></TD></TR>';									vTotal += frais[0].Reglement_Trimestriel_3;									vMontant = frais[0].Reglement_Trimestriel_3;								vRupt = eleve.Eleve.Nom_Complet;								if (uParam[0].Preview !== true && factflag === 0 && vTotal !== 0) {									factmaster = new ds.Factures();									factmaster.Numero = vIndFact;									factmaster.Famille = famille.ID;									factmaster.Annee_Scolaire = vAnScol;									factmaster.Total = 0;									factmaster.Periode_Du = Mtraite[0].dDeb;									factmaster.Periode_Au = Mtraite[0].dFin;									factmaster.save(); 									factflag = 1;								}								if (uParam[0].Preview !== true && factflag === 1 && vMontant !== 0) {									factline = new ds.Lignes();									factline.Facture = factmaster.ID;									factline.Eleve = eleve.Eleve.ID;									factline.Article = "Frais de scolarité";									factline.Quantite = 1;									factline.Prix_unitaire = vMontant;									factline.Total_Ligne = vMontant;									factline.Detail = "Règlement trimestriel T3 (" + eleve.Classe + ")";									factline.Remise = 0;									factline.save();								}													}						}					}				}				if (vNbEnf === 2 && vMontant > 0 && vRupt === eleve.Eleve.Nom_Complet) {						vlReduc = "Taux de remise : " + AnScol[0].Remise_Enfant_2 + " %";						vReduc = parseInt((-1 * vMontant * AnScol[0].Remise_Enfant_2)/100,10);						vTotal += vReduc;						vtmpHtml += '<TR><TD></TD><TD align=left>' + eleve.Eleve.Nom_Complet + '</TD><TD align=left>Remise frais de scolarité 2ème enfant</TD><TD>' + vlReduc + '</TD><TD align=center>1</TD><TD align=right>' +  vReduc + ' THB</TD><TD align=right>' +  vReduc + ' THB</TD><TD></TD></TR>';							if (uParam[0].Preview !== true && factflag === 0 && vTotal !== 0) {							factmaster = new ds.Factures();							factmaster.Numero = vIndFact;							factmaster.Famille = famille.ID;							factmaster.Annee_Scolaire = vAnScol;							factmaster.Total = 0;							factmaster.Periode_Du = Mtraite[0].dDeb;							factmaster.Periode_Au = Mtraite[0].dFin;							factmaster.save(); 															factflag = 1;						}						if (uParam[0].Preview !== true && factflag === 1 && vReduc !== 0) {							factline = new ds.Lignes();							factline.Facture = factmaster.ID;							factline.Eleve = eleve.Eleve.ID;							factline.Article = "Remise frais de scolarité 2ème enfant";							factline.Quantite = 1;							factline.Prix_unitaire = vReduc;							factline.Total_Ligne = vReduc;							factline.Detail = vlReduc;							factline.Remise = AnScol[0].Remise_Enfant_2;							factline.save();						}						} else {					if (vNbEnf > 2 && vMontant > 0 && vRupt === eleve.Eleve.Nom_Complet) {						vlReduc = "Taux de remise : " + AnScol[0].Remise_Enfant_3 + " %";						vReduc = parseInt((-1 * vMontant * AnScol[0].Remise_Enfant_3)/100,10);						vTotal += vReduc;						vtmpHtml += '<TR><TD></TD><TD align=left>' + eleve.Eleve.Nom_Complet + '</TD><TD align=left>Remise frais de scolarité 3ème enfant et +</TD><TD>' + vlReduc + '</TD><TD align=center>1</TD><TD align=right>' +  vReduc + ' THB</TD><TD align=right>' +  vReduc + ' THB</TD><TD></TD></TR>';							if (uParam[0].Preview !== true && factflag === 0 && vTotal !== 0) {							factmaster = new ds.Factures();							factmaster.Numero = vIndFact;							factmaster.Famille = famille.ID;							factmaster.Annee_Scolaire = vAnScol;							factmaster.Total = 0;							factmaster.Periode_Du = Mtraite[0].dDeb;							factmaster.Periode_Au = Mtraite[0].dFin;							factmaster.save(); 															factflag = 1;						}						if (uParam[0].Preview !== true && factflag === 1 && vReduc !== 0) {							factline = new ds.Lignes();							factline.Facture = factmaster.ID;							factline.Eleve = eleve.Eleve.ID;							factline.Article = "Remise frais de scolarité 3ème enfant et +";							factline.Quantite = 1;							factline.Prix_unitaire = vReduc;							factline.Total_Ligne = vReduc;							factline.Detail = vlReduc;							factline.Remise = AnScol[0].Remise_Enfant_3;							factline.save();						}							} 				}								vNbCant = 0;				vNbThai = 0;				vLibCant = "";				vLibThai = "";							jourms = ds.Releve_Presences.query("Eleve.Eleve.ID = :1 and sMois = :2 order by Jour_Ouvre", eleve.Eleve.ID, vParaM);				if (jourms.length > 0) {					jourms.forEach(function (jourm) {						jOuv = jourm.Jour_Ouvre;						Nday = jOuv.getDate();						if (jourm.Cantine) {							vNbCant += 1;							vLibCant += ((Nday < 10) ? '0': '')+Nday+"&nbsp;";						}						if (jourm.CoursThai) {							vNbThai += 1;							vLibThai += ((Nday < 10) ? '0': '')+Nday+"&nbsp;";						}					});				}								if (vNbCant > 0) {					vMontant = vNbCant * AnScol[0].Cantine_Scolaire;					vTotal += vMontant;					vtmpHtml += '<TR><TD></TD><TD align=left>' + eleve.Eleve.Nom_Complet + '</TD><TD align=left>Frais de cantine du mois</TD><TD>' + vLibCant + '</TD><TD align=center>' + vNbCant + '</TD><TD align=right>' +  AnScol[0].Cantine_Scolaire + ' THB</TD><TD align=right>' +  vMontant + ' THB</TD><TD></TD></TR>';						if (uParam[0].Preview !== true && factflag === 0 && vTotal !== 0) {						factmaster = new ds.Factures();						factmaster.Numero = vIndFact;						factmaster.Famille = famille.ID;						factmaster.Annee_Scolaire = vAnScol;						factmaster.Total = 0;						factmaster.Periode_Du = Mtraite[0].dDeb;						factmaster.Periode_Au = Mtraite[0].dFin;						factmaster.save(); 						factflag = 1;					}					if (uParam[0].Preview !== true && factflag === 1 && vMontant !== 0 ) {						factline = new ds.Lignes();						factline.Facture = factmaster.ID;						factline.Eleve = eleve.Eleve.ID;						factline.Article = "Frais de cantine du mois";						factline.Quantite = vNbCant;						factline.Prix_unitaire = AnScol[0].Cantine_Scolaire;						factline.Total_Ligne = vMontant;						factline.Detail = vLibCant;						factline.Remise = 0;						factline.Periode_Du = Mtraite[0].dDeb;						factline.Periode_Au = Mtraite[0].dFin;						factline.save(); 					}				}								if (vNbThai > 0) {					vMontant = vNbThai * AnScol[0].Cours_Thai;					vTotal += vMontant;					vtmpHtml += '<TR><TD></TD><TD align=left>' + eleve.Eleve.Nom_Complet + '</TD><TD align=left>Cours thaï du mois</TD><TD>' + vLibThai + '</TD><TD align=center>' + vNbThai + '</TD><TD align=right>' +  AnScol[0].Cours_Thai + ' THB</TD><TD align=right>' +  vMontant + ' THB</TD><TD></TD></TR>';						if (uParam[0].Preview !== true && factflag === 0 && vTotal !== 0) {						factmaster = new ds.Factures();						factmaster.Numero = vIndFact;						factmaster.Famille = famille.ID;						factmaster.Annee_Scolaire = vAnScol;						factmaster.Total = 0;						factmaster.Periode_Du = Mtraite[0].dDeb;						factmaster.Periode_Au = Mtraite[0].dFin;						factmaster.save(); 						factflag = 1;					}					if (uParam[0].Preview !== true && factflag === 1 && vMontant !== 0 ) {						factline = new ds.Lignes();						factline.Facture = factmaster.ID;						factline.Eleve = eleve.Eleve.ID;						factline.Article = "Cours thaï du mois";						factline.Quantite = vNbThai;						factline.Prix_unitaire = AnScol[0].Cours_Thai;						factline.Total_Ligne = vMontant;						factline.Detail = vLibThai;						factline.Remise = 0;						factline.Periode_Du = Mtraite[0].dDeb;						factline.Periode_Au = Mtraite[0].dFin;						factline.save(); 					}				}								afacts = ds.EvtFact.query("Annee_Scolaire.ID = :1 and Eleve.ID = :2 and (Traite = null or Traite = false)", vAnScol, eleve.Eleve.ID);				if (afacts.length > 0) {					afacts.forEach(function (afact) {						vtmpHtml += '<TR><TD></TD><TD align=left>' + eleve.Eleve.Nom_Complet + '</TD><TD align=left>' + afact.Article + '</TD><TD>' + afact.Detail + '</TD><TD align=center>' + afact.Quantite + '</TD><TD align=right>' +  afact.Prix_unitaire + ' THB</TD><TD align=right>' +  afact.Total + ' THB</TD><TD></TD></TR>';							vTotal += afact.Total;						if (uParam[0].Preview !== true ) {							afact.Traite = true;							afact.Date_traite = new Date();						}						if (uParam[0].Preview !== true && factflag === 0 && vTotal !== 0) {							factmaster = new ds.Factures();							factmaster.Numero = vIndFact;							factmaster.Famille = famille.ID;							factmaster.Annee_Scolaire = vAnScol;							factmaster.Total = 0;							factmaster.Periode_Du = Mtraite[0].dDeb;							factmaster.Periode_Au = Mtraite[0].dFin;							factmaster.save(); 							factflag = 1;						}						if (uParam[0].Preview !== true && factflag === 1 && vMontant !== 0 ) {							factline = new ds.Lignes();							factline.Facture = factmaster.ID;							factline.Eleve = eleve.Eleve.ID;							factline.Article = afact.Article;							factline.Quantite = afact.Quantite;							factline.Prix_unitaire = afact.Prix_unitaire;							factline.Total_Ligne = afact.Total;							factline.Detail = afact.Detail;							factline.Remise = 0;							factline.save(); 						}					});				}								vNbEnf += 1;							});						vtmpHtml += '<TR><TD></TD><TD COLSPAN=6 bgcolor=#FFFFFF>&nbsp;</TD><TD></TD></TR>';				vtmpHtml += '<TR><TD></TD><TD COLSPAN=5 align=right bgcolor=#CEF6F5><B>Total à payer</B></TD><TD align=right bgcolor=#CEF6F5><B>' +  vTotal + ' THB</B></TD><TD></TD></TR>';				vtmpHtml += '<TR><TD></TD><TD COLSPAN=6 bgcolor=#FFFFFF>&nbsp;</TD><TD></TD></TR>';				vtmpHtml += '<TR><TD></TD><TD COLSPAN=6 bgcolor=#FFFFFF align=left>A votre aimable règlement au plus tard une semaine après réception de la présente facture.</TD><TD></TD></TR>';							if (vTotal > 0) {				if (uParam[0].Preview !== true && factflag === 1) {					factmaster.Total = vTotal;					factmaster.save();				}				vIndFact += 1;				vHtml += vtmpHtml;				vHtml += '<TR><TD COLSPAN=8></TD></TR></TABLE>';				vHtml += '<P class="break">';				vHtml += '<TABLE width=800 border=0><TR><TD height=5 bgcolor=#FFFFFF>&nbsp;</TD></TR></TABLE><P>';			}		});		if (uParam[0].Preview !== true) {			facthst.Ind_Fin = vIndFact - 1;			facthst.NbFact = vIndFact - facthst.Ind_Deb;			facthst.save();			factprm.IndFact = vIndFact;			factprm.save();		}	}		return vHtml;		}function FactDupli(request, response) {			var vHtml, vToday, exportData, dNais, dtNais, vSect, vCar, vAnScol, AnScol, vLibAn, vMail, Nday, Nmonth, Nyear, vCoul, FactPar, vIndFact, vlToday, vlTrim,		vSexe, vAn, eleves, dDeb, dFin, vFam, vMoi, freres, vNbf, vLien, vNe, vDne, vUser, uParam, vUserName, vParaA, vParaM, vParaLm, ImgData, vLibFam, vTotal,		ListeMois = ["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"], vCree, vlCree ,		vNbCant, vNbAbs, vNbThai, vLibAbs, vLibCant, vLibThai, vtmpHtml, vHtml, Mtraite, Mpres, factlines, factline, factmaster, facthst, factprm ;		vUser = currentUser();    vUserName = vUser.name;	uParam = ds.UserParam.query("Utilisateur.Login = :1", vUserName);	if (uParam[0].Preview) {		response.contentType = 'text/html';	} else {		response.contentType = 'application/vnd.ms-excel';	}		vToday = new Date();		Nday = vToday.getDate();	Nday = ((Nday < 10) ? '0' : '') + Nday;	Nmonth = vToday.getMonth() + 1;	Nmonth = ((Nmonth < 10) ? '0' : '') + Nmonth; 	Nyear = vToday.getYear();	Nyear = ((Nyear < 200) ? 1900 : 0) + Nyear; 	vlToday = Nday + '/' + Nmonth + '/' + Nyear;		vParaA = uParam[0].Annee_Scolaire;	vParaM = uParam[0].Mois;	vParaLm = uParam[0].LibMois;	Mtraite = ds.Calendrier.query("lMois = :1", vParaLm);	Mpres = Mtraite[0].dFin;	FactPar = ds.FactParam.query("ID > 0");	factprm = FactPar.first();	vIndFact = factprm.IndFact;	AnScol = ds.Annees_Scolaires.query("ID = :1", vParaA);	vAnScol = AnScol[0].ID;	vLibAn = AnScol[0].Annee_Scolaire;		ImgData = "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/4gxYSUNDX1BST0ZJTEUAAQEAAAxITGlubwIQAABtbnRyUkdCIFhZWiAHzgACAAkABgAxAABhY3NwTVNGVAAAAABJRUMgc1";	ImgData += "JHQgAAAAAAAAAAAAAAAAAA9tYAAQAAAADTLUhQICAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABFjcHJ0AAABUAAAADNkZXNjAAABhAAAAGx3dHB0AAAB8AAAABRia3B0AAACBAAAABRyWF";	ImgData += "laAAACGAAAABRnWFlaAAACLAAAABRiWFlaAAACQAAAABRkbW5kAAACVAAAAHBkbWRkAAACxAAAAIh2dWVkAAADTAAAAIZ2aWV3AAAD1AAAACRsdW1pAAAD+AAAABRtZWFzAAAEDAAAACR0ZWNoAAAEMAAAAAxyVFJDAAAEPAAACAxnVFJ";	ImgData += "DAAAEPAAACAxiVFJDAAAEPAAACAx0ZXh0AAAAAENvcHlyaWdodCAoYykgMTk5OCBIZXdsZXR0LVBhY2thcmQgQ29tcGFueQAAZGVzYwAAAAAAAAASc1JHQiBJRUM2MTk2Ni0yLjEAAAAAAAAAAAAAABJzUkdCIElFQzYxOTY2LTIuMQAAAAAAAAAAAAAA";	ImgData += "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWFlaIAAAAAAAAPNRAAEAAAABFsxYWVogAAAAAAAAAAAAAAAAAAAAAFhZWiAAAAAAAABvogAAOPUAAAOQWFlaIAAAAAAAAGKZAAC3hQAAGNpYWVogAAAAAAAAJKAAAA+EAAC2z2Rlc2MAAAAAAAAAF";	ImgData += "klFQyBodHRwOi8vd3d3LmllYy5jaAAAAAAAAAAAAAAAFklFQyBodHRwOi8vd3d3LmllYy5jaAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABkZXNjAAAAAAAAAC5JRUMgNjE5NjYtMi4xIERlZmF1bHQgUkdCIGNvbG91ciBzcGFjZSAt";	ImgData += "IHNSR0IAAAAAAAAAAAAAAC5JRUMgNjE5NjYtMi4xIERlZmF1bHQgUkdCIGNvbG91ciBzcGFjZSAtIHNSR0IAAAAAAAAAAAAAAAAAAAAAAAAAAAAAZGVzYwAAAAAAAAAsUmVmZXJlbmNlIFZpZXdpbmcgQ29uZGl0aW9uIGluIElFQzYxOTY2LTIuMQAAAAAA";	ImgData += "AAAAAAAALFJlZmVyZW5jZSBWaWV3aW5nIENvbmRpdGlvbiBpbiBJRUM2MTk2Ni0yLjEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHZpZXcAAAAAABOk/gAUXy4AEM8UAAPtzAAEEwsAA1yeAAAAAVhZWiAAAAAAAEwJVgBQAAAAVx/nbWVhcwAAAAAAAAAB";	ImgData += "AAAAAAAAAAAAAAAAAAAAAAAAAo8AAAACc2lnIAAAAABDUlQgY3VydgAAAAAAAAQAAAAABQAKAA8AFAAZAB4AIwAoAC0AMgA3ADsAQABFAEoATwBUAFkAXgBjAGgAbQByAHcAfACBAIYAiwCQAJUAmgCfAKQAqQCuALIAtwC8AMEAxgDLANAA1QDbAOAA5Q";	ImgData += "DrAPAA9gD7AQEBBwENARMBGQEfASUBKwEyATgBPgFFAUwBUgFZAWABZwFuAXUBfAGDAYsBkgGaAaEBqQGxAbkBwQHJAdEB2QHhAekB8gH6AgMCDAIUAh0CJgIvAjgCQQJLAlQCXQJnAnECegKEAo4CmAKiAqwCtgLBAssC1QLgAusC9QMAAwsDFgMhAy0DOANDA08";	ImgData += "DWgNmA3IDfgOKA5YDogOuA7oDxwPTA+AD7AP5BAYEEwQgBC0EOwRIBFUEYwRxBH4EjASaBKgEtgTEBNME4QTwBP4FDQUcBSsFOgVJBVgFZwV3BYYFlgWmBbUFxQXVBeUF9gYGBhYGJwY3BkgGWQZqBnsGjAadBq8GwAbRBuMG9QcHBxkHKwc9B08HYQd0B4YHmQes";	ImgData += "B78H0gflB/gICwgfCDIIRghaCG4IggiWCKoIvgjSCOcI+wkQCSUJOglPCWQJeQmPCaQJugnPCeUJ+woRCicKPQpUCmoKgQqYCq4KxQrcCvMLCwsiCzkLUQtpC4ALmAuwC8gL4Qv5DBIMKgxDDFwMdQyODKcMwAzZDPMNDQ0mDUANWg10DY4NqQ3DDd4N+A4TDi4OSQ5";	ImgData += "kDn8Omw62DtIO7g8JDyUPQQ9eD3oPlg+zD88P7BAJECYQQxBhEH4QmxC5ENcQ9RETETERTxFtEYwRqhHJEegSBxImEkUSZBKEEqMSwxLjEwMTIxNDE2MTgxOkE8UT5RQGFCcUSRRqFIsUrRTOFPAVEhU0FVYVeBWbFb0V4BYDFiYWSRZsFo8WshbWFvoXHRdBF2UXiReu";	ImgData += "F9IX9xgbGEAYZRiKGK8Y1Rj6GSAZRRlrGZEZtxndGgQaKhpRGncanhrFGuwbFBs7G2MbihuyG9ocAhwqHFIcexyjHMwc9R0eHUcdcB2ZHcMd7B4WHkAeah6UHr4e6R8THz4faR+UH78f6iAVIEEgbCCYIMQg8CEcIUghdSGhIc4h+yInIlUigiKvIt0jCiM4I2YjlCPCI";	ImgData += "/AkHyRNJHwkqyTaJQklOCVoJZclxyX3JicmVyaHJrcm6CcYJ0kneierJ9woDSg/KHEooijUKQYpOClrKZ0p0CoCKjUqaCqbKs8rAis2K2krnSvRLAUsOSxuLKIs1y0MLUEtdi2rLeEuFi5MLoIuty7uLyQvWi+RL8cv/jA1MGwwpDDbMRIxSjGCMbox8jIqMmMymzLUMw0z";	ImgData += "RjN/M7gz8TQrNGU0njTYNRM1TTWHNcI1/TY3NnI2rjbpNyQ3YDecN9c4FDhQOIw4yDkFOUI5fzm8Ofk6Njp0OrI67zstO2s7qjvoPCc8ZTykPOM9Ij1hPaE94D4gPmA+oD7gPyE/YT+iP+JAI0BkQKZA50EpQWpBrEHuQjBCckK1QvdDOkN9Q8BEA0RHRIpEzkUSRVVFmk";	ImgData += "XeRiJGZ0arRvBHNUd7R8BIBUhLSJFI10kdSWNJqUnwSjdKfUrESwxLU0uaS+JMKkxyTLpNAk1KTZNN3E4lTm5Ot08AT0lPk0/dUCdQcVC7UQZRUFGbUeZSMVJ8UsdTE1NfU6pT9lRCVI9U21UoVXVVwlYPVlxWqVb3V0RXklfgWC9YfVjLWRpZaVm4WgdaVlqmWvVbRVuVW+";	ImgData += "VcNVyGXNZdJ114XcleGl5sXr1fD19hX7NgBWBXYKpg/GFPYaJh9WJJYpxi8GNDY5dj62RAZJRk6WU9ZZJl52Y9ZpJm6Gc9Z5Nn6Wg/aJZo7GlDaZpp8WpIap9q92tPa6dr/2xXbK9tCG1gbbluEm5rbsRvHm94b9FwK3CGcOBxOnGVcfByS3KmcwFzXXO4dBR0cHTMdSh1h";	ImgData += "XXhdj52m3b4d1Z3s3gReG54zHkqeYl553pGeqV7BHtje8J8IXyBfOF9QX2hfgF+Yn7CfyN/hH/lgEeAqIEKgWuBzYIwgpKC9INXg7qEHYSAhOOFR4Wrhg6GcobXhzuHn4gEiGmIzokziZmJ/opkisqLMIuWi/yMY4zKjTGNmI3/jmaOzo82j56QBpBukNaRP5GokhGSepLj";	ImgData += "k02TtpQglIqU9JVflcmWNJaflwqXdZfgmEyYuJkkmZCZ/JpomtWbQpuvnByciZz3nWSd0p5Anq6fHZ+Ln/qgaaDYoUehtqImopajBqN2o+akVqTHpTilqaYapoum/adup+CoUqjEqTepqaocqo+rAqt1q+msXKzQrUStuK4trqGvFq+LsACwdbDqsWCx1rJLssKzOLOutC";	ImgData += "W0nLUTtYq2AbZ5tvC3aLfguFm40blKucK6O7q1uy67p7whvJu9Fb2Pvgq+hL7/v3q/9cBwwOzBZ8Hjwl/C28NYw9TEUcTOxUvFyMZGxsPHQce/yD3IvMk6ybnKOMq3yzbLtsw1zLXNNc21zjbOts83z7jQOdC60TzRvtI/0sHTRNPG1EnUy9VO1dHWVdbY11zX4Nhk2Oj";	ImgData += "ZbNnx2nba+9uA3AXcit0Q3ZbeHN6i3ynfr+A24L3hROHM4lPi2+Nj4+vkc+T85YTmDeaW5x/nqegy6LzpRunQ6lvq5etw6/vshu0R7ZzuKO6070DvzPBY8OXxcvH/8ozzGfOn9DT0wvVQ9d72bfb794r4Gfio+Tj5x/pX+uf7d/wH/Jj9Kf26/kv+3P9t////4QMcRXhpZg";	ImgData += "AATU0AKgAAAAgACAEPAAIAAAAWAAAAbgEQAAIAAAAiAAAAhAESAAMAAAABAAEAAAEaAAUAAAABAAAApgEbAAUAAAABAAAArgEoAAMAAAABAAIAAAEyAAIAAAAUAAAAtodpAAQAAAABAAAAygAAAABFQVNUTUFOIEtPREFLIENPTVBBTlkAS09EQUsgUExBWVNQT1JUIFZpZ";	ImgData += "GVvIENhbWVyYSwgWng1AAAAAEgAAAABAAAASAAAAAEyMDE0OjA3OjI3IDA3OjE1OjI0AAAlgpoABQAAAAEAAAKMgp0ABQAAAAEAAAKUiCIAAwAAAAEAAgAAiCcAAwAAAAEAfQAAkAAABwAAAAQwMjMwkAMAAgAAABQAAAKckAQAAgAAABQAAAKwkQEABwAAAAQBAgMAkQIABQ";	ImgData += "AAAAEAAALEkgEACgAAAAEAAALMkgIABQAAAAEAAALUkgMACgAAAAEAAALckgQACgAAAAEAAALkkgUABQAAAAEAAALskgcAAwAAAAEABQAAkggAAwAAAAEAAAAAkgkAAwAAAAEAIAAAkgoABQAAAAEAAAL0khUABQAAAAEAAAL8oAAABwAAAAQwMTAwoAEAAwAAAAEAAQAAoAI";	ImgData += "ABAAAAAEAAABxoAMABAAAAAEAAABkohUABQAAAAEAAAMEohcAAwAAAAEAAgAAowAABwAAAAEDAAAApAEAAwAAAAEAAAAApAIAAwAAAAEAAAAApAMAAwAAAAEAAAAApAQABQAAAAEAAAMMpAUAAwAAAAEAIQAApAYAAwAAAAEAAAAApAcAAwAAAAEAAQAApAgAAwAAAAEAAAAA";	ImgData += "pAkAAwAAAAEAAAAApAoAAwAAAAEAAAAApAwAAwAAAAEAAAAAAAAAAAAAAAEAAAFAAAAADgAAAAUyMDE0OjA3OjI3IDA3OjE1OjI0ADIwMTQ6MDc6MjcgMDc6MTU6MjQAAAAuVwAAFlsAAAAZAAAAAwAAAAMAAAABAAAABwAAAAEAAAAAAAAAAQAAAAMAAAABAAAAJwAAAAoAAA";	ImgData += "B9AAAAAQAAAH0AAAABAAAAAAAAAAH/4QJ3aHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA1LjEuMiI+CiAgIDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vc";	ImgData += "mcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+CiAgICAgIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICAgICAgICAgIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyI+CiAgICAgICAgIDx4bXA6Q3JlYXRlRGF0ZT4yMDE0LTA3LTI3VDA";	ImgData += "3OjE1OjI0PC94bXA6Q3JlYXRlRGF0ZT4KICAgICAgICAgPHhtcDpNb2RpZnlEYXRlPjIwMTQtMDctMjdUMDc6MTU6MjQ8L3htcDpNb2RpZnlEYXRlPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgI";	ImgData += "CAgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIj4KICAgICAgICAgPHBob3Rvc2hvcDpEYXRlQ3JlYXRlZD4yMDE0LTA3LTI3VDA3OjE1OjI0PC9waG90b3Nob3A6RGF0ZUNyZWF0ZWQ+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogI";	ImgData += "CA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgr/2wBDAAIBAQIBAQICAQICAgICAwUDAwMDAwYEBAMFBwYHBwcGBgYHCAsJBwgKCAYGCQ0JCgsLDAwMBwkNDg0MDgsMDAv/2wBDAQICAgMCAwUDAwULCAYICwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsL";	ImgData += "CwsLCwv/wAARCABkAHEDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc";	ImgData += "3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEK";	ImgData += "RobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD9/KKKKA";	ImgData += "Cisb4h+Ln8B+CdU1mDTNQ1k6ZbtcmysED3Nwq8lYlJAZsZIXPOMCsTwx8bvDnxR+H8Gr/DjxDpRXVbZmsnuXCGOTBAEsLFXUq/DIcMCCODQK62O0zmjNeC+M/j7a/se/DSGw+J3ia88d+M7tWu/wB4qQeaXPXag229uuMKPmY4ONxya+Lvj1+3p4n8fatIPEOtSwWUuWTStPlaCON";	ImgData += "ewIU7pPq5OewFctbFwpPl3fY7MPg6mJ1S0P0yHxF8PnWE04a5o/8AaEj+Wlt9sj85m/uhN2SfbFchqX7Xfw60fxBeaZqnie0gvLCZoJ1aKXajqcMu8LtOCCOD2r8rbLxL4u1aYXHh7SodLjJzHLcyiNvqAAWFTwXvjKOVw+n2UkoHzS/aNsb85BXuTyeoFYrFzl9lfedn9lpbzP11";	ImgData += "8I/FLw54+bb4L13StUcLvKW10kjhfUqDkflW9X4/aZ8R/EHhS8STxDp89ooYAXcD7hHn/poh3D9K+iv2bv2+dW8DCG18U3MniHQy53rNKXurfP8AzzlY8gcfK3B5wRWyxKXxqxz1cvnBXjqfe9Fc/wDDn4paF8V9DGoeA9Rhv4AQsgXh4WwDtdDyrAEcGugrpTvqjgatuFFFFMAo";	ImgData += "oooAKKDyK870C78c+F/iPrUvxW1fwlJ4Luo0GlzQxtZ3VpNnbskEjMsm8HOQ33hwMHATYm7Hn3xp/aHv/hX+0VJp2m+L/DVlajSoby40LxSTp1vdKzOvn2GoqrbWXZiSKRGB4KlcknzvUPjtf+GL5fG3x0+GXwt1Hw3rcTjSdT0KaK9ur6dSWRvNnjRniIVsuE4+UjOa5e9/astL";	ImgData += "b4o3r+PbTSvi9o0d3MLO31HTre01vw7co2xowrr5UkDbSRIhIJ54PB8z/bO/aOl+N2v2F/8A2ZNo6Wtp9gttP+0LKYjuJZgygDJ+ToOAgrgxeL9lTbg9b6GuBofXK3LfRHmXxQ+JGu/G7x7ez3Nzi4upDJNJgtFZRkkrHGvRQoOFUcDr1JrO0nStA0CdraCOGS5if95cSxb3Z/UvV";	ImgData += "3wno0ek6OiSeUJmy8pJO5mPr614x8QvGcOlfFLWtKtLuIRQXAklRdxfDKrso54HJyfSubLMPHFVHGbd7bn0Neo6MeWnsj6BgkiktzLHJG6ICSQOn1zU6OVEZuB5XnExpvQHecE4Bz6An8K8f8E+NLCXTvOtLzThayK1rEba7V54SpD7jEcrtJPfP5V2Pg7Wb3xNKIH1BpoLcvO8wV";	ImgData += "SCC6+XGGK9cB+VxgcV3yy+FJTbexxutOTSsds1mLiJo5tjI3BUxggj+tZF/wDD6MSi78MyLYXa/wBxMRS+zp0/EVpxRqScGLHpuP6VLHGiHjy/oWNebGfQ6lKzOh/Zx+PWqfCLx/b39irx3dqfJvLRuftEJILR5PGGxlW7HH4/pl4O8WWXjvwvYax4clE9lqMKzxP3wex9CDkEdiC";	ImgData += "K/JvxNbNZCK/sFzLbgq+053RnqMfy9K+wP+CbfxNkN5qnhi7nMltdQDU7PcxO1htWRR2wQyNx3BNdeFq8suR7M4MdRTXtIn1tRRRXonlhRRRQAVmeM9H07XvC1/a+LdOi1fTpIG8+zkthci4UAkr5RB3k9hjk1p0UAfB3j3Uf2cvCfg8X3wc8OXmsa/Ddi3TT0vNQ0y4Cyt+8V3df";	ImgData += "lEYzhCMjaAMV83eLJLXUvHtu0AW2gV5HihaYyvCDkhd55YgcbiMnGa/R79qj9kzw78a/COoX9nYRWHiy0ia4stStQIZ3lQFgkrD/AFisRg7s4zkYNfnVqsKJ4qsMgiN4HZc4+/wcn8N1eDmilGcOx6eULllMejQk/JM2T7f/AFq4Xxr8Ivh14v8AiTE/jNIv+Eo1q3IiSLUJrW7voYV";	ImgData += "CvsWJl3gK6hsDptz0r0VQjj/WqB64HNfMf7YXw88b3/xU0rUPBc+v6jp85jTTRDeIv9n3jIwkSHygrwKyxqS7tgliMjIFGAi51LKfL5noVZW6XOE8S+G9A0PX28J/D/SNRk8X6f4kmtYdT+1AJdweYfIjVd2A4BRcsB8yMckHFeoeGPG9/onijUtN+K11ftrunktuidI55ZX2snmiP";	ImgData += "5W4b+DKtkHHUDpPg18BNA+Fvw81DUfGt/qj3fiPTUOpRXrxwS2wVfOaOIKd3mq4LBwxfcoIryL4hQ+F/BPhmd9J1i08Z6n4hMWpabqs9zPHq2mwsqsouVYFGdsEE7lfJ5Qbc179LEKremtV37nLKDWrPpfwh46Mt4dO8Yo9hfKBtEqhC+R0PYH8efrXTwa1YTXghhu4mmALbFIJ";	ImgData += "wOvavleLx3YafdXV7Nc+I/G2m2mireX19ZxNA2m3TcAXBfrEpGM9SeOcGt6z+IqfB/xz4Xi+Kxi0cNpw1i/NrDJLPbu28RwTKATI7DBLYAReOcZrKtgIO8loxwqtaH0sGgZWDvlSORtzn9K9B/Yf8Vjwh8cNBzIvlLqT6buZuNkqlQPblk/KuAjbGMTSPxuDAfeGOPrwa639k/Rv7";	ImgData += "W+PXh22RppIk1tHwWJACsXP6L3rx4StOPe5tWV6cvQ/TIdKKB0or3D58KKKKACvNP2o/GPxH8D/AA8kv/2b/DWleJ9Th3NPb3V0yTrGFJzbwgBZ3zj5Gkj9ixwp9Lo60Ezi5RaTsfl/4l/4Kz/EXxNLaJYX1t4Xu7Jfs95AunIEmmVjlmEwZomH3WjJ4I7civLdU8fXXiFmurxI";	ImgData += "WvUmNysiYQSFmJYYHABDN04r9EP2uP2EfCXxz07UNa0DwV4SvvGtzsVrvUbq609Z0HBMk1odxcL0Zlbpg8cj8qvF+z4TeM7zS/DuvaH4osLaR0eTSnmmtoXV2Voo5ZkRnKFSCwBB9c5rysdgp1kpKVzwZ5hjMmqqVSacX/W3+R7voNjL4igjfT45z5qhscZUehPSr0HhW51GZ008O";	ImgData += "CpAkDELt/MVs/DvSovD/gK0n00zzC8t47shm4JZQflHQf8A1qZomsSvrl0DHtWdgSc8jAxmuWtSo4SVNVm7vex9nh8ZUxFP2iXS55Z8efg7N8Xfh3c6BaTaRb3Ul1BKs2qacL2O32SAs0ahlMc23cEkB+RjkhhwfKv2a/2fNW8B2uoXXxo0Hw9HpF9ZXL3f23y5b/TGicrjOGjMUk";	ImgData += "QaXcrBlwueSQPSPjt8PPix8OfE+qeLPgzrVn430nWrsTTeGNWtkim01jGqn7DOjx7oiY93ludwLsQW6Dx7xbD8YPj4ttoXinwvrehaBqcci6ta2lpFYpH94Rxvd3Uz+bE3yM+xRxlcMa9ONKph17NTXI9fM3jUVZKVtThfgPpjfFTx/oUOhTWmlWN5dWkGpaRZSzxS31nbRmdrqdD";	ImgData += "lWVmRFbcf9ZKMDB57n4o/sa6zc/FWAfDsXeqabfWE+o3N9rt6JYTdpNn7JK6YlVZUcKrBW2hHyQQAfX/gl8Dbr4eS3msfEDVpvEfi7V4YYb+/OEijjiUKkMAAB2AKuWIyxAzgACvQVslznY/A6mTmprZlJVP3T02NVR7lb7DZ+CfDMEGjpLBYadClvbwLISsUagKiBmOcDgZJzgV73";	ImgData += "/wTe+HUmofFf+0b0rIdGt5buYk5/ezZjQfkZD+FeCWOmSeMNZt7fSoZZ4lkURouXM8hIC7R35OAO5PtX6OfstfA1fgf8OI7fUAjazqJFxqDqc7Wx8sQPcIOM9yWPeuTCxdarzPZGeNqezp8l9Wel0UUV7J4gUUUUAFFFFABX5y/8Fa/gj4P0r4taBq3hTSbfT/EGt281zqksDhYrs";	ImgData += "o8ao8sA48w5YGTgsBg5wCP0ar8yv8Agrd4qsvDv7QWoXmnXAmu4NItYJo3UoIZf3hRdx4I2urEjgc571y4xyVJqG70POzVQeHfOrnmn7PPxE0Wy8a3PhSXUmjuJYN1nay3BMEZUktHGHOFbBztHUA+ldl+0F4ll+Dvw4n8QaabVbmC6tlhiuVJjvd0gDRfLzym87h93GeQMH3b/";	ImgData += "gnH/wAE3j8PPAt7rP7TsHhTxTN4kEd3Z6TJZW2p29ipwwmN1JEWeVwR8qN5SjpuJLVj/tbf8EYLH4g6pqWt/s262PDzyW7SweG7x5DpIusrxbsCfscbLvyqoyq2CoALA0sFRnGKrLmkuplhni6eEslZvp1R8XfEz9s/UPGculR+C7FdDhtyzXSXLi5W4c4AGQF2oOefvHPbHPS+B";	ImgData += "/jvo/izUBY30htbxY/9a7NHBcMB83lluV9g3Jqbwr/wSW+MV18RItB8d+GLjR7a8trgW2t211b32mwXKxl4Rc7HEqwuVMZdY9ys6HaRmvMvEH7KvxQ+F2heJNa8aeE9c0KHwZdWsV7PdwSIiPNMY43gmA8udA6ruZGICujHg8XiMLHELXc5cPmGY4GfPJNx6prtv6ep7o";	ImgData += "PEUd0CNEjub6QDjys7M+7sAB+tavg34feIPiLrMOlWVvNd3tzhktbQFiwxzu9gepJC9ya+n/2Q/wBlLwp8cPgb4T8c+INQ1K6/4SPTor6S0gZYIoZCP3kZYAuSrhlPI5B6V9N+A/hX4d+GVm0PgTR7HTVcYkeKP95L/vucs34k15NLLarf7x2X4n20szg4p01ueTfso/scW3wdij1";	ImgData += "jx1Ha3Wv/AHoI0O+PT+MHB6PJyRuxgDhe5PvNFFexTpxpR5Y7HmVKkqsuaT1CiiirICiiigAooooA8T/b9/aL1f8AZf8A2epvE/gZdOOof2nZ2KtewtLDGssoViVV1JJGVHPBYHnpXyV+0Hqvw+/aq8ceGvjj4httYf4V6LdDSPEtg0KC9vtVjnghsbXyQxDQTG8+d94AWDa3Dn";	ImgData += "Gl+2J+yz+1R+0hf/EH4cXyeF9X+HXi3x3peu6D4jn8RJbXHhXSrae1mktPsaWe6Ukwz4BdyS+PMAYeVg+Mf+Cafx2u9K8WfBjwvbeAB8IvFPxO0/x7D4wm1+4XWNLtbe+s757L+yxa7ZZC9mY1f7QqhXyf7o6Y0oOKcrX33W2n49jKtRhXjyz23+4+sn/4KKfDfSvGd1os48QW+";	ImgData += "labra+GJdf/ALJkGhw6juCC1N0PlUhiq5ICgnGeKzNe/wCCnXgDQ/HRsfsPii78Mxa2nhqfxbbaf5uiRak0qxC388NlvnbBdVKgjuOa+evFf/BMz4qat+wN8VvhnbvoE/iDxR8X5vGmkvJrTiKTS5Nbhvdss32fMcnkLInlbGAICbyPmr4//aE+NEPwE+B3iz9mjwl8UPhD4j8O";	ImgData += "aZ8Rre402JddmtfiCk41mK7GnHQ5bUbgkybftKy/NFgovzqQ406cnZPrb5d/+AbWR+k/wt/4KQWkNpqmmfFmyuNV8Wr431PwvpWleHLEz3d7FbNu80wtJwEQ7WcsASOAOg9I8Qat4L/b4/ZS8W6bp82uyaDrtre6JqUFsHsdVspo8pLBtYbop1ZQACD1B5Br4d8X/wDBID4n3vxG174";	ImgData += "iafpXgPxJri+PdX1SDwzrXiO9ttO1/RbtFaEyXVtb+ZY3cM7SMFVJUKgAkk/L9r/sF/s33/7OHwNn07xnoHw98L+I9e1KfV9UtPBdtcJYRSyBUQNPdM0t5OsUcSPdOE8wpny0GFE1FBLmi9RNJqzPkT/gnf8AGHxL4S+HOgeEvgr8TfCWrato1+0mpfDnxGsdhr8UUlwzSLHK+0iRt";	ImgData += "zuEKbVPy5GCK+u/i5+27YfBjxvFYeMfBXjqHQv7WtdFl8RSWcUOnLc3DokQj8yVZJ0LSKpeNGUENycV8z/tD/sA/Hz9pTwwvw++MY+DPiq0gvFl0/4tzCXTvGOlRJcB45I7C3tPJ+1rEoTzY7iKNmy3lqPlpnxi/wCCTfxA+M/7Q/iHUfFeseDr/RNX8baV4osvFupXd9e+JtC02z";	ImgData += "ls5ZdFsLdx5FrHMbN1eSKRVZbh98bGrlyTknJ/1/XzCMVFWR7f8Rv+ConhT4dz67PN4S8b6hoeha5N4cfWba1gFjPfxcSQI7yg7gwZRkDJXjORmvff8FRdC8N2OrJ8QvBPi/w1rWhanpNjf6VqJto7iCLUZWit7jIkKldy8rndyMAk4ryLWf8Agl/8SvGP7Eni/wCHN7rXh7S9e1T";	ImgData += "4z3HxC0+6/tG4uYjpza4NQEMriFWWRod0WwBlXIG5hknov2uv+CW3iX9pP9o74n+LdG8TaNpen+NvCfhqz0wTxSyyafrGiatJqFvJNEpUSW8nmBW2uG4Iwc0oxovd/wBafpf7hqx6d+1B+2jB8NPiW3hXSrvUdEvPDt9oF3qV4LS3u7e7tNSuprVYSjuHUb4vmdcMOCu7DCvpAV8Ff";	ImgData += "G7/AIJn/Ff9ovUvH3i74l+J/BFp408Wf8Ina2VnphvE0uxt9E1KW+Ls7gyNLK9w4wFxhVBJHT70TIQeZjdjnHTNZVFFJcr1/wCAv+CGgtFFFZCCiiigAooooAKx5Ph5oE3iMaxNomkPq4YML1rKM3IIGAfN27s4460UUAbFFFFABRRRQAUUUUAFFFFABRRRQB//2Q==";			if (vAnScol !== null) {		vHtml = '<head> <meta charset="UTF-8"> </head> ';		vHtml += '<style> .break { page-break-after: always; } </style>';				facthst = ds.HistFact.query("Annee_Scolaire.ID = :1 and sMois = :2", vAnScol, vParaM);		if (facthst.length > 0) {						vCree = facthst[0].Date_Creation;			Nday = vCree.getDate();			Nday = ((Nday < 10) ? '0' : '') + Nday;			Nmonth = vCree.getMonth() + 1;			Nmonth = ((Nmonth < 10) ? '0' : '') + Nmonth; 			Nyear = vCree.getYear();			Nyear = ((Nyear < 200) ? 1900 : 0) + Nyear;			vlCree = Nday + '/' + Nmonth + '/' + Nyear; 						factures = ds.Factures.query("Annee_Scolaire.ID = :1 and Numero >= :2 and Numero <= :3 order by Numero", vAnScol, facthst[0].Ind_Deb, facthst[0].Ind_Fin);			factures.forEach(function (facture) {								if (facture.Famille.Relation_Pere_Mere === "Mariés") {					if (facture.Famille.Pere_Nom === null) {						vLibFam = "<B>Famille " + facture.Famille.Famille_Nom + "</B><BR>";					} else {						vLibFam = "<B>Mr ou Mme " + facture.Famille.Pere_Prenom + " " + facture.Famille.Pere_Nom + "</B><BR>";					}					if (facture.Famille.Pere_Adresse_1 !== null) {						vLibFam += facture.Famille.Pere_Adresse_1 + "<BR>";					}					if (facture.Famille.Pere_Adresse_2 !== null) {						vLibFam += facture.Famille.Pere_Adresse_2 + "<BR>";					}					if (facture.Famille.Pere_Adresse_CP !== null) {						vLibFam += facture.Famille.Pere_Adresse_CP + " " + ((facture.Famille.Pere_Adresse_Ville === null) ? ' ' : facture.Famille.Pere_Adresse_Ville)					}				} else {					if (facture.Famille.Autorite_Parentale === "Père") {						vLibFam = "<B>Mr " + facture.Famille.Pere_Prenom + " " + facture.Famille.Pere_Nom + "</B><BR>";						if (facture.Famille.Pere_Adresse_1 !== null) {							vLibFam += facture.Famille.Pere_Adresse_1 + "<BR>";						}						if (facture.Famille.Pere_Adresse_2 !== null) {							vLibFam += facture.Famille.Pere_Adresse_2 + "<BR>";						}						if (facture.Famille.Pere_Adresse_CP !== null) {							vLibFam += facture.Famille.Pere_Adresse_CP + " " + ((facture.Famille.Pere_Adresse_Ville === null) ? ' ' : facture.Famille.Pere_Adresse_Ville)						}					}					if (facture.Famille.Autorite_Parentale === "Mère") {						vLibFam = "<B>Mme " + facture.Famille.Mere_Prenom + " " + facture.Famille.Mere_Nom + "</B><BR>";						if (facture.Famille.Mere_Adresse_1 !== null) {							vLibFam += facture.Famille.Mere_Adresse_1 + "<BR>";						}						if (facture.Famille.Mere_Adresse_2 !== null) {							vLibFam += facture.Famille.Mere_Adresse_2 + "<BR>";						}						if (facture.Famille.Mere_Adresse_CP !== null) {							vLibFam += facture.Famille.Mere_Adresse_CP + " " + ((facture.Famille.Mere_Adresse_Ville === null) ? ' ' : facture.Famille.Mere_Adresse_Ville)						}					}					if (facture.Famille.Autorite_Parentale === "Autre") {						vLibFam = "<B>Famille " + facture.Famille.Famille_Nom + "</B><BR>";					}				}				vHtml += '<TABLE cellpadding="10px" cellspacing="2px" width=800 rules="all" style="border:solid 2px black; font-family:Calibri; font-size:12px; vertical-align: middle;">';				vHtml += '<TR><TD width=10% align=center"><IMG src="'+ImgData+'"</TD><TD width=25%>Ecole Française de Koh Samui<BR>143/1 Moo 4, Maret Lamai<BR>Koh Samui, 84310 Surathani<BR>Téléphone : 08 24 14 24 29</TD>';				vHtml += "<TD width=35% align=left><FONT SIZE=5 color=red><B>DUPLICATA<FONT SIZE=4 color=black><BR>Facture Mensuelle n° " + facture.Numero + "</B><BR>Mois de " + vParaLm + "<BR><FONT SIZE=2>Emise le " + vlCree;				vHtml += "</TD><TD width=30% align=left>" + vLibFam + "</TD></TR></TABLE><TABLE border=0><TR><TD height=15>&nbsp;</TD></TR></TABLE>";				vHtml += '<TABLE cellpadding="4px" cellspacing="3px" width=800 style="border:solid 1px black; font-family:Calibri; font-size:11px; vertical-align: middle;">';				vHtml += '<TR><TD COLSPAN=8></TD></TR>';				vHtml += '<TR><TD width=1%></TD><TD width=19% bgcolor=#CEF6F5 align=center><B>Eleve</B></TD><TD width=25% bgcolor=#CEF6F5 align=center><B>Article</B></TD><TD width=24% bgcolor=#CEF6F5 align=center><B>Détail</B></TD>';				vHtml += '<TD width=10% bgcolor=#CEF6F5 align=center><B>Qté</B></TD><TD width=10% bgcolor=#CEF6F5 align=center><B>Prix<BR>unitaire</B></TD><TD width=10% bgcolor=#CEF6F5 align=center><B>Total</B></TD><TD width=1%></TD></TR>'							factlines = ds.Lignes.query("Facture.ID = :1 order by ID", facture.ID);				factlines.forEach(function (factline) {					vHtml += '<TR><TD></TD><TD align=left>' + factline.Eleve.Nom_Complet + '</TD><TD align=left>' + factline.Article + '</TD><TD>' + factline.Detail + '</TD><TD align=center>' + factline.Quantite + '</TD><TD align=right>' +  factline.Prix_unitaire + ' THB</TD><TD align=right>' +  factline.Total_Ligne + ' THB</TD><TD></TD></TR>';					});								vHtml += '<TR><TD></TD><TD COLSPAN=6 bgcolor=#FFFFFF>&nbsp;</TD><TD></TD></TR>';					vHtml += '<TR><TD></TD><TD COLSPAN=5 align=right bgcolor=#CEF6F5><B>Total à payer</B></TD><TD align=right bgcolor=#CEF6F5><B>' +  facture.Total + ' THB</B></TD><TD></TD></TR>';					vHtml += '<TR><TD></TD><TD COLSPAN=6 bgcolor=#FFFFFF>&nbsp;</TD><TD></TD></TR>';					vHtml += '<TR><TD></TD><TD COLSPAN=6 bgcolor=#FFFFFF align=left><B>DUPLICATA</B> édité le ' + vlToday + ' pour faire valoir ce que de droit.</TD><TD></TD></TR>';											vHtml += '<TR><TD COLSPAN=8></TD></TR></TABLE>';				vHtml += '<P class="break">';				vHtml += '<TABLE width=800 border=0><TR><TD height=5 bgcolor=#FFFFFF>&nbsp;</TD></TR></TABLE><P>';			});		}					}		return vHtml;		}function FactExp(request, response) {			var vHtml, vToday, exportData, dNais, dtNais, vSect, vCar, vAnScol, AnScol, vLibAn, vMail, Nday, Nmonth, Nyear, vCoul, FactPar, vIndFact, vlToday, vlTrim,		vSexe, vAn, eleves, dDeb, dFin, vFam, vMoi, freres, vNbf, vLien, vNe, vDne, vUser, uParam, vUserName, vParaA, vParaM, vParaLm, ImgData, vLibFam, vTotal,		ListeMois = ["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"], vCree, vlCree ,		vNbCant, vNbAbs, vNbThai, vLibAbs, vLibCant, vLibThai, vtmpHtml, vHtml, Mtraite, Mpres, factlines, factline, factmaster, facthst, factprm, vCoul ;		vUser = currentUser();    vUserName = vUser.name;	uParam = ds.UserParam.query("Utilisateur.Login = :1", vUserName);	response.contentType = 'application/vnd.ms-excel';	vCoul = "#FFFFFF";		vToday = new Date();		Nday = vToday.getDate();	Nday = ((Nday < 10) ? '0' : '') + Nday;	Nmonth = vToday.getMonth() + 1;	Nmonth = ((Nmonth < 10) ? '0' : '') + Nmonth; 	Nyear = vToday.getYear();	Nyear = ((Nyear < 200) ? 1900 : 0) + Nyear; 	vlToday = Nday + '/' + Nmonth + '/' + Nyear;		vParaA = uParam[0].Annee_Scolaire;	vParaM = uParam[0].Mois;	vParaLm = uParam[0].LibMois;	Mtraite = ds.Calendrier.query("lMois = :1", vParaLm);	Mpres = Mtraite[0].dFin;	FactPar = ds.FactParam.query("ID > 0");	factprm = FactPar.first();	vIndFact = factprm.IndFact;	AnScol = ds.Annees_Scolaires.query("ID = :1", vParaA);	vAnScol = AnScol[0].ID;	vLibAn = AnScol[0].Annee_Scolaire;		if (vAnScol !== null) {		vHtml = '<head> <meta charset="UTF-8"> </head> ';		vHtml += '<TABLE cellspacing="2px" cellpadding="2px" cellspacing="1px" rules="all" style="border:solid 2px black; font-family:Calibri; font-size:12px; vertical-align: middle;">';		vHtml += "<TR><TD COLSPAN=8 height=50 align=CENTER><B><font size=5 >Lignes détail des factures du mois de "+vParaLm+"</B><BR>"		vHtml += "<font size=3 >Export eJungle ( "+vToday+" )</TD></TR>";		vHtml += '<TR><TD align=CENTER height=20 width=120 bgcolor="#0B0B61"><B><FONT color=#FFFFFF>N° facture</B></TD><TD align=CENTER width=150 bgcolor="#084B8A">';		vHtml += '<B><FONT color=#FFFFFF>Famille</B></TD><TD align=CENTER width=220 bgcolor="#0B0B61"><FONT color=#FFFFFF><B>Elève</B></TD>';		vHtml += '<TD align=CENTER width=230 bgcolor="#084B8A"><B><FONT color=#FFFFFF>Article</B></TD><TD align=CENTER width=250 bgcolor="#0B0B61"><B><FONT color=#FFFFFF>Détail</B></TD>';		vHtml += '<TD align=CENTER width=90 bgcolor="#084B8A"><B><FONT color=#FFFFFF>Qté</B></TD><TD align=CENTER width=120 bgcolor="#0B0B61"><B><FONT color=#FFFFFF>Prix. unitaire</B></TD>';		vHtml += '<TD align=CENTER width=120 bgcolor="#084B8A"><B><FONT color=#FFFFFF>Total Ligne</B></TD><TR>';						facthst = ds.HistFact.query("Annee_Scolaire.ID = :1 and sMois = :2", vAnScol, vParaM);		if (facthst.length > 0) {						vCree = facthst[0].Date_Creation;			Nday = vCree.getDate();			Nday = ((Nday < 10) ? '0' : '') + Nday;			Nmonth = vCree.getMonth() + 1;			Nmonth = ((Nmonth < 10) ? '0' : '') + Nmonth; 			Nyear = vCree.getYear();			Nyear = ((Nyear < 200) ? 1900 : 0) + Nyear;			vlCree = Nday + '/' + Nmonth + '/' + Nyear; 						factures = ds.Factures.query("Annee_Scolaire.ID = :1 and Numero >= :2 and Numero <= :3 order by Numero", vAnScol, facthst[0].Ind_Deb, facthst[0].Ind_Fin);			factures.forEach(function (facture) {								factlines = ds.Lignes.query("Facture.ID = :1 order by ID", facture.ID);				factlines.forEach(function (factline) {					if (vCoul === "#CEECF5") {						vCoul = "#FFFFFF";					} else {						vCoul = "#CEECF5";					}					vHtml += '<TR><TD align=left bgcolor="'+vCoul+'">' + facture.Numero + '</TD><TD align=left bgcolor="'+vCoul+'">'  + facture.Famille.Famille_Nom;					vHtml += '<TD align=left bgcolor="'+vCoul+'">' + factline.Eleve.Nom_Complet + '</TD><TD align=left bgcolor="'+vCoul+'">'  + factline.Article;					vHtml += '</TD><TD bgcolor="'+vCoul+'">'  + factline.Detail + '</TD><TD align=center bgcolor="'+vCoul+'">'  + factline.Quantite;					vHtml += '</TD><TD align=right bgcolor="'+vCoul+'">'  +  factline.Prix_unitaire + '</TD><TD align=right bgcolor="'+vCoul+'">'  +  factline.Total_Ligne;					vHtml += '</TD></TR>';					});							});			vHtml += '</TABLE>';		}					}		return vHtml;		}function FactAna(request, response) {			var vHtml, vToday, exportData, dNais, dtNais, vSect, vCar, vAnScol, AnScol, vLibAn, vMail, Nday, Nmonth, Nyear, vCoul, FactPar, vIndFact, vlToday, vlTrim,		vMfact, vMreg, eleves, dDeb, dFin, vFam, vMoi, freres, vNbf, vLien, vNe, vDne, vUser, uParam, vUserName, vParaA, vParaM, vParaLm, ImgData, vLibFam, vTotal,		ListeMois = ["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"], vCree, vlCree ,		vMois, vlMois, vHtml, Mtraite, Mpres, factregs, factreg, factmaster, facthst, factprm, vCoul, t2, t1, vDiff ;		vUser = currentUser();    vUserName = vUser.name;	uParam = ds.UserParam.query("Utilisateur.Login = :1", vUserName);	response.contentType = 'text/html';	vCoul = "#FFFFFF";		vToday = new Date();		Nday = vToday.getDate();	Nday = ((Nday < 10) ? '0' : '') + Nday;	Nmonth = vToday.getMonth() + 1;	Nmonth = ((Nmonth < 10) ? '0' : '') + Nmonth; 	Nyear = vToday.getYear();	Nyear = ((Nyear < 200) ? 1900 : 0) + Nyear; 	vlToday = Nday + '/' + Nmonth + '/' + Nyear;		vParaA = uParam[0].Annee_Scolaire;	AnScol = ds.Annees_Scolaires.query("ID = :1", vParaA);	vAnScol = AnScol[0].ID;	vParaM = uParam[0].Mois;	vLibAn = AnScol[0].Annee_Scolaire;		if (vAnScol !== null) {		vHtml = '<head> <meta charset="UTF-8"> </head> ';		vHtml += '<TABLE cellspacing="2px" cellpadding="2px" cellspacing="1px" rules="all" style="border:solid 2px black; font-family:Calibri; font-size:12px; vertical-align: middle;">';		vHtml += "<TR><TD COLSPAN=8 height=50 align=CENTER><B><font size=3 >Analyse des factures non réglées à ce jour</B><BR>Seuil de tolérance fixé à " + vParaM + " jour(s)</TD></TR>";		vHtml += '<TR><TD align=CENTER height=40 width=100 bgcolor="#0B0B61"><FONT color=#FFFFFF>N° facture</B></TD><TD align=CENTER width=250 bgcolor="#084B8A">';		vHtml += '<FONT color=#FFFFFF>Famille</B></TD><TD align=CENTER width=120 bgcolor="#0B0B61"><FONT color=#FFFFFF>Mois</B></TD>';		vHtml += '<TD align=CENTER width=120 bgcolor="#084B8A"><FONT color=#FFFFFF>Date émission<BR>facture</B></TD><TD align=CENTER width=120 bgcolor="#0B0B61"><FONT color=#FFFFFF>Montant<BR>facturé</B></TD>';		vHtml += '<TD align=CENTER width=120 bgcolor="#084B8A"><FONT color=#FFFFFF>Montant<BR>perçu</B></TD><TD align=CENTER width=120 bgcolor="#0B0B61"><FONT color=#FFFFFF>Reste à<BR>régler</TD>';		vHtml += '<TD align=CENTER width=120 bgcolor="#084B8A"><FONT color=#FFFFFF>Nb jours<BR>de retard</B></TD><TR>';						factures = ds.Factures.query("Annee_Scolaire.ID = :1 order by Numero", vAnScol);			factures.forEach(function (facture) {								vMreg = 0;				vMfact = facture.Total;				factregs = ds.Paiements.query("Fact_R1.ID = :1", facture.ID);				factregs.forEach(function (factreg) {					vMreg += factreg.Montant;				});				if (vCoul === "#CEECF5") {					vCoul = "#FFFFFF";				} else {					vCoul = "#CEECF5";				}								t2 = vToday.getTime();        		t1 = facture.Date_Creation.getTime();        		vDiff = parseInt((t2-t1)/(24*3600*1000));								if (vMfact !== vMreg && vDiff >= vParaM) {										vCree = facture.Date_Creation;					Nday = vCree.getDate();					Nday = ((Nday < 10) ? '0' : '') + Nday;					Nmonth = vCree.getMonth() + 1;					Nmonth = ((Nmonth < 10) ? '0' : '') + Nmonth; 					Nyear = vCree.getYear();					Nyear = ((Nyear < 200) ? 1900 : 0) + Nyear;					vlCree = Nday + '/' + Nmonth + '/' + Nyear; 										vMois = facture.Periode_Du;					Nday = vMois.getDate();					Nday = ((Nday < 10) ? '0' : '') + Nday;					Nmonth = vMois.getMonth() + 1;					Nmonth = ((Nmonth < 10) ? '0' : '') + Nmonth; 					Nyear = vMois.getYear();					Nyear = ((Nyear < 200) ? 1900 : 0) + Nyear;					vlMois = Nday + '/' + Nmonth + '/' + Nyear; 										vHtml += '<TR><TD align=left bgcolor="'+vCoul+'">' + facture.Numero + '</TD><TD align=left bgcolor="'+vCoul+'">'  + facture.Famille.Famille_Nom;					vHtml += '<TD align=center bgcolor="'+vCoul+'">' + vlMois + '</TD><TD align=center bgcolor="'+vCoul+'">'  + vlCree;					vHtml += '</TD><TD bgcolor="'+vCoul+'" align=right>'  + vMfact + '</TD><TD align=right bgcolor="'+vCoul+'">'  + vMreg;					vHtml += '</TD><TD bgcolor="'+vCoul+'" align=right>'  + (vMfact - vMreg) + '</TD><TD bgcolor="'+vCoul+'" align=right>'  + vDiff + '</TD></TR>';					}							});			vHtml += '</TABLE>';		}		return vHtml;		}function EdTClasse(request, response) {			var vHtml, vToday, exportData, dNais, dtNais, vSect, vCar, vAnScol, AnScol, vLibAn, vMail, Nday, Nmonth, Nyear, vCoul, FactPar, vIndFact, vlToday, vlTrim,		vSexe, vAn, eleves, dDeb, dFin, vFam, vMoi, freres, vNbf, vLien, vNe, vDne, vUser, uParam, vUserName, vParaA, vParaM, vParaLm, ImgData, vLibFam, vTotal,		LstJ = ["Lundi","Mardi","Mercredi","jeudi","Vendredi"], CptJG = [0,0,0,0,0], CptJD = [0,0,0,0,0],		LstH = ["8:00","8:15","8:30","8:45","9:00","9:15","9:30","9:45","10:00","10:15","10:30","10:45","11:00","11:15","11:30","11:45","12:00","12:15","12:30","12:45","13:00","13:15","13:30","13:45","14:00","14:15","14:30","14:45","15:00","15:15","15:30","15:45","16:00","16:15","16:30","16:45","17:00","17:15","17:30","17:45","18:00"],		vNbCant, vNbAbs, vNbThai, vLibAbs, vLibCant, vLibThai, vtmpHtml, vHtml, Mtraite, Mpres, planMats, planMat, j, k, planActs, planAct,		vCoul, vMat, vSalle, vHoraire, vDuree, vFlag ;		vUser = currentUser();    vUserName = vUser.name;	uParam = ds.UserParam.query("Utilisateur.Login = :1", vUserName);	if (uParam[0].Preview) {		response.contentType = 'text/html';	} else {		response.contentType = 'application/vnd.ms-excel';	}		vToday = new Date();		Nday = vToday.getDate();	Nday = ((Nday < 10) ? '0' : '') + Nday;	Nmonth = vToday.getMonth() + 1;	Nmonth = ((Nmonth < 10) ? '0' : '') + Nmonth; 	Nyear = vToday.getYear();	Nyear = ((Nyear < 200) ? 1900 : 0) + Nyear; 	vlToday = Nday + '/' + Nmonth + '/' + Nyear;		vParaA = uParam[0].Annee_Scolaire;	vParaM = uParam[0].Mois;	vParaLm = uParam[0].LibMois;	Mtraite = ds.Calendrier.query("lMois = :1", vParaLm);	Mpres = Mtraite[0].dFin;	FactPar = ds.FactParam.query("ID > 0");	factprm = FactPar.first();	vIndFact = factprm.IndFact;	AnScol = ds.Annees_Scolaires.query("ID = :1", vParaA);	vAnScol = AnScol[0].ID;	vLibAn = AnScol[0].Annee_Scolaire;		ImgData = "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/4gxYSUNDX1BST0ZJTEUAAQEAAAxITGlubwIQAABtbnRyUkdCIFhZWiAHzgACAAkABgAxAABhY3NwTVNGVAAAAABJRUMgc1";	ImgData += "JHQgAAAAAAAAAAAAAAAAAA9tYAAQAAAADTLUhQICAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABFjcHJ0AAABUAAAADNkZXNjAAABhAAAAGx3dHB0AAAB8AAAABRia3B0AAACBAAAABRyWF";	ImgData += "laAAACGAAAABRnWFlaAAACLAAAABRiWFlaAAACQAAAABRkbW5kAAACVAAAAHBkbWRkAAACxAAAAIh2dWVkAAADTAAAAIZ2aWV3AAAD1AAAACRsdW1pAAAD+AAAABRtZWFzAAAEDAAAACR0ZWNoAAAEMAAAAAxyVFJDAAAEPAAACAxnVFJ";	ImgData += "DAAAEPAAACAxiVFJDAAAEPAAACAx0ZXh0AAAAAENvcHlyaWdodCAoYykgMTk5OCBIZXdsZXR0LVBhY2thcmQgQ29tcGFueQAAZGVzYwAAAAAAAAASc1JHQiBJRUM2MTk2Ni0yLjEAAAAAAAAAAAAAABJzUkdCIElFQzYxOTY2LTIuMQAAAAAAAAAAAAAA";	ImgData += "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWFlaIAAAAAAAAPNRAAEAAAABFsxYWVogAAAAAAAAAAAAAAAAAAAAAFhZWiAAAAAAAABvogAAOPUAAAOQWFlaIAAAAAAAAGKZAAC3hQAAGNpYWVogAAAAAAAAJKAAAA+EAAC2z2Rlc2MAAAAAAAAAF";	ImgData += "klFQyBodHRwOi8vd3d3LmllYy5jaAAAAAAAAAAAAAAAFklFQyBodHRwOi8vd3d3LmllYy5jaAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABkZXNjAAAAAAAAAC5JRUMgNjE5NjYtMi4xIERlZmF1bHQgUkdCIGNvbG91ciBzcGFjZSAt";	ImgData += "IHNSR0IAAAAAAAAAAAAAAC5JRUMgNjE5NjYtMi4xIERlZmF1bHQgUkdCIGNvbG91ciBzcGFjZSAtIHNSR0IAAAAAAAAAAAAAAAAAAAAAAAAAAAAAZGVzYwAAAAAAAAAsUmVmZXJlbmNlIFZpZXdpbmcgQ29uZGl0aW9uIGluIElFQzYxOTY2LTIuMQAAAAAA";	ImgData += "AAAAAAAALFJlZmVyZW5jZSBWaWV3aW5nIENvbmRpdGlvbiBpbiBJRUM2MTk2Ni0yLjEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHZpZXcAAAAAABOk/gAUXy4AEM8UAAPtzAAEEwsAA1yeAAAAAVhZWiAAAAAAAEwJVgBQAAAAVx/nbWVhcwAAAAAAAAAB";	ImgData += "AAAAAAAAAAAAAAAAAAAAAAAAAo8AAAACc2lnIAAAAABDUlQgY3VydgAAAAAAAAQAAAAABQAKAA8AFAAZAB4AIwAoAC0AMgA3ADsAQABFAEoATwBUAFkAXgBjAGgAbQByAHcAfACBAIYAiwCQAJUAmgCfAKQAqQCuALIAtwC8AMEAxgDLANAA1QDbAOAA5Q";	ImgData += "DrAPAA9gD7AQEBBwENARMBGQEfASUBKwEyATgBPgFFAUwBUgFZAWABZwFuAXUBfAGDAYsBkgGaAaEBqQGxAbkBwQHJAdEB2QHhAekB8gH6AgMCDAIUAh0CJgIvAjgCQQJLAlQCXQJnAnECegKEAo4CmAKiAqwCtgLBAssC1QLgAusC9QMAAwsDFgMhAy0DOANDA08";	ImgData += "DWgNmA3IDfgOKA5YDogOuA7oDxwPTA+AD7AP5BAYEEwQgBC0EOwRIBFUEYwRxBH4EjASaBKgEtgTEBNME4QTwBP4FDQUcBSsFOgVJBVgFZwV3BYYFlgWmBbUFxQXVBeUF9gYGBhYGJwY3BkgGWQZqBnsGjAadBq8GwAbRBuMG9QcHBxkHKwc9B08HYQd0B4YHmQes";	ImgData += "B78H0gflB/gICwgfCDIIRghaCG4IggiWCKoIvgjSCOcI+wkQCSUJOglPCWQJeQmPCaQJugnPCeUJ+woRCicKPQpUCmoKgQqYCq4KxQrcCvMLCwsiCzkLUQtpC4ALmAuwC8gL4Qv5DBIMKgxDDFwMdQyODKcMwAzZDPMNDQ0mDUANWg10DY4NqQ3DDd4N+A4TDi4OSQ5";	ImgData += "kDn8Omw62DtIO7g8JDyUPQQ9eD3oPlg+zD88P7BAJECYQQxBhEH4QmxC5ENcQ9RETETERTxFtEYwRqhHJEegSBxImEkUSZBKEEqMSwxLjEwMTIxNDE2MTgxOkE8UT5RQGFCcUSRRqFIsUrRTOFPAVEhU0FVYVeBWbFb0V4BYDFiYWSRZsFo8WshbWFvoXHRdBF2UXiReu";	ImgData += "F9IX9xgbGEAYZRiKGK8Y1Rj6GSAZRRlrGZEZtxndGgQaKhpRGncanhrFGuwbFBs7G2MbihuyG9ocAhwqHFIcexyjHMwc9R0eHUcdcB2ZHcMd7B4WHkAeah6UHr4e6R8THz4faR+UH78f6iAVIEEgbCCYIMQg8CEcIUghdSGhIc4h+yInIlUigiKvIt0jCiM4I2YjlCPCI";	ImgData += "/AkHyRNJHwkqyTaJQklOCVoJZclxyX3JicmVyaHJrcm6CcYJ0kneierJ9woDSg/KHEooijUKQYpOClrKZ0p0CoCKjUqaCqbKs8rAis2K2krnSvRLAUsOSxuLKIs1y0MLUEtdi2rLeEuFi5MLoIuty7uLyQvWi+RL8cv/jA1MGwwpDDbMRIxSjGCMbox8jIqMmMymzLUMw0z";	ImgData += "RjN/M7gz8TQrNGU0njTYNRM1TTWHNcI1/TY3NnI2rjbpNyQ3YDecN9c4FDhQOIw4yDkFOUI5fzm8Ofk6Njp0OrI67zstO2s7qjvoPCc8ZTykPOM9Ij1hPaE94D4gPmA+oD7gPyE/YT+iP+JAI0BkQKZA50EpQWpBrEHuQjBCckK1QvdDOkN9Q8BEA0RHRIpEzkUSRVVFmk";	ImgData += "XeRiJGZ0arRvBHNUd7R8BIBUhLSJFI10kdSWNJqUnwSjdKfUrESwxLU0uaS+JMKkxyTLpNAk1KTZNN3E4lTm5Ot08AT0lPk0/dUCdQcVC7UQZRUFGbUeZSMVJ8UsdTE1NfU6pT9lRCVI9U21UoVXVVwlYPVlxWqVb3V0RXklfgWC9YfVjLWRpZaVm4WgdaVlqmWvVbRVuVW+";	ImgData += "VcNVyGXNZdJ114XcleGl5sXr1fD19hX7NgBWBXYKpg/GFPYaJh9WJJYpxi8GNDY5dj62RAZJRk6WU9ZZJl52Y9ZpJm6Gc9Z5Nn6Wg/aJZo7GlDaZpp8WpIap9q92tPa6dr/2xXbK9tCG1gbbluEm5rbsRvHm94b9FwK3CGcOBxOnGVcfByS3KmcwFzXXO4dBR0cHTMdSh1h";	ImgData += "XXhdj52m3b4d1Z3s3gReG54zHkqeYl553pGeqV7BHtje8J8IXyBfOF9QX2hfgF+Yn7CfyN/hH/lgEeAqIEKgWuBzYIwgpKC9INXg7qEHYSAhOOFR4Wrhg6GcobXhzuHn4gEiGmIzokziZmJ/opkisqLMIuWi/yMY4zKjTGNmI3/jmaOzo82j56QBpBukNaRP5GokhGSepLj";	ImgData += "k02TtpQglIqU9JVflcmWNJaflwqXdZfgmEyYuJkkmZCZ/JpomtWbQpuvnByciZz3nWSd0p5Anq6fHZ+Ln/qgaaDYoUehtqImopajBqN2o+akVqTHpTilqaYapoum/adup+CoUqjEqTepqaocqo+rAqt1q+msXKzQrUStuK4trqGvFq+LsACwdbDqsWCx1rJLssKzOLOutC";	ImgData += "W0nLUTtYq2AbZ5tvC3aLfguFm40blKucK6O7q1uy67p7whvJu9Fb2Pvgq+hL7/v3q/9cBwwOzBZ8Hjwl/C28NYw9TEUcTOxUvFyMZGxsPHQce/yD3IvMk6ybnKOMq3yzbLtsw1zLXNNc21zjbOts83z7jQOdC60TzRvtI/0sHTRNPG1EnUy9VO1dHWVdbY11zX4Nhk2Oj";	ImgData += "ZbNnx2nba+9uA3AXcit0Q3ZbeHN6i3ynfr+A24L3hROHM4lPi2+Nj4+vkc+T85YTmDeaW5x/nqegy6LzpRunQ6lvq5etw6/vshu0R7ZzuKO6070DvzPBY8OXxcvH/8ozzGfOn9DT0wvVQ9d72bfb794r4Gfio+Tj5x/pX+uf7d/wH/Jj9Kf26/kv+3P9t////4QMcRXhpZg";	ImgData += "AATU0AKgAAAAgACAEPAAIAAAAWAAAAbgEQAAIAAAAiAAAAhAESAAMAAAABAAEAAAEaAAUAAAABAAAApgEbAAUAAAABAAAArgEoAAMAAAABAAIAAAEyAAIAAAAUAAAAtodpAAQAAAABAAAAygAAAABFQVNUTUFOIEtPREFLIENPTVBBTlkAS09EQUsgUExBWVNQT1JUIFZpZ";	ImgData += "GVvIENhbWVyYSwgWng1AAAAAEgAAAABAAAASAAAAAEyMDE0OjA3OjI3IDA3OjE1OjI0AAAlgpoABQAAAAEAAAKMgp0ABQAAAAEAAAKUiCIAAwAAAAEAAgAAiCcAAwAAAAEAfQAAkAAABwAAAAQwMjMwkAMAAgAAABQAAAKckAQAAgAAABQAAAKwkQEABwAAAAQBAgMAkQIABQ";	ImgData += "AAAAEAAALEkgEACgAAAAEAAALMkgIABQAAAAEAAALUkgMACgAAAAEAAALckgQACgAAAAEAAALkkgUABQAAAAEAAALskgcAAwAAAAEABQAAkggAAwAAAAEAAAAAkgkAAwAAAAEAIAAAkgoABQAAAAEAAAL0khUABQAAAAEAAAL8oAAABwAAAAQwMTAwoAEAAwAAAAEAAQAAoAI";	ImgData += "ABAAAAAEAAABxoAMABAAAAAEAAABkohUABQAAAAEAAAMEohcAAwAAAAEAAgAAowAABwAAAAEDAAAApAEAAwAAAAEAAAAApAIAAwAAAAEAAAAApAMAAwAAAAEAAAAApAQABQAAAAEAAAMMpAUAAwAAAAEAIQAApAYAAwAAAAEAAAAApAcAAwAAAAEAAQAApAgAAwAAAAEAAAAA";	ImgData += "pAkAAwAAAAEAAAAApAoAAwAAAAEAAAAApAwAAwAAAAEAAAAAAAAAAAAAAAEAAAFAAAAADgAAAAUyMDE0OjA3OjI3IDA3OjE1OjI0ADIwMTQ6MDc6MjcgMDc6MTU6MjQAAAAuVwAAFlsAAAAZAAAAAwAAAAMAAAABAAAABwAAAAEAAAAAAAAAAQAAAAMAAAABAAAAJwAAAAoAAA";	ImgData += "B9AAAAAQAAAH0AAAABAAAAAAAAAAH/4QJ3aHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA1LjEuMiI+CiAgIDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vc";	ImgData += "mcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+CiAgICAgIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICAgICAgICAgIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyI+CiAgICAgICAgIDx4bXA6Q3JlYXRlRGF0ZT4yMDE0LTA3LTI3VDA";	ImgData += "3OjE1OjI0PC94bXA6Q3JlYXRlRGF0ZT4KICAgICAgICAgPHhtcDpNb2RpZnlEYXRlPjIwMTQtMDctMjdUMDc6MTU6MjQ8L3htcDpNb2RpZnlEYXRlPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgI";	ImgData += "CAgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIj4KICAgICAgICAgPHBob3Rvc2hvcDpEYXRlQ3JlYXRlZD4yMDE0LTA3LTI3VDA3OjE1OjI0PC9waG90b3Nob3A6RGF0ZUNyZWF0ZWQ+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogI";	ImgData += "CA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgr/2wBDAAIBAQIBAQICAQICAgICAwUDAwMDAwYEBAMFBwYHBwcGBgYHCAsJBwgKCAYGCQ0JCgsLDAwMBwkNDg0MDgsMDAv/2wBDAQICAgMCAwUDAwULCAYICwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsL";	ImgData += "CwsLCwv/wAARCABkAHEDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc";	ImgData += "3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEK";	ImgData += "RobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD9/KKKKA";	ImgData += "Cisb4h+Ln8B+CdU1mDTNQ1k6ZbtcmysED3Nwq8lYlJAZsZIXPOMCsTwx8bvDnxR+H8Gr/DjxDpRXVbZmsnuXCGOTBAEsLFXUq/DIcMCCODQK62O0zmjNeC+M/j7a/se/DSGw+J3ia88d+M7tWu/wB4qQeaXPXag229uuMKPmY4ONxya+Lvj1+3p4n8fatIPEOtSwWUuWTStPlaCON";	ImgData += "ewIU7pPq5OewFctbFwpPl3fY7MPg6mJ1S0P0yHxF8PnWE04a5o/8AaEj+Wlt9sj85m/uhN2SfbFchqX7Xfw60fxBeaZqnie0gvLCZoJ1aKXajqcMu8LtOCCOD2r8rbLxL4u1aYXHh7SodLjJzHLcyiNvqAAWFTwXvjKOVw+n2UkoHzS/aNsb85BXuTyeoFYrFzl9lfedn9lpbzP11";	ImgData += "8I/FLw54+bb4L13StUcLvKW10kjhfUqDkflW9X4/aZ8R/EHhS8STxDp89ooYAXcD7hHn/poh3D9K+iv2bv2+dW8DCG18U3MniHQy53rNKXurfP8AzzlY8gcfK3B5wRWyxKXxqxz1cvnBXjqfe9Fc/wDDn4paF8V9DGoeA9Rhv4AQsgXh4WwDtdDyrAEcGugrpTvqjgatuFFFFMAo";	ImgData += "oooAKKDyK870C78c+F/iPrUvxW1fwlJ4Luo0GlzQxtZ3VpNnbskEjMsm8HOQ33hwMHATYm7Hn3xp/aHv/hX+0VJp2m+L/DVlajSoby40LxSTp1vdKzOvn2GoqrbWXZiSKRGB4KlcknzvUPjtf+GL5fG3x0+GXwt1Hw3rcTjSdT0KaK9ur6dSWRvNnjRniIVsuE4+UjOa5e9/astL";	ImgData += "b4o3r+PbTSvi9o0d3MLO31HTre01vw7co2xowrr5UkDbSRIhIJ54PB8z/bO/aOl+N2v2F/8A2ZNo6Wtp9gttP+0LKYjuJZgygDJ+ToOAgrgxeL9lTbg9b6GuBofXK3LfRHmXxQ+JGu/G7x7ez3Nzi4upDJNJgtFZRkkrHGvRQoOFUcDr1JrO0nStA0CdraCOGS5if95cSxb3Z/UvV";	ImgData += "3wno0ek6OiSeUJmy8pJO5mPr614x8QvGcOlfFLWtKtLuIRQXAklRdxfDKrso54HJyfSubLMPHFVHGbd7bn0Neo6MeWnsj6BgkiktzLHJG6ICSQOn1zU6OVEZuB5XnExpvQHecE4Bz6An8K8f8E+NLCXTvOtLzThayK1rEba7V54SpD7jEcrtJPfP5V2Pg7Wb3xNKIH1BpoLcvO8wV";	ImgData += "SCC6+XGGK9cB+VxgcV3yy+FJTbexxutOTSsds1mLiJo5tjI3BUxggj+tZF/wDD6MSi78MyLYXa/wBxMRS+zp0/EVpxRqScGLHpuP6VLHGiHjy/oWNebGfQ6lKzOh/Zx+PWqfCLx/b39irx3dqfJvLRuftEJILR5PGGxlW7HH4/pl4O8WWXjvwvYax4clE9lqMKzxP3wex9CDkEdiC";	ImgData += "K/JvxNbNZCK/sFzLbgq+053RnqMfy9K+wP+CbfxNkN5qnhi7nMltdQDU7PcxO1htWRR2wQyNx3BNdeFq8suR7M4MdRTXtIn1tRRRXonlhRRRQAVmeM9H07XvC1/a+LdOi1fTpIG8+zkthci4UAkr5RB3k9hjk1p0UAfB3j3Uf2cvCfg8X3wc8OXmsa/Ddi3TT0vNQ0y4Cyt+8V3df";	ImgData += "lEYzhCMjaAMV83eLJLXUvHtu0AW2gV5HihaYyvCDkhd55YgcbiMnGa/R79qj9kzw78a/COoX9nYRWHiy0ia4stStQIZ3lQFgkrD/AFisRg7s4zkYNfnVqsKJ4qsMgiN4HZc4+/wcn8N1eDmilGcOx6eULllMejQk/JM2T7f/AFq4Xxr8Ivh14v8AiTE/jNIv+Eo1q3IiSLUJrW7voYV";	ImgData += "CvsWJl3gK6hsDptz0r0VQjj/WqB64HNfMf7YXw88b3/xU0rUPBc+v6jp85jTTRDeIv9n3jIwkSHygrwKyxqS7tgliMjIFGAi51LKfL5noVZW6XOE8S+G9A0PX28J/D/SNRk8X6f4kmtYdT+1AJdweYfIjVd2A4BRcsB8yMckHFeoeGPG9/onijUtN+K11ftrunktuidI55ZX2snmiP";	ImgData += "5W4b+DKtkHHUDpPg18BNA+Fvw81DUfGt/qj3fiPTUOpRXrxwS2wVfOaOIKd3mq4LBwxfcoIryL4hQ+F/BPhmd9J1i08Z6n4hMWpabqs9zPHq2mwsqsouVYFGdsEE7lfJ5Qbc179LEKremtV37nLKDWrPpfwh46Mt4dO8Yo9hfKBtEqhC+R0PYH8efrXTwa1YTXghhu4mmALbFIJ";	ImgData += "wOvavleLx3YafdXV7Nc+I/G2m2mireX19ZxNA2m3TcAXBfrEpGM9SeOcGt6z+IqfB/xz4Xi+Kxi0cNpw1i/NrDJLPbu28RwTKATI7DBLYAReOcZrKtgIO8loxwqtaH0sGgZWDvlSORtzn9K9B/Yf8Vjwh8cNBzIvlLqT6buZuNkqlQPblk/KuAjbGMTSPxuDAfeGOPrwa639k/Rv7";	ImgData += "W+PXh22RppIk1tHwWJACsXP6L3rx4StOPe5tWV6cvQ/TIdKKB0or3D58KKKKACvNP2o/GPxH8D/AA8kv/2b/DWleJ9Th3NPb3V0yTrGFJzbwgBZ3zj5Gkj9ixwp9Lo60Ezi5RaTsfl/4l/4Kz/EXxNLaJYX1t4Xu7Jfs95AunIEmmVjlmEwZomH3WjJ4I7civLdU8fXXiFmurxI";	ImgData += "WvUmNysiYQSFmJYYHABDN04r9EP2uP2EfCXxz07UNa0DwV4SvvGtzsVrvUbq609Z0HBMk1odxcL0Zlbpg8cj8qvF+z4TeM7zS/DuvaH4osLaR0eTSnmmtoXV2Voo5ZkRnKFSCwBB9c5rysdgp1kpKVzwZ5hjMmqqVSacX/W3+R7voNjL4igjfT45z5qhscZUehPSr0HhW51GZ008O";	ImgData += "CpAkDELt/MVs/DvSovD/gK0n00zzC8t47shm4JZQflHQf8A1qZomsSvrl0DHtWdgSc8jAxmuWtSo4SVNVm7vex9nh8ZUxFP2iXS55Z8efg7N8Xfh3c6BaTaRb3Ul1BKs2qacL2O32SAs0ahlMc23cEkB+RjkhhwfKv2a/2fNW8B2uoXXxo0Hw9HpF9ZXL3f23y5b/TGicrjOGjMUk";	ImgData += "QaXcrBlwueSQPSPjt8PPix8OfE+qeLPgzrVn430nWrsTTeGNWtkim01jGqn7DOjx7oiY93ludwLsQW6Dx7xbD8YPj4ttoXinwvrehaBqcci6ta2lpFYpH94Rxvd3Uz+bE3yM+xRxlcMa9ONKph17NTXI9fM3jUVZKVtThfgPpjfFTx/oUOhTWmlWN5dWkGpaRZSzxS31nbRmdrqdD";	ImgData += "lWVmRFbcf9ZKMDB57n4o/sa6zc/FWAfDsXeqabfWE+o3N9rt6JYTdpNn7JK6YlVZUcKrBW2hHyQQAfX/gl8Dbr4eS3msfEDVpvEfi7V4YYb+/OEijjiUKkMAAB2AKuWIyxAzgACvQVslznY/A6mTmprZlJVP3T02NVR7lb7DZ+CfDMEGjpLBYadClvbwLISsUagKiBmOcDgZJzgV73";	ImgData += "/wTe+HUmofFf+0b0rIdGt5buYk5/ezZjQfkZD+FeCWOmSeMNZt7fSoZZ4lkURouXM8hIC7R35OAO5PtX6OfstfA1fgf8OI7fUAjazqJFxqDqc7Wx8sQPcIOM9yWPeuTCxdarzPZGeNqezp8l9Wel0UUV7J4gUUUUAFFFFABX5y/8Fa/gj4P0r4taBq3hTSbfT/EGt281zqksDhYrs";	ImgData += "o8ao8sA48w5YGTgsBg5wCP0ar8yv8Agrd4qsvDv7QWoXmnXAmu4NItYJo3UoIZf3hRdx4I2urEjgc571y4xyVJqG70POzVQeHfOrnmn7PPxE0Wy8a3PhSXUmjuJYN1nay3BMEZUktHGHOFbBztHUA+ldl+0F4ll+Dvw4n8QaabVbmC6tlhiuVJjvd0gDRfLzym87h93GeQMH3b/";	ImgData += "gnH/wAE3j8PPAt7rP7TsHhTxTN4kEd3Z6TJZW2p29ipwwmN1JEWeVwR8qN5SjpuJLVj/tbf8EYLH4g6pqWt/s262PDzyW7SweG7x5DpIusrxbsCfscbLvyqoyq2CoALA0sFRnGKrLmkuplhni6eEslZvp1R8XfEz9s/UPGculR+C7FdDhtyzXSXLi5W4c4AGQF2oOefvHPbHPS+B";	ImgData += "/jvo/izUBY30htbxY/9a7NHBcMB83lluV9g3Jqbwr/wSW+MV18RItB8d+GLjR7a8trgW2t211b32mwXKxl4Rc7HEqwuVMZdY9ys6HaRmvMvEH7KvxQ+F2heJNa8aeE9c0KHwZdWsV7PdwSIiPNMY43gmA8udA6ruZGICujHg8XiMLHELXc5cPmGY4GfPJNx6prtv6ep7o";	ImgData += "PEUd0CNEjub6QDjys7M+7sAB+tavg34feIPiLrMOlWVvNd3tzhktbQFiwxzu9gepJC9ya+n/2Q/wBlLwp8cPgb4T8c+INQ1K6/4SPTor6S0gZYIoZCP3kZYAuSrhlPI5B6V9N+A/hX4d+GVm0PgTR7HTVcYkeKP95L/vucs34k15NLLarf7x2X4n20szg4p01ueTfso/scW3wdij1";	ImgData += "jx1Ha3Wv/AHoI0O+PT+MHB6PJyRuxgDhe5PvNFFexTpxpR5Y7HmVKkqsuaT1CiiirICiiigAooooA8T/b9/aL1f8AZf8A2epvE/gZdOOof2nZ2KtewtLDGssoViVV1JJGVHPBYHnpXyV+0Hqvw+/aq8ceGvjj4httYf4V6LdDSPEtg0KC9vtVjnghsbXyQxDQTG8+d94AWDa3Dn";	ImgData += "Gl+2J+yz+1R+0hf/EH4cXyeF9X+HXi3x3peu6D4jn8RJbXHhXSrae1mktPsaWe6Ukwz4BdyS+PMAYeVg+Mf+Cafx2u9K8WfBjwvbeAB8IvFPxO0/x7D4wm1+4XWNLtbe+s757L+yxa7ZZC9mY1f7QqhXyf7o6Y0oOKcrX33W2n49jKtRhXjyz23+4+sn/4KKfDfSvGd1os48QW+";	ImgData += "labra+GJdf/ALJkGhw6juCC1N0PlUhiq5ICgnGeKzNe/wCCnXgDQ/HRsfsPii78Mxa2nhqfxbbaf5uiRak0qxC388NlvnbBdVKgjuOa+evFf/BMz4qat+wN8VvhnbvoE/iDxR8X5vGmkvJrTiKTS5Nbhvdss32fMcnkLInlbGAICbyPmr4//aE+NEPwE+B3iz9mjwl8UPhD4j8O";	ImgData += "aZ8Rre402JddmtfiCk41mK7GnHQ5bUbgkybftKy/NFgovzqQ406cnZPrb5d/+AbWR+k/wt/4KQWkNpqmmfFmyuNV8Wr431PwvpWleHLEz3d7FbNu80wtJwEQ7WcsASOAOg9I8Qat4L/b4/ZS8W6bp82uyaDrtre6JqUFsHsdVspo8pLBtYbop1ZQACD1B5Br4d8X/wDBID4n3vxG174";	ImgData += "iafpXgPxJri+PdX1SDwzrXiO9ttO1/RbtFaEyXVtb+ZY3cM7SMFVJUKgAkk/L9r/sF/s33/7OHwNn07xnoHw98L+I9e1KfV9UtPBdtcJYRSyBUQNPdM0t5OsUcSPdOE8wpny0GFE1FBLmi9RNJqzPkT/gnf8AGHxL4S+HOgeEvgr8TfCWrato1+0mpfDnxGsdhr8UUlwzSLHK+0iRt";	ImgData += "zuEKbVPy5GCK+u/i5+27YfBjxvFYeMfBXjqHQv7WtdFl8RSWcUOnLc3DokQj8yVZJ0LSKpeNGUENycV8z/tD/sA/Hz9pTwwvw++MY+DPiq0gvFl0/4tzCXTvGOlRJcB45I7C3tPJ+1rEoTzY7iKNmy3lqPlpnxi/wCCTfxA+M/7Q/iHUfFeseDr/RNX8baV4osvFupXd9e+JtC02z";	ImgData += "ls5ZdFsLdx5FrHMbN1eSKRVZbh98bGrlyTknJ/1/XzCMVFWR7f8Rv+ConhT4dz67PN4S8b6hoeha5N4cfWba1gFjPfxcSQI7yg7gwZRkDJXjORmvff8FRdC8N2OrJ8QvBPi/w1rWhanpNjf6VqJto7iCLUZWit7jIkKldy8rndyMAk4ryLWf8Agl/8SvGP7Eni/wCHN7rXh7S9e1T";	ImgData += "4z3HxC0+6/tG4uYjpza4NQEMriFWWRod0WwBlXIG5hknov2uv+CW3iX9pP9o74n+LdG8TaNpen+NvCfhqz0wTxSyyafrGiatJqFvJNEpUSW8nmBW2uG4Iwc0oxovd/wBafpf7hqx6d+1B+2jB8NPiW3hXSrvUdEvPDt9oF3qV4LS3u7e7tNSuprVYSjuHUb4vmdcMOCu7DCvpAV8Ff";	ImgData += "G7/AIJn/Ff9ovUvH3i74l+J/BFp408Wf8Ina2VnphvE0uxt9E1KW+Ls7gyNLK9w4wFxhVBJHT70TIQeZjdjnHTNZVFFJcr1/wCAv+CGgtFFFZCCiiigAooooAKx5Ph5oE3iMaxNomkPq4YML1rKM3IIGAfN27s4460UUAbFFFFABRRRQAUUUUAFFFFABRRRQB//2Q==";			if (vAnScol !== null) {		vHtml = '<head> <meta charset="UTF-8"> </head> ';		vHtml += '<style> .break { page-break-after: always; } </style>';				planMats = ds.Planning_Matiere.query("Annee_Scolaire.ID = :1 order by Ordre", vAnScol, vParaM);		planMats.forEach(function (planMat) {						CptJG = [0,0,0,0,0];			CptJD = [0,0,0,0,0];			vFlag = 0;						vtmpHtml = '<TABLE cellpadding="10px" cellspacing="2px" width=800 rules="all" style="border:solid 2px black; font-family:Calibri; font-size:12px; vertical-align: middle;">';			vtmpHtml += '<TR><TD width=10% align=center"><IMG src="'+ImgData+'"</TD><TD width=25%>Ecole Française de Koh Samui<BR>143/1 Moo 4, Maret Lamai<BR>Koh Samui, 84310 Surathani<BR>Téléphone : 08 24 14 24 29</TD>';			vtmpHtml += "<TD width=70% align=CENTER><FONT SIZE=5><B>EMPLOI DU TEMPS<BR>Année scolaire " + vLibAn + "<BR> Classe de " + planMat.Classe + " " 			vtmpHtml += ((planMat.Filiere === null) ? ' ' : planMat.Filiere) + "</TD></TR></TABLE>";			vtmpHtml += "<TABLE border=0><TR><TD height=15>&nbsp;</TD></TR></TABLE>";			vtmpHtml += '<TABLE cellpadding="2px" cellspacing="1px" width=800 border=1 style="border:solid 0px gray; font-family:Calibri; font-size:10px; vertical-align: middle;">';			vtmpHtml += '<TR><TD COLSPAN=12></TD></TR>';			vtmpHtml += '<TR><TD COLSPAN=2></TD><TD COLSPAN=2 align=center height=30><B>Lundi</B></TD><TD COLSPAN=2 align=center><B>Mardi</B></TD><TD COLSPAN=2 align=center><B>Mercredi</B></TD>';			vtmpHtml += '<TD COLSPAN=2 align=center><B>Jeudi</B></TD><TD COLSPAN=2 align=center><B>Vendredi</B></TD></TR>';						for (var i = 0; i < 40; i++) {				j = i - (4*parseInt(i/4));				if (j === 0) {					vtmpHtml += '<TR><TD COLSPAN=2 ALIGN=left height=10><B><FONT style="font-family:Calibri; font-size:9px; vertical-align: middle;">' + LstH[i] + '</B></TD>';				} else {					vtmpHtml += '<TR><TD width=5%></TD><TD width=5% ALIGN=right height=10><FONT style="font-family:Calibri; font-size:9px; vertical-align: middle;">' + LstH[i] + '</TD>';				}				for (var m = 0; m < 5; m++) {					k = i + 32;					planActs = ds.Tache_Theorique.query("Planning.ID = :1 and jourS = :2 and hDeb = :3 order by semaineType", planMat.ID, LstJ[m], k);					if (planActs.length > 0) {						planActs.forEach(function (planAct) {							vFlag = 1;							vCoul = planAct.Matiere.CoulCode;							vMat = planAct.Matiere.Nom;							if (planAct.Salle !== undefined) {								vSalle = planAct.Salle.Nom;							} else {								vSalle = "-";							}							vFin = planAct.hFin - 32;							vHoraire = LstH[i] + " - " + LstH[vFin];							vDuree = planAct.hFin - planAct.hDeb;							if (planAct.semaineType === "Permanent") {								vtmpHtml += '<TD COLSPAN=2 ROWSPAN=' + vDuree + ' bgcolor=' + vCoul + ' align=center><FONT style="font-family:Calibri; font-size:12px; vertical-align: middle;">'; 								vtmpHtml += vMat + '<FONT style="font-family:Calibri; font-size:10px; vertical-align: middle;"></B><BR>' + vHoraire + '<BR>' + vSalle + '</TD>';								CptJG[m] = vDuree;								CptJD[m] = vDuree;							}							if (planAct.semaineType === "Semaine paire") {								vtmpHtml += '<TD width=9% ROWSPAN=' + vDuree + ' bgcolor=' + vCoul + ' align=center><FONT style="font-family:Calibri; font-size:12px; vertical-align: middle;">'; 								vtmpHtml += vMat + '<FONT style="font-family:Calibri; font-size:10px; vertical-align: middle;"></B><BR>' + vHoraire + '<BR>' + vSalle + '</TD>';								CptJG[m] = vDuree;								if (planActs.length === 1 && CptJD[m] === 0) {									vtmpHtml += '<TD width=9%></TD>';								}							}							if (planAct.semaineType === "Semaine impaire") {								if (planActs.length === 1 && CptJG[m] === 0) {									vtmpHtml += '<TD width=9%></TD>';								}								vtmpHtml += '<TD width=9% ROWSPAN=' + vDuree + ' bgcolor=' + vCoul + ' align=center><FONT style="font-family:Calibri; font-size:12px; vertical-align: middle;">'; 								vtmpHtml += vMat + '<FONT style="font-family:Calibri; font-size:10px; vertical-align: middle;"></B><BR>' + vHoraire + '<BR>' + vSalle + '</TD>';								CptJD[m] = vDuree;							}						});					} else {						if (CptJG[m] === 0 && CptJD[m] === 0) {							vtmpHtml += '<TD COLSPAN=2></TD>';						} else {							if (CptJG[m] === 0) {								vtmpHtml += '<TD WIDTH=9%></TD>';							} else {								CptJG[m] = CptJG[m] - 1;							}							if (CptJD[m] === 0) {								vtmpHtml += '<TD WIDTH=9%></TD>';							} else {								CptJD[m] = CptJD[m] - 1;							}						}					}				}				vtmpHtml += '</TR>';			}						vtmpHtml += '<TR><TD COLSPAN=8></TD></TR></TABLE>';			vtmpHtml += '<P class="break">';			vtmpHtml += '<TABLE width=800 border=0><TR><TD height=5 bgcolor=#FFFFFF>&nbsp;</TD></TR></TABLE><P>';						if (vFlag === 1) {				vHtml += vtmpHtml;			}					});	}				return vHtml;		}