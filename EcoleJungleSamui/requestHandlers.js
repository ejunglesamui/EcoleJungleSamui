//Export de la liste des élèves function exportEleves(request, response) {	response.contentType = 'application/vnd.ms-excel';	//response.contentType = 'text/plain';	var vToday, exportData, dNais, dtNais, vSect, vCar, vAnScol, AnScol, vLibAn, vMail, Nday, Nmonth, Nyear, vCoul;	vToday = new Date();	vCoul = "#FFFFFF";	AnScol = ds.Annees_Scolaires.query("Date_Debut <= :1 and Date_fin >= :1", vToday);	vAnScol = AnScol[0].ID;	vLibAn = AnScol[0].Annee_Scolaire;	if (vAnScol !== null) {		exportData = '<TABLE cellspacing="2px" cellpadding="2px;" rules="all" style="border:solid 1px black; font-family:Calibri; font-size:12px; vertical-align: middle;">';		exportData += "<TR><TD COLSPAN=7 height=50 align=CENTER><B><font size=5 >Liste des élèves inscrits pour l'année scolaire "+vLibAn+"</B></TD></TR>";		eleves = ds.Parcours_Scolaire.query("Annee_Scolaire.ID = :1 order by Eleve.Nom_Complet", vAnScol);		exportData += '<TR><TD align=LEFT height=30 width=200><B>Nom Prénom</B></TD><TD align=LEFT width=90><B>Classe</B></TD><TD align=LEFT width=60><B>Filière</B></TD>';		exportData += '<TD align=LEFT width=80><B>Section</B></TD><TD align=LEFT width=60><B>Sexe</B></TD><TD align=LEFT width=90><B>Né(e) le</B></TD><TD align=LEFT width=200><B>eMail</B></TD></TR>';		eleves.forEach(function (eleve) {			dNais = eleve.Eleve.Date_Naissance;			vCar = eleve.Classe.substring(0,1);			if (vCar === "C" || vCar === "M") {				vSect = "Primaire";			} else {				vSect = "Secondaire";			}			if  (dNais === null) {				dtNais = " ";			} else {				Nday = dNais.getDate();				Nday = ((Nday < 10) ? '0' : '') + Nday; 				Nmonth = dNais.getMonth() + 1;				Nmonth = ((Nmonth < 10) ? '0' : '') + Nmonth; 				Nyear = dNais.getYear();				Nyear = ((Nyear < 200) ? 1900 : 0) + Nyear; 				dtNais = Nday + '/' + Nmonth + '/' + Nyear;			}			vMail = eleve.Eleve.Utilisateur.eMail;			if (vMail === null) {				vMail = " ";			}			if (vCoul === "#CEECF5") {				vCoul = "#FFFFFF";			} else {				vCoul = "#CEECF5";			}			exportData +=  '<TR><TD bgcolor="'+vCoul+'">' + eleve.Eleve.Nom_Complet + '</TD><TD bgcolor="'+vCoul+'">' + eleve.Classe + '</TD><TD bgcolor="'+vCoul+'">' + eleve.Filiere + '</TD>';			exportData +=  '<TD bgcolor="'+vCoul+'">' + vSect + '</TD><TD bgcolor="'+vCoul+'">' + eleve.Eleve.Sexe + '</TD><TD bgcolor="'+vCoul+'">' + dtNais + '</TD><TD bgcolor="'+vCoul+'">' + vMail + '</TD></TR>';		});		exportData += '</TABLE>';	} else {		exportData = " ";	}	return exportData;}