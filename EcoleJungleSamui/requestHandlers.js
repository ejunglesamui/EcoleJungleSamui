//Export de la liste des élèves function exportEleves(request, response) {	response.contentType = 'application/vnd.ms-excel';	//response.contentType = 'text/plain';	var vToday, exportData, dNais, dtNais, vSect, vCar, vAnScol, AnScol, vLibAn, vMail, Nday, Nmonth, Nyear;	vToday = new Date();	AnScol = ds.Annees_Scolaires.query("Date_Debut <= :1 and Date_fin >= :1", vToday);	vAnScol = AnScol[0].ID;	vLibAn = AnScol[0].Annee_Scolaire;	if (vAnScol !== null) {		exportData = '<TABLE cellspacing="2px" cellpadding="2px;" rules="all" style="border:solid 1px black;">';		exportData += "<TR><TD COLSPAN=7 align=CENTER ><B>Liste des élèves inscrits pour l'année scolaire "+vLibAn+"</B></TD></TR>";		eleves = ds.Parcours_Scolaire.query("Annee_Scolaire.ID = :1 order by Eleve.Nom_Complet", vAnScol);		exportData += '<TR><TD align=CENTER width=200><B>Nom Prénom</B></TD><TD align=CENTER width=90><B>Classe</B></TD><TD align=CENTER width=60><B>Filière</B></TD>';		exportData += '<TD align=CENTER width=80><B>Section</B></TD><TD align=CENTER width=60><B>Sexe</B></TD><TD align=CENTER width=90><B>Né(e) le</B></TD><TD align=CENTER width=200><B>eMail</B></TD></TR>';		eleves.forEach(function (eleve) {			dNais = eleve.Eleve.Date_Naissance;			vCar = eleve.Classe.substring(0,1);			if (vCar === "C" || vCar === "M") {				vSect = "Primaire";			} else {				vSect = "Secondaire";			}			if  (dNais === null) {				dtNais = " ";			} else {				Nday = dNais.getDate();				Nday = ((Nday < 10) ? '0' : '') + Nday; 				Nmonth = dNais.getMonth() + 1;				Nmonth = ((Nmonth < 10) ? '0' : '') + Nmonth; 				Nyear = dNais.getYear();				Nyear = ((Nyear < 200) ? 1900 : 0) + Nyear; 				dtNais = Nday + '/' + Nmonth + '/' + Nyear;			}			vMail = eleve.Eleve.Utilisateur.eMail;			if (vMail === null) {				vMail = " ";			}			exportData +=  '<TR><TD>' + eleve.Eleve.Nom_Complet + '</TD><TD>' + eleve.Classe + '</TD><TD>' + eleve.Filiere + '</TD>';			exportData +=  '<TD>' + vSect + '</TD><TD>' + eleve.Eleve.Sexe + '</TD><TD>' + dtNais + '</TD><TD>' + vMail + '</TD></TR>';		});		exportData += '</TABLE>';	} else {		exportData = " ";	}	return exportData;}